<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>Adjust_Invoice_Prices</name>
        <label>Adjust Invoice Prices</label>
        <locationX>1791</locationX>
        <locationY>8684</locationY>
        <actionName>IV_InvoiceAdjustAmount</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>Check_InvoiceDate</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Cancel_Invoice</targetReference>
        </faultConnector>
        <flowTransactionModel>Automatic</flowTransactionModel>
        <inputParameters>
            <name>invoiceId</name>
            <value>
                <elementReference>NewInvoiceId</elementReference>
            </value>
        </inputParameters>
    </actionCalls>
    <actionCalls>
        <name>Create_Total_CreditMemo</name>
        <label>Create Total CreditMemo</label>
        <locationX>1571</locationX>
        <locationY>4040</locationY>
        <actionName>IV_InsertCreditMemoFromInvoice</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>createInvoice</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Cancel_Invoice2</targetReference>
        </faultConnector>
        <flowTransactionModel>Automatic</flowTransactionModel>
        <inputParameters>
            <name>creditMemoDate</name>
            <value>
                <elementReference>CreditMemoDate</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>invoiceId</name>
            <value>
                <elementReference>Get_WorkOrderInvoice.Id</elementReference>
            </value>
        </inputParameters>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </actionCalls>
    <actionCalls>
        <name>Get_NewInvoiceLine_Asset</name>
        <label>Get NewInvoiceLine / Asset</label>
        <locationX>2275</locationX>
        <locationY>6992</locationY>
        <actionName>IV_GetValueFromMapRecord</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>createChildInvoiceLine_0_0</targetReference>
        </connector>
        <dataTypeMappings>
            <typeName>U__outputValue</typeName>
            <typeValue>InvoiceLine__c</typeValue>
        </dataTypeMappings>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Cancel_Invoice</targetReference>
        </faultConnector>
        <flowTransactionModel>Automatic</flowTransactionModel>
        <inputParameters>
            <name>key</name>
            <value>
                <elementReference>FE_ChildAsset.ParentId</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>flowMap</name>
            <value>
                <elementReference>Map_NewInvoiceLines_Asset.flowMap</elementReference>
            </value>
        </inputParameters>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </actionCalls>
    <actionCalls>
        <name>Get_NewInvoiceLine_OrderItem</name>
        <label>Get NewInvoiceLine / OrderItem</label>
        <locationX>2275</locationX>
        <locationY>8000</locationY>
        <actionName>IV_GetValueFromMapRecord</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>createChildInvoiceLine_0_0_0</targetReference>
        </connector>
        <dataTypeMappings>
            <typeName>U__outputValue</typeName>
            <typeValue>InvoiceLine__c</typeValue>
        </dataTypeMappings>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Cancel_Invoice</targetReference>
        </faultConnector>
        <flowTransactionModel>Automatic</flowTransactionModel>
        <inputParameters>
            <name>key</name>
            <value>
                <elementReference>FE_ChildOrderItem.parentOrderItem__c</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>flowMap</name>
            <value>
                <elementReference>Map_NewInvoiceLines_OrderItem.flowMap</elementReference>
            </value>
        </inputParameters>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </actionCalls>
    <actionCalls>
        <name>Get_OptionsAsset</name>
        <label>Get OptionsAsset</label>
        <locationX>1879</locationX>
        <locationY>4604</locationY>
        <actionName>IV_FlowINClauseActionClass</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>whichObject_0</targetReference>
        </connector>
        <dataTypeMappings>
            <typeName>U__records</typeName>
            <typeValue>Asset</typeValue>
        </dataTypeMappings>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Cancel_Invoice</targetReference>
        </faultConnector>
        <flowTransactionModel>Automatic</flowTransactionModel>
        <inputParameters>
            <name>filteringValuesCollection</name>
            <value>
                <elementReference>AssetIdsList</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>objectApiName</name>
            <value>
                <stringValue>Asset</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldsToQuery</name>
            <value>
                <stringValue>Name, Product2Id, ParentId, orderItem__c, orderItem__r.UnitPrice, orderItem__r.VATRate__c, orderItem__r.VATAmount__c, unit__c, Product2.Name, orderItem__r.Quantity, Status</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>filterField</name>
            <value>
                <stringValue>ParentId</stringValue>
            </value>
        </inputParameters>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </actionCalls>
    <actionCalls>
        <name>Get_OptionsOrderItem</name>
        <label>Get OptionsOrderItem</label>
        <locationX>1767</locationX>
        <locationY>5060</locationY>
        <actionName>IV_FlowINClauseActionClass</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>loopForOrderItemSelected</targetReference>
        </connector>
        <dataTypeMappings>
            <typeName>U__records</typeName>
            <typeValue>OrderItem</typeValue>
        </dataTypeMappings>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Cancel_Invoice</targetReference>
        </faultConnector>
        <flowTransactionModel>Automatic</flowTransactionModel>
        <inputParameters>
            <name>filteringValuesCollection</name>
            <value>
                <elementReference>OrderItemIdsList</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>objectApiName</name>
            <value>
                <stringValue>OrderItem</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldsToQuery</name>
            <value>
                <stringValue>Product2Id, parentOrderItem__c, UnitPrice, VATRate__c, VATAmount__c, unit__c, Product2.Name, Quantity</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>filterField</name>
            <value>
                <stringValue>parentOrderItem__c</stringValue>
            </value>
        </inputParameters>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </actionCalls>
    <actionCalls>
        <name>Map_NewInvoiceLines_Asset</name>
        <label>Map NewInvoiceLines / Asset</label>
        <locationX>2187</locationX>
        <locationY>6668</locationY>
        <actionName>IV_CreateFlowMapRecord</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>FE_ChildAsset</targetReference>
        </connector>
        <dataTypeMappings>
            <typeName>T__records</typeName>
            <typeValue>InvoiceLine__c</typeValue>
        </dataTypeMappings>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Cancel_Invoice</targetReference>
        </faultConnector>
        <flowTransactionModel>Automatic</flowTransactionModel>
        <inputParameters>
            <name>records</name>
            <value>
                <elementReference>Get_New_InvoicesLines</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>keyField</name>
            <value>
                <stringValue>asset__c</stringValue>
            </value>
        </inputParameters>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </actionCalls>
    <actionCalls>
        <name>Map_NewInvoiceLines_OrderItem</name>
        <label>Map NewInvoiceLines / OrderItem</label>
        <locationX>2187</locationX>
        <locationY>7676</locationY>
        <actionName>IV_CreateFlowMapRecord</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>FE_ChildOrderItem</targetReference>
        </connector>
        <dataTypeMappings>
            <typeName>T__records</typeName>
            <typeValue>InvoiceLine__c</typeValue>
        </dataTypeMappings>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Cancel_Invoice</targetReference>
        </faultConnector>
        <flowTransactionModel>Automatic</flowTransactionModel>
        <inputParameters>
            <name>records</name>
            <value>
                <elementReference>Get_New_InvoicesLines</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>keyField</name>
            <value>
                <stringValue>orderItem__c</stringValue>
            </value>
        </inputParameters>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </actionCalls>
    <actionCalls>
        <name>Open_Details</name>
        <label>Open Details</label>
        <locationX>1791</locationX>
        <locationY>9140</locationY>
        <actionName>c:OpenDetailsRecord</actionName>
        <actionType>component</actionType>
        <connector>
            <targetReference>endOfFlow</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Cancel_Invoice</targetReference>
        </faultConnector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>recordId</name>
            <value>
                <elementReference>Get_NewInvoice.Id</elementReference>
            </value>
        </inputParameters>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </actionCalls>
    <apiVersion>56.0</apiVersion>
    <assignments>
        <name>addToChildInvoiceLineList_0</name>
        <label>Add to Child InvoiceLineList</label>
        <locationX>2275</locationX>
        <locationY>8216</locationY>
        <assignmentItems>
            <assignToReference>newInvoiceLineChildList</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>InvoiceLine</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>FE_ChildOrderItem</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>addToChildInvoiceLineList_0_0</name>
        <label>Add to Child InvoiceLineList</label>
        <locationX>2275</locationX>
        <locationY>7208</locationY>
        <assignmentItems>
            <assignToReference>newInvoiceLineChildList</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>InvoiceLine</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>FE_ChildAsset</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>addToParentInvoiceLineListOrder</name>
        <label>Add to Parent InvoiceLineList</label>
        <locationX>1855</locationX>
        <locationY>5984</locationY>
        <assignmentItems>
            <assignToReference>newInvoiceLineParentList</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>InvoiceLine</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>loopForAssetSelected</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>addToParentInvoiceLineListOrder_0</name>
        <label>Add to Parent InvoiceLineList</label>
        <locationX>1855</locationX>
        <locationY>5384</locationY>
        <assignmentItems>
            <assignToReference>newInvoiceLineParentList</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>InvoiceLine</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>loopForOrderItemSelected</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>addToParentInvoiceLineListWOLI</name>
        <label>Add to Parent InvoiceLineList</label>
        <locationX>1375</locationX>
        <locationY>5168</locationY>
        <assignmentItems>
            <assignToReference>newInvoiceLineParentList</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>InvoiceLine</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>loopForWorkOrderLineItem</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_CustomerOrder</name>
        <label>Assign CustomerOrder</label>
        <locationX>1392</locationX>
        <locationY>3032</locationY>
        <assignmentItems>
            <assignToReference>CustomerOrder</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>getOrder</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Check_if_Amount_OrderAmount</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_InvoiceAmount</name>
        <label>Assign InvoiceAmount</label>
        <locationX>1260</locationX>
        <locationY>3248</locationY>
        <assignmentItems>
            <assignToReference>invoiceAmount</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>CustomerOrder.amount__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>InvoiceDateScreen</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_WorkOrderId</name>
        <label>Assign WorkOrderId</label>
        <locationX>2114</locationX>
        <locationY>242</locationY>
        <assignmentItems>
            <assignToReference>WorkOrderId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_WorKOrder</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_WorkOrderId_SA</name>
        <label>Assign WorkOrderId / SA</label>
        <locationX>182</locationX>
        <locationY>350</locationY>
        <assignmentItems>
            <assignToReference>WorkOrderId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_SA.ParentRecordId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>GET_ServiceAppointmentInvoice</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>assignAsset</name>
        <label>assignAsset</label>
        <locationX>1656</locationX>
        <locationY>1598</locationY>
        <assignmentItems>
            <assignToReference>AssetIdsList</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>forEachAssetSelected.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>invoicePretaxAmount</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>assetPretaxAmount</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>invoiceAmount</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>assetAmount</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>invoiceVATAmount</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>assetVATAmount</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>assetsNotInvoiced</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>forEachAssetSelected</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>forEachAssetSelected</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>assignOrderItem</name>
        <label>assignOrderItem</label>
        <locationX>2096</locationX>
        <locationY>2198</locationY>
        <assignmentItems>
            <assignToReference>OrderItemIdsList</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>forEachOrderItemSelected.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>invoicePretaxAmount</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>forEachOrderItemSelected.pretaxAmount__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>invoiceAmount</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>forEachOrderItemSelected.amount__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>invoiceVATAmount</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>forEachOrderItemSelected.VATAmount__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>orderItemNotInvoiced</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>forEachOrderItemSelected</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>forEachOrderItemSelected</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>assignOrderItemEmpty</name>
        <label>assignOrderItemEmpty</label>
        <locationX>853</locationX>
        <locationY>674</locationY>
        <assignmentItems>
            <assignToReference>orderItemEmpty</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>isAssetEmpty</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>assignOrderItemEmpty_0</name>
        <label>assignOrderItemEmpty</label>
        <locationX>853</locationX>
        <locationY>974</locationY>
        <assignmentItems>
            <assignToReference>assetEmpty</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Check_billable_lines</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>assignWOLI</name>
        <label>assignWOLI</label>
        <locationX>2202</locationX>
        <locationY>1214</locationY>
        <assignmentItems>
            <assignToReference>WOLINotInvoiced</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>forEachWOLISelected</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLINotNull</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>AssetIdsList</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>forEachWOLISelected.AssetId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>invoicePretaxAmount</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>forEachWOLISelected.pretaxAmount__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>invoiceAmount</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>forEachWOLISelected.amount__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>invoiceVATAmount</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>forEachWOLISelected.VATAmount__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>forEachWOLISelected</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>assignWOLIList</name>
        <label>assignWOLIList</label>
        <locationX>2114</locationX>
        <locationY>674</locationY>
        <assignmentItems>
            <assignToReference>allWOLIList</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_WorkOrderLineItems</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>CustomerOrder</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_SAOrder</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WorkOrder</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_WorKOrder</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>WOLI_Asset_Billable</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Copier_1_sur_assignOrderItem</name>
        <label>Copier 1 sur assignOrderItem</label>
        <locationX>1656</locationX>
        <locationY>2414</locationY>
        <assignmentItems>
            <assignToReference>OrderItemIdsList</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>forEachOrderItemSelected.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>invoicePretaxAmount</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>invoicePretaxAmountDivided</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>invoiceAmount</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>invoiceAmountDivided</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>invoiceVATAmount</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>invoiceVATAmountDivided</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>orderItemNotInvoiced</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>forEachOrderItemSelected</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>counter_quantity</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>counter_quantity</name>
        <label>counter quantity</label>
        <locationX>1656</locationX>
        <locationY>2522</locationY>
        <assignmentItems>
            <assignToReference>Counter</assignToReference>
            <operator>Add</operator>
            <value>
                <numberValue>1.0</numberValue>
            </value>
        </assignmentItems>
        <connector>
            <isGoTo>true</isGoTo>
            <targetReference>numberOfIteration</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>createChildInvoiceLine_0_0</name>
        <label>Create Child InvoiceLine</label>
        <locationX>2275</locationX>
        <locationY>7100</locationY>
        <assignmentItems>
            <assignToReference>InvoiceLine.orderItem__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>FE_ChildAsset.orderItem__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>InvoiceLine.quantity__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>1.0</numberValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>InvoiceLine.asset__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>FE_ChildAsset.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>InvoiceLine.unit__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>FE_ChildAsset.unit__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>InvoiceLine.parentLine__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_NewInvoiceLine_Asset.outputValue.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>InvoiceLine.invoice__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>NewInvoiceId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>addToChildInvoiceLineList_0_0</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>createChildInvoiceLine_0_0_0</name>
        <label>Create Child InvoiceLine</label>
        <locationX>2275</locationX>
        <locationY>8108</locationY>
        <assignmentItems>
            <assignToReference>InvoiceLine.orderItem__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>FE_ChildOrderItem.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>InvoiceLine.quantity__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>1.0</numberValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>InvoiceLine.asset__c</assignToReference>
            <operator>Assign</operator>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>InvoiceLine.unit__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>FE_ChildOrderItem.unit__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>InvoiceLine.parentLine__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_NewInvoiceLine_OrderItem.outputValue.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>InvoiceLine.invoice__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>NewInvoiceId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>addToChildInvoiceLineList_0</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>createParentInvoiceLineOrder</name>
        <label>Create Parent InvoiceLine</label>
        <locationX>1855</locationX>
        <locationY>5876</locationY>
        <assignmentItems>
            <assignToReference>InvoiceLine.orderItem__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loopForAssetSelected.orderItem__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>InvoiceLine.invoice__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>NewInvoiceId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>InvoiceLine.quantity__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>1.0</numberValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>InvoiceLine.asset__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loopForAssetSelected.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>addToParentInvoiceLineListOrder</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>createParentInvoiceLineOrder_0</name>
        <label>Create Parent InvoiceLine</label>
        <locationX>1855</locationX>
        <locationY>5276</locationY>
        <assignmentItems>
            <assignToReference>InvoiceLine.orderItem__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loopForOrderItemSelected.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>InvoiceLine.invoice__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>NewInvoiceId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>InvoiceLine.quantity__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>1.0</numberValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>InvoiceLine.asset__c</assignToReference>
            <operator>Assign</operator>
        </assignmentItems>
        <connector>
            <targetReference>addToParentInvoiceLineListOrder_0</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>createParentInvoiceLineWOLI</name>
        <label>Create Parent InvoiceLine</label>
        <locationX>1375</locationX>
        <locationY>5060</locationY>
        <assignmentItems>
            <assignToReference>InvoiceLine.orderItem__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loopForWorkOrderLineItem.customerOrderItem__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>InvoiceLine.invoice__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>NewInvoiceId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>InvoiceLine.quantity__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>1.0</numberValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>InvoiceLine.asset__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loopForWorkOrderLineItem.AssetId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>addToParentInvoiceLineListWOLI</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Define_CreateSACreditMemo</name>
        <label>Define CreateSACreditMemo</label>
        <locationX>2345</locationX>
        <locationY>1922</locationY>
        <assignmentItems>
            <assignToReference>CreateSACreditMemo</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>InvoiceDateScreen</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Define_DeleteSAInvoiceLines</name>
        <label>Define DeleteSAInvoiceLines</label>
        <locationX>2609</locationX>
        <locationY>2030</locationY>
        <assignmentItems>
            <assignToReference>NewInvoiceId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_WorkOrderInvoice.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>DeleteSAInvoiceLines</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>InvoiceDateScreen</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>ResetCounter</name>
        <label>ResetCounter</label>
        <locationX>1788</locationX>
        <locationY>2198</locationY>
        <assignmentItems>
            <assignToReference>Counter</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>0.0</numberValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>numberOfIteration</targetReference>
        </connector>
    </assignments>
    <choices>
        <name>Non</name>
        <choiceText>Non</choiceText>
        <dataType>Boolean</dataType>
        <value>
            <booleanValue>false</booleanValue>
        </value>
    </choices>
    <choices>
        <name>Oui</name>
        <choiceText>Oui</choiceText>
        <dataType>Boolean</dataType>
        <value>
            <booleanValue>true</booleanValue>
        </value>
    </choices>
    <collectionProcessors>
        <name>WOLI_Asset_Billable</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>Filter Asset Billable</label>
        <locationX>2114</locationX>
        <locationY>782</locationY>
        <assignNextValueToReference>currentItem_WOLI_Asset_Billable_0</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>allWOLIList</collectionReference>
        <conditionLogic>and</conditionLogic>
        <conditions>
            <leftValueReference>currentItem_WOLI_Asset_Billable_0.isAssetBillable__c</leftValueReference>
            <operator>EqualTo</operator>
            <rightValue>
                <booleanValue>true</booleanValue>
            </rightValue>
        </conditions>
        <connector>
            <targetReference>selectWOLIs</targetReference>
        </connector>
    </collectionProcessors>
    <decisions>
        <name>AssetNonInvoiced</name>
        <label>AssetNonInvoiced</label>
        <locationX>2334</locationX>
        <locationY>1106</locationY>
        <defaultConnector>
            <targetReference>forEachWOLISelected</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>NotInvoiced</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>forEachWOLISelected.invoicedAsset__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>assignWOLI</targetReference>
            </connector>
            <label>NotInvoiced</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_billable_lines</name>
        <label>Check billable lines</label>
        <locationX>985</locationX>
        <locationY>1166</locationY>
        <defaultConnector>
            <targetReference>selectAssetsAndOrderItems</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>BillableLines</defaultConnectorLabel>
        <rules>
            <name>NoBillableLines</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>assetEmpty</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>orderItemEmpty</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>No_Billable_Lines</targetReference>
            </connector>
            <label>NoBillableLines</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_ChildAssetQty</name>
        <label>Check ChildAssetQty</label>
        <locationX>2539</locationX>
        <locationY>6884</locationY>
        <defaultConnector>
            <targetReference>FE_ChildAsset</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Résultat par défaut</defaultConnectorLabel>
        <rules>
            <name>ChildAsset_QTY_1</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>FE_ChildAsset.orderItem__r.Quantity</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>FE_ChildAsset.Status</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Annulé</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_NewInvoiceLine_Asset</targetReference>
            </connector>
            <label>ChildAsset QTY &gt; 1</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_ChildOrderItemQty</name>
        <label>Check ChildOrderItemQty</label>
        <locationX>2539</locationX>
        <locationY>7892</locationY>
        <defaultConnector>
            <targetReference>FE_ChildOrderItem</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Résultat par défaut</defaultConnectorLabel>
        <rules>
            <name>ChildOrderItem_QTY_1</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>FE_ChildOrderItem.Quantity</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_NewInvoiceLine_OrderItem</targetReference>
            </connector>
            <label>ChildOrderItem QTY &gt; 1</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_if_Amount_OrderAmount</name>
        <label>Check if Amount &gt; OrderAmount</label>
        <locationX>1392</locationX>
        <locationY>3140</locationY>
        <defaultConnector>
            <targetReference>InvoiceDateScreen</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Résultat par défaut</defaultConnectorLabel>
        <rules>
            <name>Amount_OrderAmount</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>invoiceAmount</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <elementReference>CustomerOrder.amount__c</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_InvoiceAmount</targetReference>
            </connector>
            <label>Amount &gt; OrderAmount</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_InvoiceDate</name>
        <label>Check InvoiceDate</label>
        <locationX>1791</locationX>
        <locationY>8792</locationY>
        <defaultConnector>
            <targetReference>Open_Details</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Résultat par défaut</defaultConnectorLabel>
        <rules>
            <name>HasInvoiceDate</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>InvoiceDate</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_InvoiceDate</targetReference>
            </connector>
            <label>HasInvoiceDate</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_SAAction</name>
        <label>Check SAAction</label>
        <locationX>1791</locationX>
        <locationY>3932</locationY>
        <defaultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>createInvoice</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Other</defaultConnectorLabel>
        <rules>
            <name>Is_Delete_SAInvoiceLines</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>DeleteSAInvoiceLines</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_SAInvoiceLinesToDelete</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Delete_SAInvoiceLines</targetReference>
            </connector>
            <label>Is Delete SAInvoiceLines</label>
        </rules>
        <rules>
            <name>Is_Create_CreditMemo</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>CreateSACreditMemo</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Create_Total_CreditMemo</targetReference>
            </connector>
            <label>Is Create CreditMemo</label>
        </rules>
        <rules>
            <name>Is_Delete_SAInvoiceLines2</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>DeleteSAInvoiceLines</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_SAInvoiceLinesToDelete</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_NewInvoice</targetReference>
            </connector>
            <label>Delete SAInvoiceLines Without</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_SAInvoice</name>
        <label>Check SAInvoice</label>
        <locationX>2323</locationX>
        <locationY>1706</locationY>
        <defaultConnector>
            <targetReference>Check_SAInvoice_Reference</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Has SAInvoice</defaultConnectorLabel>
        <rules>
            <name>No_SAInvoice</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_WorkOrderInvoice</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>InvoiceDateScreen</targetReference>
            </connector>
            <label>No SAInvoice</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_SAInvoice_Reference</name>
        <label>Check SAInvoice Reference</label>
        <locationX>2477</locationX>
        <locationY>1814</locationY>
        <defaultConnector>
            <targetReference>Get_SAInvoiceLinesToDelete</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>SAInvoice No Reference</defaultConnectorLabel>
        <rules>
            <name>SAInvoice_With_Reference</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_WorkOrderInvoice.invoiceReference__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Define_CreateSACreditMemo</targetReference>
            </connector>
            <label>SAInvoice With Reference</label>
        </rules>
    </decisions>
    <decisions>
        <name>CheckOrderItemQuantity</name>
        <label>CheckOrderItemQuantity</label>
        <locationX>1942</locationX>
        <locationY>2090</locationY>
        <defaultConnector>
            <targetReference>assignOrderItem</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Résultat par défaut</defaultConnectorLabel>
        <rules>
            <name>Quantity_1</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>forEachOrderItemSelected.Quantity</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>1.0</numberValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>assetSelection.outputSelectedRows</leftValueReference>
                <operator>Contains</operator>
            </conditions>
            <connector>
                <targetReference>ResetCounter</targetReference>
            </connector>
            <label>Quantity &gt; 1</label>
        </rules>
    </decisions>
    <decisions>
        <name>isAssetEmpty</name>
        <label>isAssetEmpty</label>
        <locationX>985</locationX>
        <locationY>866</locationY>
        <defaultConnector>
            <targetReference>Check_billable_lines</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>isAssetEmptyOK</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>getAssetsInvoicable</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>assignOrderItemEmpty_0</targetReference>
            </connector>
            <label>isAssetEmptyOK</label>
        </rules>
    </decisions>
    <decisions>
        <name>isAssetEmpty_0</name>
        <label>isAssetEmpty</label>
        <locationX>1568</locationX>
        <locationY>1490</locationY>
        <defaultConnector>
            <targetReference>assignAsset</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>isAssetEmptyOK_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>getAssetsInvoicable</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>forEachAssetSelected</targetReference>
            </connector>
            <label>isAssetEmptyOK</label>
        </rules>
    </decisions>
    <decisions>
        <name>isAssetNull</name>
        <label>isAssetNull</label>
        <locationX>1791</locationX>
        <locationY>4496</locationY>
        <defaultConnector>
            <targetReference>Get_OptionsAsset</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>isAssetNullOK</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>AssetIdsList</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>whichObject_0</targetReference>
            </connector>
            <label>isAssetNullOK</label>
        </rules>
    </decisions>
    <decisions>
        <name>isAssetNull_0</name>
        <label>isAssetNull</label>
        <locationX>1635</locationX>
        <locationY>5660</locationY>
        <defaultConnector>
            <targetReference>loopForAssetSelected</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>isAssetNullOK_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>AssetIdsList</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Create_Parent_InvoiceLines</targetReference>
            </connector>
            <label>isAssetNullOK</label>
        </rules>
    </decisions>
    <decisions>
        <name>isAssetNull_0_0</name>
        <label>isAssetNull</label>
        <locationX>1791</locationX>
        <locationY>6560</locationY>
        <defaultConnector>
            <targetReference>Map_NewInvoiceLines_Asset</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>isAssetNullOK_0_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>AssetIdsList</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>isOrderItemNull</targetReference>
            </connector>
            <label>isAssetNullOK</label>
        </rules>
    </decisions>
    <decisions>
        <name>isGeneration</name>
        <label>isGeneration</label>
        <locationX>3401</locationX>
        <locationY>782</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>isOui</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>G_n_ration_automatique_de_la_facture</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>updateInvoice</targetReference>
            </connector>
            <label>isOui</label>
        </rules>
    </decisions>
    <decisions>
        <name>isOrderItemEmpty</name>
        <label>isOrderItemEmpty</label>
        <locationX>985</locationX>
        <locationY>566</locationY>
        <defaultConnector>
            <targetReference>isAssetEmpty</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>isOrderItemEmptyOK</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>getOrderItemNotAssociated</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>assignOrderItemEmpty</targetReference>
            </connector>
            <label>isOrderItemEmptyOK</label>
        </rules>
    </decisions>
    <decisions>
        <name>isOrderItemEmpty_0</name>
        <label>isOrderItemEmpty</label>
        <locationX>1711</locationX>
        <locationY>1982</locationY>
        <defaultConnector>
            <targetReference>CheckOrderItemQuantity</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>isOrderItemEmptyOK_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>getOrderItemNotAssociated</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>forEachOrderItemSelected</targetReference>
            </connector>
            <label>isOrderItemEmptyOK</label>
        </rules>
    </decisions>
    <decisions>
        <name>isOrderItemNull</name>
        <label>isOrderItemNull</label>
        <locationX>1791</locationX>
        <locationY>7568</locationY>
        <defaultConnector>
            <targetReference>Map_NewInvoiceLines_OrderItem</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>isOrderItemNullOK</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>orderItemNotInvoiced</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Create_Child_InvoiceLines</targetReference>
            </connector>
            <label>isOrderItemNullOK</label>
        </rules>
    </decisions>
    <decisions>
        <name>isOrderItemNull_0</name>
        <label>isOrderItemNull</label>
        <locationX>1635</locationX>
        <locationY>4952</locationY>
        <defaultConnector>
            <targetReference>Get_OptionsOrderItem</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>isOrderItemNullOK_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>orderItemNotInvoiced</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>isAssetNull_0</targetReference>
            </connector>
            <label>isOrderItemNullOK</label>
        </rules>
    </decisions>
    <decisions>
        <name>isServiceAppointmentInvoiceEmpty</name>
        <label>isServiceAppointmentInvoiceEmpty</label>
        <locationX>182</locationX>
        <locationY>566</locationY>
        <defaultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Get_WorKOrder</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>ServiceAppointmentIsEmpty</defaultConnectorLabel>
        <rules>
            <name>ServiceAppointmentNotEmpty</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>GET_ServiceAppointmentInvoice</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <elementReference>Non</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>existingInvoiceValidation</targetReference>
            </connector>
            <label>ServiceAppointmentNotEmpty</label>
        </rules>
    </decisions>
    <decisions>
        <name>isWOLIInvoiced</name>
        <label>isWOLIInvoiced</label>
        <locationX>2114</locationX>
        <locationY>1490</locationY>
        <defaultConnector>
            <targetReference>Get_WorkOrderInvoice</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>isWOLINotInvoicedOK</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>WOLINotInvoiced</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>noInvoiceCreation</targetReference>
            </connector>
            <label>isWOLInvoicedOK</label>
        </rules>
    </decisions>
    <decisions>
        <name>numberOfIteration</name>
        <label>numberOfIteration</label>
        <locationX>1788</locationX>
        <locationY>2306</locationY>
        <defaultConnector>
            <targetReference>forEachOrderItemSelected</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Counter &gt;= Quantity</defaultConnectorLabel>
        <rules>
            <name>counter_check</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Counter</leftValueReference>
                <operator>LessThan</operator>
                <rightValue>
                    <elementReference>forEachOrderItemSelected.Quantity</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Copier_1_sur_assignOrderItem</targetReference>
            </connector>
            <label>counter check</label>
        </rules>
    </decisions>
    <decisions>
        <name>whichObject</name>
        <label>whichObject</label>
        <locationX>1791</locationX>
        <locationY>134</locationY>
        <defaultConnector>
            <targetReference>Get_Invoice</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>isInvoice</defaultConnectorLabel>
        <rules>
            <name>isServiceAppointment</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>recordId</leftValueReference>
                <operator>StartsWith</operator>
                <rightValue>
                    <stringValue>08p</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_SA</targetReference>
            </connector>
            <label>isServiceAppointment</label>
        </rules>
        <rules>
            <name>isOrder</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>recordId</leftValueReference>
                <operator>StartsWith</operator>
                <rightValue>
                    <stringValue>801</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>getOrder</targetReference>
            </connector>
            <label>isOrder</label>
        </rules>
        <rules>
            <name>isWorkOrder</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>recordId</leftValueReference>
                <operator>StartsWith</operator>
                <rightValue>
                    <stringValue>0WO</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_WorkOrderId</targetReference>
            </connector>
            <label>isWorkOrder</label>
        </rules>
    </decisions>
    <decisions>
        <name>whichObject_0</name>
        <label>whichObject</label>
        <locationX>1791</locationX>
        <locationY>4844</locationY>
        <defaultConnectorLabel>isInvoice</defaultConnectorLabel>
        <rules>
            <name>is_SA_is_WorkOrder</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>recordId</leftValueReference>
                <operator>StartsWith</operator>
                <rightValue>
                    <stringValue>08p</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>recordId</leftValueReference>
                <operator>StartsWith</operator>
                <rightValue>
                    <stringValue>0WO</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>loopForWorkOrderLineItem</targetReference>
            </connector>
            <label>is SA / is WorkOrder</label>
        </rules>
        <rules>
            <name>isOrder_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>recordId</leftValueReference>
                <operator>StartsWith</operator>
                <rightValue>
                    <stringValue>801</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>isOrderItemNull_0</targetReference>
            </connector>
            <label>isOrder</label>
        </rules>
    </decisions>
    <description>Facture - Assistant de création de facture depuis la commande client / rendez vous de service / facture</description>
    <formulas>
        <name>assetAmount</name>
        <dataType>Currency</dataType>
        <expression>IF(
{!forEachAssetSelected.orderItem__r.Quantity} == 1,
{!forEachAssetSelected.orderItem__r.amount__c},
ROUND({!forEachAssetSelected.orderItem__r.amount__c} / {!forEachAssetSelected.orderItem__r.Quantity}, 2)
)</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <name>assetPretaxAmount</name>
        <dataType>Currency</dataType>
        <expression>IF(
{!forEachAssetSelected.orderItem__r.Quantity} == 1,
{!forEachAssetSelected.orderItem__r.pretaxAmount__c},
{!forEachAssetSelected.orderItem__r.pretaxAmount__c} / {!forEachAssetSelected.orderItem__r.Quantity}
)</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <name>assetVATAmount</name>
        <dataType>Currency</dataType>
        <expression>IF(
{!forEachAssetSelected.orderItem__r.Quantity} == 1,
{!forEachAssetSelected.orderItem__r.VATAmount__c},
{!forEachAssetSelected.orderItem__r.VATAmount__c} / {!forEachAssetSelected.orderItem__r.Quantity}
)</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <description>MAX entre la date de la facture annulée et la date du jour</description>
        <name>CreditMemoDate</name>
        <dataType>Date</dataType>
        <expression>IF( ISNULL( {!Get_WorkOrderInvoice.invoiceDate__c} ) || {!$Flow.CurrentDate} &gt; {!Get_WorkOrderInvoice.invoiceDate__c},
{!$Flow.CurrentDate},
{!Get_WorkOrderInvoice.invoiceDate__c}
)</expression>
    </formulas>
    <formulas>
        <name>customerBillingAddress</name>
        <dataType>String</dataType>
        <expression>{!CustomerOrder.BillingStreet}&amp;&quot; &quot;&amp;{!CustomerOrder.BillingPostalCode}&amp;&quot; &quot;&amp;{!CustomerOrder.BillingCity}&amp;&quot; &quot;&amp;{!CustomerOrder.BillingCountry}</expression>
    </formulas>
    <formulas>
        <name>customerShippingAddress</name>
        <dataType>String</dataType>
        <expression>{!CustomerOrder.ShippingStreet}&amp;&quot; &quot;&amp;{!CustomerOrder.ShippingPostalCode}&amp;&quot; &quot;&amp;{!CustomerOrder.ShippingCity}&amp;&quot; &quot;&amp;{!CustomerOrder.ShippingCountry}</expression>
    </formulas>
    <formulas>
        <name>invoiceAmountDivided</name>
        <dataType>Currency</dataType>
        <expression>{!forEachOrderItemSelected.amount__c}/{!forEachOrderItemSelected.Quantity}</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <name>invoicePretaxAmountDivided</name>
        <dataType>Currency</dataType>
        <expression>{!forEachOrderItemSelected.pretaxAmount__c}/{!forEachOrderItemSelected.Quantity}</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <name>invoiceVATAmountDivided</name>
        <dataType>Currency</dataType>
        <expression>{!forEachOrderItemSelected.VATAmount__c}/{!forEachOrderItemSelected.Quantity}</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <name>testorderitemselectionRequired</name>
        <dataType>Boolean</dataType>
        <expression>NOT({!orderItemEmpty})</expression>
    </formulas>
    <formulas>
        <name>todayDate</name>
        <dataType>Date</dataType>
        <expression>TODAY()</expression>
    </formulas>
    <interviewLabel>Facture - Création automatisée d&apos;une facture {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Facture - Création automatisée d&apos;une facture</label>
    <loops>
        <name>FE_ChildAsset</name>
        <label>For Each ChildAsset</label>
        <locationX>2187</locationX>
        <locationY>6776</locationY>
        <collectionReference>Get_OptionsAsset.records</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Check_ChildAssetQty</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>isOrderItemNull</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>FE_ChildOrderItem</name>
        <label>For Each ChildOrderItem</label>
        <locationX>2187</locationX>
        <locationY>7784</locationY>
        <collectionReference>Get_OptionsOrderItem.records</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Check_ChildOrderItemQty</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Create_Child_InvoiceLines</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>forEachAssetSelected</name>
        <label>forEachAssetSelected</label>
        <locationX>1392</locationX>
        <locationY>1382</locationY>
        <collectionReference>assetSelection.outputSelectedRows</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>isAssetEmpty_0</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>forEachOrderItemSelected</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>forEachOrderItemSelected</name>
        <label>forEachOrderItemSelected</label>
        <locationX>1392</locationX>
        <locationY>1874</locationY>
        <collectionReference>orderItemSelection.outputSelectedRows</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>isOrderItemEmpty_0</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Assign_CustomerOrder</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>forEachWOLISelected</name>
        <label>For Each WOLI Selected</label>
        <locationX>2114</locationX>
        <locationY>998</locationY>
        <collectionReference>WOLISelection.outputSelectedRows</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>AssetNonInvoiced</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>isWOLIInvoiced</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>loopForAssetSelected</name>
        <label>Loop For Asset Selected</label>
        <locationX>1767</locationX>
        <locationY>5768</locationY>
        <collectionReference>assetsNotInvoiced</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>createParentInvoiceLineOrder</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Create_Parent_InvoiceLines</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>loopForOrderItemSelected</name>
        <label>Loop For OrderItem Selected</label>
        <locationX>1767</locationX>
        <locationY>5168</locationY>
        <collectionReference>orderItemNotInvoiced</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>createParentInvoiceLineOrder_0</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>isAssetNull_0</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>loopForWorkOrderLineItem</name>
        <label>Loop For WorkOrderLineItem</label>
        <locationX>1287</locationX>
        <locationY>4952</locationY>
        <collectionReference>WOLINotInvoiced</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>createParentInvoiceLineWOLI</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Create_Parent_InvoiceLines</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>Flow</processType>
    <recordCreates>
        <name>Create_Child_InvoiceLines</name>
        <label>Create Child InvoiceLines</label>
        <locationX>1791</locationX>
        <locationY>8576</locationY>
        <connector>
            <targetReference>Adjust_Invoice_Prices</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Cancel_Invoice</targetReference>
        </faultConnector>
        <inputReference>newInvoiceLineChildList</inputReference>
    </recordCreates>
    <recordCreates>
        <name>Create_Parent_InvoiceLines</name>
        <label>Create Parent InvoiceLines</label>
        <locationX>1791</locationX>
        <locationY>6344</locationY>
        <connector>
            <targetReference>Get_New_InvoicesLines</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Cancel_Invoice</targetReference>
        </faultConnector>
        <inputReference>newInvoiceLineParentList</inputReference>
    </recordCreates>
    <recordCreates>
        <name>createInvoice</name>
        <label>Create Invoice</label>
        <locationX>1571</locationX>
        <locationY>4148</locationY>
        <assignRecordIdToReference>NewInvoiceId</assignRecordIdToReference>
        <connector>
            <targetReference>Get_NewInvoice</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Cancel_Invoice2</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>RecordTypeId</field>
            <value>
                <elementReference>Get_RTInvoice.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>amount__c</field>
            <value>
                <elementReference>invoiceAmount</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>autoComputedAmount__c</field>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>billingAccount__c</field>
            <value>
                <elementReference>CustomerOrder.AccountId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>customerOrder__c</field>
            <value>
                <elementReference>CustomerOrder.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>parentInvoice__c</field>
            <value>
                <elementReference>Get_WorkOrderInvoice.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>pretaxAmount__c</field>
            <value>
                <elementReference>invoicePretaxAmount</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>status__c</field>
            <value>
                <stringValue>Brouillon</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>workOrder__c</field>
            <value>
                <elementReference>WorkOrder.Id</elementReference>
            </value>
        </inputAssignments>
        <object>Invoice__c</object>
    </recordCreates>
    <recordDeletes>
        <name>Delete_SAInvoiceLines</name>
        <label>Delete InvoiceLines</label>
        <locationX>1043</locationX>
        <locationY>4040</locationY>
        <connector>
            <targetReference>Get_NewInvoice</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Cancel_Invoice2</targetReference>
        </faultConnector>
        <inputReference>Get_SAInvoiceLinesToDelete</inputReference>
    </recordDeletes>
    <recordLookups>
        <name>Get_Invoice</name>
        <label>Get Invoice</label>
        <locationX>3401</locationX>
        <locationY>242</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_InvoiceLines</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Invoice__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_InvoiceLines</name>
        <label>Get InvoiceLines</label>
        <locationX>3401</locationX>
        <locationY>350</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>infoInvoice</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>invoice__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>InvoiceLine__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_New_InvoicesLines</name>
        <label>Get New InvoicesLines</label>
        <locationX>1791</locationX>
        <locationY>6452</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>isAssetNull_0_0</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Cancel_Invoice</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>invoice__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>NewInvoiceId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>InvoiceLine__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_NewInvoice</name>
        <label>Get New Invoice</label>
        <locationX>1791</locationX>
        <locationY>4388</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>isAssetNull</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Cancel_Invoice2</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>NewInvoiceId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Invoice__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_RTInvoice</name>
        <label>Get RTInvoice</label>
        <locationX>1791</locationX>
        <locationY>3824</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Check_SAAction</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Cancel_Invoice2</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>DeveloperName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Invoice</stringValue>
            </value>
        </filters>
        <filters>
            <field>SobjectType</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Invoice__c</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>RecordType</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_SA</name>
        <label>Get ServiceAppointment</label>
        <locationX>182</locationX>
        <locationY>242</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Assign_WorkOrderId_SA</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>ServiceAppointment</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_SAInvoiceLinesToDelete</name>
        <label>Get SAInvoiceLinesToDelete</label>
        <locationX>2609</locationX>
        <locationY>1922</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Define_DeleteSAInvoiceLines</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>invoice__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_WorkOrderInvoice.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>InvoiceLine__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_SAOrder</name>
        <label>Get Order</label>
        <locationX>2114</locationX>
        <locationY>458</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_WorkOrderLineItems</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_WorKOrder.customerOrder__c</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Order</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>GET_ServiceAppointmentInvoice</name>
        <label>GET_ServiceAppointmentInvoice</label>
        <locationX>182</locationX>
        <locationY>458</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>isServiceAppointmentInvoiceEmpty</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>workOrder__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>WorkOrderId</elementReference>
            </value>
        </filters>
        <filters>
            <field>status__c</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>Annulée</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Invoice__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_WorKOrder</name>
        <label>Get WorKOrder</label>
        <locationX>2114</locationX>
        <locationY>350</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_SAOrder</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>WorkOrderId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>WorkOrder</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_WorkOrderInvoice</name>
        <label>Get WorkOrderInvoice</label>
        <locationX>2323</locationX>
        <locationY>1598</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Check_SAInvoice</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Cancel_Invoice2</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>workOrder__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>WorkOrder.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>cancellationDate__c</field>
            <operator>IsNull</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>paymentDate__c</field>
            <operator>IsNull</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>amountToCancel__c</field>
            <operator>GreaterThan</operator>
            <value>
                <numberValue>0.0</numberValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Invoice__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_WorkOrderLineItems</name>
        <label>Get WorkOrderLineItems</label>
        <locationX>2114</locationX>
        <locationY>566</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>assignWOLIList</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>WorkOrderId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_WorKOrder.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>WorkOrderLineItem</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>getAssetsInvoicable</name>
        <label>getAssetsInvoicable</label>
        <locationX>985</locationX>
        <locationY>350</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>getOrderItemNotAssociated</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>customerOrder__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>getOrder.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>isBillable__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>ParentId</field>
            <operator>IsNull</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>invoiceDate__c</field>
            <operator>IsNull</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Asset</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>getOrder</name>
        <label>getOrder</label>
        <locationX>985</locationX>
        <locationY>242</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>getAssetsInvoicable</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Order</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>getOrderItemNotAssociated</name>
        <label>getOrderItemNotAssociated</label>
        <locationX>985</locationX>
        <locationY>458</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>isOrderItemEmpty</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>asset__c</field>
            <operator>IsNull</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>parentOrderItem__c</field>
            <operator>IsNull</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>OrderId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>getOrder.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>isBillable__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>OrderItem</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordRollbacks>
        <name>Cancel_Invoice</name>
        <label>Cancel Invoice</label>
        <locationX>4193</locationX>
        <locationY>9248</locationY>
        <connector>
            <targetReference>FlowError_0_0_0</targetReference>
        </connector>
    </recordRollbacks>
    <recordRollbacks>
        <name>Cancel_Invoice2</name>
        <label>Cancel Invoice</label>
        <locationX>5513</locationX>
        <locationY>4496</locationY>
        <connector>
            <targetReference>FlowError_0_0</targetReference>
        </connector>
    </recordRollbacks>
    <recordUpdates>
        <name>Update_InvoiceDate</name>
        <label>Update InvoiceDate</label>
        <locationX>1527</locationX>
        <locationY>8900</locationY>
        <connector>
            <targetReference>Open_Details</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Cancel_Invoice</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>NewInvoiceId</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>invoiceDate__c</field>
            <value>
                <elementReference>InvoiceDate</elementReference>
            </value>
        </inputAssignments>
        <object>Invoice__c</object>
    </recordUpdates>
    <recordUpdates>
        <name>updateInvoice</name>
        <label>updateInvoice</label>
        <locationX>3137</locationX>
        <locationY>890</locationY>
        <faultConnector>
            <targetReference>FlowError_0</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>status__c</field>
            <value>
                <stringValue>Publiée</stringValue>
            </value>
        </inputAssignments>
        <object>Invoice__c</object>
    </recordUpdates>
    <recordUpdates>
        <name>updateInvoiceLine</name>
        <label>updateInvoiceLine</label>
        <locationX>3401</locationX>
        <locationY>566</locationY>
        <connector>
            <targetReference>generationFacture</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>FlowError_0</targetReference>
        </faultConnector>
        <inputReference>invoiceLineInfos.outputEditedRows</inputReference>
    </recordUpdates>
    <screens>
        <name>endOfFlow</name>
        <label>Flux Terminé</label>
        <locationX>1791</locationX>
        <locationY>9248</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <fields>
            <name>CreationText</name>
            <fieldText>&lt;p&gt;&lt;b style=&quot;color: rgb(22, 160, 4);&quot;&gt;La facture {!Get_NewInvoice.Name} a bien été créée.&lt;/b&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>existingInvoiceValidation</name>
        <label>existingInvoiceValidation</label>
        <locationX>50</locationX>
        <locationY>674</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <isGoTo>true</isGoTo>
            <targetReference>Get_WorKOrder</targetReference>
        </connector>
        <fields>
            <name>titre</name>
            <fieldText>&lt;p style=&quot;text-align: center;&quot;&gt;&lt;strong style=&quot;color: rgb(255, 0, 0);&quot;&gt;﻿Il existe déjà une facture non annulée liée à ce rendez-vous. Voulez-vous continuer la création d&apos;une nouvelle facture ?&lt;/strong&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>invoiceValue</name>
            <fieldText>&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;u&gt;N° de facture :&lt;/u&gt;&lt;/strong&gt;&amp;nbsp;{!GET_ServiceAppointmentInvoice.Name}&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;u&gt;Date de facturation :&lt;/u&gt;&lt;/strong&gt;&amp;nbsp;{!GET_ServiceAppointmentInvoice.invoiceDate__c}&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;u&gt;Montant TTC :&amp;nbsp;&lt;/u&gt;&lt;/strong&gt;{!montantTTCExistant}&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <nextOrFinishButtonLabel>Continuer</nextOrFinishButtonLabel>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>FlowError_0</name>
        <label>Erreur</label>
        <locationX>3401</locationX>
        <locationY>998</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <fields>
            <name>ErrorMessage_0</name>
            <fieldText>&lt;p&gt;&lt;b style=&quot;background-color: rgb(255, 255, 255); color: rgb(255, 0, 0); font-size: 12px;&quot;&gt;{!$Flow.FaultMessage}&lt;/b&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>FlowError_0_0</name>
        <label>Erreur</label>
        <locationX>5513</locationX>
        <locationY>4604</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <fields>
            <name>ErrorMessage_0_0</name>
            <fieldText>&lt;p&gt;&lt;b style=&quot;background-color: rgb(255, 255, 255); color: rgb(255, 0, 0); font-size: 12px;&quot;&gt;{!$Flow.FaultMessage}&lt;/b&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>FlowError_0_0_0</name>
        <label>Erreur</label>
        <locationX>4193</locationX>
        <locationY>9356</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <fields>
            <name>ErrorMessage_0_0_0</name>
            <fieldText>&lt;p&gt;&lt;b style=&quot;background-color: rgb(255, 255, 255); color: rgb(255, 0, 0); font-size: 12px;&quot;&gt;{!$Flow.FaultMessage}&lt;/b&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>generationFacture</name>
        <label>generationFacture</label>
        <locationX>3401</locationX>
        <locationY>674</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>isGeneration</targetReference>
        </connector>
        <fields>
            <name>G_n_ration_automatique_de_la_facture</name>
            <choiceReferences>Oui</choiceReferences>
            <choiceReferences>Non</choiceReferences>
            <dataType>Boolean</dataType>
            <defaultSelectedChoiceReference>Non</defaultSelectedChoiceReference>
            <fieldText>Génération automatique de la facture</fieldText>
            <fieldType>RadioButtons</fieldType>
            <isRequired>false</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>infoInvoice</name>
        <label>infoInvoice</label>
        <locationX>3401</locationX>
        <locationY>458</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>updateInvoiceLine</targetReference>
        </connector>
        <fields>
            <name>infos</name>
            <fieldText>&lt;p&gt;&lt;b&gt;Numéro de la facture : &lt;/b&gt;{!Get_Invoice.&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(62, 62, 60);&quot;&gt;Name&lt;/span&gt;}&lt;/p&gt;&lt;p&gt;&lt;b&gt;Date de facture : &lt;/b&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;{!Get_Invoice.&lt;/span&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(62, 62, 60);&quot;&gt;invoiceDate__c&lt;/span&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;}&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Commande client : &lt;/b&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;{!&lt;/span&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(62, 62, 60);&quot;&gt;Get_Invoice&lt;/span&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;.customerOrder__r.Name}&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Montant HT : &lt;/b&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;{!&lt;/span&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(62, 62, 60);&quot;&gt;Get_Invoice&lt;/span&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;.pretaxAmount__c} €&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Montant TTC : &lt;/b&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;{!&lt;/span&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(62, 62, 60);&quot;&gt;Get_Invoice&lt;/span&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;.amount__c} €&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Compte de facturation : &lt;/b&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;{!&lt;/span&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(62, 62, 60);&quot;&gt;Get_Invoice&lt;/span&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;.billAccount__r.Name}&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Entité : &lt;/b&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;{!&lt;/span&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(62, 62, 60);&quot;&gt;Get_Invoice&lt;/span&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;.salesEntity__r.Name}&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;b style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;Chantier : &lt;/b&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;{!&lt;/span&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(62, 62, 60);&quot;&gt;Get_Invoice&lt;/span&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;.customerOrder__r.chantier__r.Name}&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>invoiceLineInfos</name>
            <dataTypeMappings>
                <typeName>T</typeName>
                <typeValue>InvoiceLine__c</typeValue>
            </dataTypeMappings>
            <extensionName>c:datatableV2</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>columnFields</name>
                <value>
                    <stringValue>asset__c, amount__c, quantity__c</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>tableData</name>
                <value>
                    <elementReference>Get_InvoiceLines</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>columnEdits</name>
                <value>
                    <stringValue>quantity__c:true</stringValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>InvoiceDateScreen</name>
        <label>Invoice Date</label>
        <locationX>1791</locationX>
        <locationY>3608</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>invoiceInfo</targetReference>
        </connector>
        <fields>
            <name>InvoiceDateText</name>
            <fieldText>&lt;p&gt;Si la date de facture est renseignée, une référence comptable sera associée à la facture qui ne pourra plus être modifiée.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>InvoiceDate</name>
            <dataType>Date</dataType>
            <fieldText>Date de la facture</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>false</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>invoiceInfo</name>
        <label>invoiceInfo</label>
        <locationX>1791</locationX>
        <locationY>3716</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Get_RTInvoice</targetReference>
        </connector>
        <fields>
            <name>invoiceData</name>
            <fieldText>&lt;p&gt;&lt;b style=&quot;font-size: 16px;&quot;&gt;&lt;u&gt;Information concernant la facture&lt;/u&gt;&lt;/b&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>infoFac</name>
            <fieldText>&lt;p&gt;&lt;strong&gt;Nom client : &lt;/strong&gt;{!CustomerOrder.billingName__c}&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Adresse client : &lt;/strong&gt;{!customerBillingAddress}&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Adresse chantier : &lt;/strong&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(68, 68, 68);&quot;&gt;{!customerShippingAddress}&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;strong style=&quot;background-color: rgb(255, 255, 255); color: rgb(68, 68, 68);&quot;&gt;Montant HT : &lt;/strong&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(68, 68, 68);&quot;&gt;{!invoicePretaxAmount}&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;strong style=&quot;background-color: rgb(255, 255, 255); color: rgb(68, 68, 68);&quot;&gt;Montant TVA : &lt;/strong&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(68, 68, 68);&quot;&gt;{!invoiceVATAmount}&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;strong style=&quot;background-color: rgb(255, 255, 255); color: rgb(68, 68, 68);&quot;&gt;Montant TTC : &lt;/strong&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(68, 68, 68);&quot;&gt;{!invoiceAmount}&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>WOLIList</name>
            <dataTypeMappings>
                <typeName>T</typeName>
                <typeValue>WorkOrderLineItem</typeValue>
            </dataTypeMappings>
            <extensionName>c:datatableV2</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>columnFields</name>
                <value>
                    <stringValue>AssetId,assetLocationFormula__c,dimensions__c,pretaxAmount__c,VATAmount__c,amount__c</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>tableData</name>
                <value>
                    <elementReference>WOLINotInvoiced</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>hideCheckboxColumn</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>columnLabels</name>
                <value>
                    <stringValue>AssetId:Nom,assetLocationFormula__c:Emplacement,pretaxAmount__c:Montant HT,VATAmount__c:Montant TVA,amount__c:Montant TTC</stringValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>WOLINotNull</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <booleanValue>true</booleanValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>No_Billable_Lines</name>
        <label>No Billable Lines</label>
        <locationX>578</locationX>
        <locationY>1274</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <fields>
            <name>NoBillableLineText</name>
            <fieldText>&lt;p&gt;&lt;b style=&quot;color: rgb(255, 0, 0); font-size: 12px; background-color: rgb(255, 255, 255);&quot;&gt;Facture impossible. Aucun actif ou ligne de commande facturable&lt;/b&gt;&lt;b style=&quot;color: rgb(255, 0, 0); font-size: 12px; background-color: rgb(255, 255, 255); font-family: Calibri, &amp;quot;Segoe UI&amp;quot;, Calibri, Thonburi, Arial, Verdana, sans-serif, &amp;quot;Mongolian Baiti&amp;quot;, &amp;quot;Microsoft Yi Baiti&amp;quot;, &amp;quot;Javanese Text&amp;quot;;&quot;&gt;.&lt;/b&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>noInvoiceCreation</name>
        <label>noInvoiceCreation</label>
        <locationX>1905</locationX>
        <locationY>1598</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <fields>
            <name>messageText</name>
            <fieldText>&lt;p&gt;Tout les éléments de rendez-vous sélectionnés ont déjà été facturés.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>selectAssetsAndOrderItems</name>
        <label>selectAssetsAndOrderItems</label>
        <locationX>1392</locationX>
        <locationY>1274</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>forEachAssetSelected</targetReference>
        </connector>
        <fields>
            <name>assetSelection</name>
            <dataTypeMappings>
                <typeName>T</typeName>
                <typeValue>Asset</typeValue>
            </dataTypeMappings>
            <extensionName>c:datatableV2</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>columnFields</name>
                <value>
                    <stringValue>Name,Status,locationFormula__c,dimensions__c,PurchaseDate</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>isRequired</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>tableLabel</name>
                <value>
                    <stringValue>Veuillez sélectionner les actifs à facturer</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>tableData</name>
                <value>
                    <elementReference>getAssetsInvoicable</elementReference>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>assetEmpty</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <booleanValue>false</booleanValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>orderItemSelection</name>
            <dataTypeMappings>
                <typeName>T</typeName>
                <typeValue>OrderItem</typeValue>
            </dataTypeMappings>
            <extensionName>c:datatableV2</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>columnFields</name>
                <value>
                    <stringValue>Name, pretaxAmount__c,VATAmount__c,amount__c</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>isRequired</name>
                <value>
                    <booleanValue>false</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>tableLabel</name>
                <value>
                    <stringValue>Veuillez sélectionner les lignes de commandes à facturer</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>tableData</name>
                <value>
                    <elementReference>getOrderItemNotAssociated</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>singleRowSelection</name>
                <value>
                    <booleanValue>false</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>matchCaseOnFilters</name>
                <value>
                    <booleanValue>false</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>suppressBottomBar</name>
                <value>
                    <booleanValue>false</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>tableBorder</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>orderItemEmpty</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <booleanValue>false</booleanValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>selectWOLIs</name>
        <label>selectWOLIs</label>
        <locationX>2114</locationX>
        <locationY>890</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>forEachWOLISelected</targetReference>
        </connector>
        <fields>
            <name>WOLISelection</name>
            <dataTypeMappings>
                <typeName>T</typeName>
                <typeValue>WorkOrderLineItem</typeValue>
            </dataTypeMappings>
            <extensionName>c:datatableV2</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>tableData</name>
                <value>
                    <elementReference>allWOLIList</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>columnFields</name>
                <value>
                    <stringValue>AssetId,assetLocationFormula__c,dimensions__c,pretaxAmount__c,VATAmount__c,amount__c</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>isRequired</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>tableLabel</name>
                <value>
                    <stringValue>Veuillez sélectionner les actifs à facturer</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>tableBorder</name>
                <value>
                    <booleanValue>false</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>columnLabels</name>
                <value>
                    <stringValue>AssetId:Nom,assetLocationFormula__c:Emplacement,pretaxAmount__c:Montant HT,VATAmount__c:Montant TVA,amount__c:Montant TTC</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>preSelectedRows</name>
                <value>
                    <elementReference>WOLI_Asset_Billable</elementReference>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <start>
        <locationX>1665</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>whichObject</targetReference>
        </connector>
    </start>
    <status>Draft</status>
    <variables>
        <name>allWOLIList</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>WorkOrderLineItem</objectType>
    </variables>
    <variables>
        <name>assetEmpty</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <booleanValue>false</booleanValue>
        </value>
    </variables>
    <variables>
        <name>AssetIdsList</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>assetsNotInvoiced</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Asset</objectType>
    </variables>
    <variables>
        <name>Counter</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
        <value>
            <numberValue>0.0</numberValue>
        </value>
    </variables>
    <variables>
        <name>CreateSACreditMemo</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <booleanValue>false</booleanValue>
        </value>
    </variables>
    <variables>
        <name>currentItem_WOLI_Asset_Billable_0</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>WorkOrderLineItem</objectType>
    </variables>
    <variables>
        <name>CustomerOrder</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Order</objectType>
    </variables>
    <variables>
        <name>DeleteSAInvoiceLines</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <booleanValue>false</booleanValue>
        </value>
    </variables>
    <variables>
        <name>increment</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
        <value>
            <numberValue>1.0</numberValue>
        </value>
    </variables>
    <variables>
        <name>invoiceAmount</name>
        <dataType>Currency</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>2</scale>
        <value>
            <numberValue>0.0</numberValue>
        </value>
    </variables>
    <variables>
        <name>InvoiceLine</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>InvoiceLine__c</objectType>
    </variables>
    <variables>
        <name>invoicePretaxAmount</name>
        <dataType>Currency</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>2</scale>
        <value>
            <numberValue>0.0</numberValue>
        </value>
    </variables>
    <variables>
        <name>invoiceVATAmount</name>
        <dataType>Currency</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>2</scale>
        <value>
            <numberValue>0.0</numberValue>
        </value>
    </variables>
    <variables>
        <name>montantTTCExistant</name>
        <dataType>Currency</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>2</scale>
        <value>
            <elementReference>GET_ServiceAppointmentInvoice.amount__c</elementReference>
        </value>
    </variables>
    <variables>
        <name>NewInvoiceId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>newInvoiceLineChildList</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>InvoiceLine__c</objectType>
    </variables>
    <variables>
        <name>newInvoiceLineParentList</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>InvoiceLine__c</objectType>
    </variables>
    <variables>
        <name>orderItemEmpty</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <booleanValue>false</booleanValue>
        </value>
    </variables>
    <variables>
        <name>OrderItemIdsList</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>orderItemNotInvoiced</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>OrderItem</objectType>
    </variables>
    <variables>
        <name>orderItemNotNull</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>recordId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>WOLIAssetBillable</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>WorkOrderLineItem</objectType>
    </variables>
    <variables>
        <name>WOLINotInvoiced</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>WorkOrderLineItem</objectType>
    </variables>
    <variables>
        <name>WOLINotNull</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <booleanValue>false</booleanValue>
        </value>
    </variables>
    <variables>
        <name>WorkOrder</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>WorkOrder</objectType>
    </variables>
    <variables>
        <name>WorkOrderId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
