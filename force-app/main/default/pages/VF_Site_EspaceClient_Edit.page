<apex:page showheader="false" sidebar="false" doctype="html-5.0" controller="Ctrl_Site_EspaceClient" action="{!checkAllowedAccess}" applyhtmltag="false" standardstylesheets="false" cache="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="robots" content="noindex, follow" />
        <meta name="keywords" content="KparK, K par K, client, espace client, fenêtre, porte, garage, portail" />
        <title>Espace Client | K par K</title>
        <link rel="shortcut icon" href="{!URLFOR($Resource.Site_Favicon)}" type="image/x-icon" />
        <apex:includescript value="{!URLFOR($Resource.JQuery_js, 'JQuery/jquery-1.11.1.min.js')}" />
        <apex:includescript value="{!URLFOR($Resource.JQuery_js, 'JQuery/js.cookie-2.0.4.min.js')}" />
        <apex:includescript value="{!URLFOR($Resource.JQuery_js, 'JQuery_UI/js/jquery-ui-1.11.4.min.js')}" />
        <apex:includescript value="{!URLFOR($Resource.Bootstrap_Ressources, 'dist/js/bootstrap.min.js')}" />
        <apex:includescript value="{!URLFOR($Resource.DataTables_js, 'DataTables-1.10.6/media/js/jquery.dataTables.min.js')}" />
        <apex:includescript value="{!URLFOR($Resource.DataTables_js, 'DataTables-1.10.6/plugin/dataTables.bootstrap.js')}" />
        <apex:includescript value="{!URLFOR($Resource.DataTables_js, 'DataTables-1.10.6/plugin/sorting/natural.js')}" />
        <apex:includescript value="{!URLFOR($Resource.DataTables_js, 'DataTables-1.10.6/plugin/sorting/datetime-moment.js')}" />
        <apex:includescript value="https://maps.googleapis.com/maps/api/js?key={!googleMapsSettings.Cle_API__c}&libraries=places" />
        <apex:includescript value="{!URLFOR($Resource.GoogleMaps, 'js/autocompletion_places.js')}" />
        <apex:includescript value="{!URLFOR($Resource.ionRangeSlider_js, 'js/ion-rangeSlider/ion.rangeSlider.min.js')}" />
        <apex:includescript value="{!URLFOR($Resource.FullCalendar, 'lib/moment.min.js')}" />
        <apex:includescript value="{!URLFOR($Resource.Site_Espace_Client, 'js/cnil_cookie.min.js')}" />
        <apex:includescript value="{!URLFOR($Resource.Site_Espace_Client, 'js/espace_client.min.js')}" />
        <apex:includescript value="{!URLFOR($Resource.Site_Espace_Client, 'js/notification.min.js')}" />
        <apex:includescript value="{!URLFOR($Resource.Site_Espace_Client, 'js/jquery.autocomplete.min.js')}" />
        <apex:includescript value="{!URLFOR($Resource.Site_Espace_Client, 'js/FileSaver.min.js')}" />
        <script type='text/javascript' src='https://c.la1-c2-frf.salesforceliveagent.com/content/g/js/42.0/deployment.js'></script>

        <style type="text/css">
            .no-border {
                border: 0 !important;
            }

            #navProfilListe li {
                margin-right: 0px;
            }

            .statut-Nouveau {
                background-color:#dc3545!important;
                color:#fff!important;
            }

            .statut-En {
                background-color:#ffc107!important;
                color:#343a40!important;

            }
            .statut-A {
                background-color:#28a745!important;
                color:#fff!important;
            }
        </style>

        <script type="text/javascript">
            liveagent.init('https://d.la1-c2-frf.salesforceliveagent.com/chat', '5725700000001yk', '00DD0000000mwD7');    
            // Paramètrage Chat
            liveagent.addCustomDetail("Prénom", "{!account.prenom}");
            liveagent.addCustomDetail("Nom", "{!account.nom}");
            liveagent.addCustomDetail("Email", "{!account.email}");
            liveagent.addCustomDetail("Numéro Compte", "{!account.numeroCompte}");                
            // Recherche compte
            liveagent.findOrCreate("Account").map("AccountNumber","Numéro Compte",true,true,true);                
            // Enregistrer compte
            liveagent.findOrCreate("Account").saveToTranscript("AccountId").showOnCreate();
            
            j$ = jQuery.noConflict();

            var caseIdGlobal;

            // Initialisation des messages
            labels = window.labels || {};
            labels.TEXT_NO_NOTIFICATIONS        = "Pas de notifications";
            labels.TEXT_CASE_INFO               = "{!$Label.espaceclient_text_CaseInformationType}";
            labels.TEXT_CASE_RDV                = "{!$Label.espaceclient_text_CaseRDVType}";
            labels.MSG_CASE_CREATESUCCESSFUL    = "{!$Label.espaceclient_msg_CaseCreateSuccessful}";
            labels.MSG_CASE_WRONGATTACHMENTTYPE = "{!$Label.espaceclient_msg_CaseWrongAttachmentType}";
            labels.MSG_CASE_ERRORSIZEFILE       = "{!$Label.espaceclient_msg_CaseErrorSizeFile}";
            labels.MSG_CASE_ERRORREADFILE       = "{!$Label.espaceclient_msg_CaseErrorReadFile}";
            labels.MSG_ACC_UPDATESUCCESSFUL     = "{!$Label.msg_ConfirmModificationAccount}";
            labels.MSG_CALL_SUCCESSFUL          = "{!$Label.espaceclient_msg_CallSuccessful}";
            labels.MSG_PARRAINAGE_SUCCESSFUL    = "{!$Label.espaceclient_msg_CreateFilleulSuccessful}";
            labels.MSG_MDP_SUCCESSFUL           = "{!$Label.espaceclient_msg_ChangerMDPSuccessful}";

            j$(document).ready(function(){
                // Cookie (CNIL)
                initCNILCookie();
                // Init variables, utilisées dans espace_client.js (getNewPickListValues)
                typeRDVDemandeRDV = JSON.parse('{!JSENCODE(typeRDVListDemandeRDV)}');
                typeRDVModifRDV = JSON.parse('{!JSENCODE(typeRDVListmodifRDV)}');
                typeRDVAnnulationRDV = JSON.parse('{!JSENCODE(typeRDVListannulationRDV)}');
                typeRDVDemandeInfo = JSON.parse('{!JSENCODE(typeRDVListDemandeInfo)}');

                // Initialisation champ "ville"
                j$('[id$=locality_combobox]').combobox();
                // Initialise la valeur des champs et les class CSS
                if("{!account.ville}" != "") j$('#locality').val("{!account.ville}");
                if("{!account.codePostal}" != "") geocodeCityName();

                // Initialise le champ de recherche d'adresse (auto-complétion)
                initializeAutoCompletion('autocomplete', formFields);
                activeAutoCompletion(componentForm, formFields, 'adresse_latitude', 'adresse_longitude');
                formFields.forEach(function(fieldId) {
                    j$("[id$="+fieldId+"]")[0].disabled = false;
                });
                initializeAutoCompletionFilleul('autocomplete_filleul', formFieldsFilleul);
                activeAutoCompletionFilleul(componentForm, formFieldsFilleul, 'adresse_latitude_filleul', 'adresse_longitude_filleul');
                // Evite le rechargement de la page lors de l'appuie sur Entrée sur le champ de recherche
                j$('[id$=autocomplete]').keypress(function(e) {
                    if (e.which == 13) {
                        adressValue = j$('[id$=autocomplete]').val().trim();
                        e.stopPropagation();
                        return false;
                    }
                });
                j$('[id$=autocomplete_filleul]').keypress(function(e) {
                    if (e.which == 13) {
                        e.stopPropagation();
                        return false;
                    }
                });
                // Lors d'une selection d'onglet, désactive tous les autres de la page. Cela permet de synchroniser les 2 systèmes de navigation (onglets et menu déroulant).
                j$('.nav-tabs li a').click(function (e) {
                    //get selected href
                    var href = j$(this).attr('href');

                    //set all nav tabs to inactive
                    j$('.nav-tabs li').removeClass('active');

                    //get all nav tabs matching the href and set to active
                    j$('.nav-tabs li a[href="'+href+'"]').closest('li').addClass('active');

                    //active tab
                    j$('.tab-pane').removeClass('active');
                    j$('.tab-pane'+href).addClass('active');
                })


                // Initialise les "Progress Bar" pour le tableau de bord
                initializeDashboardProgressBar();
                // Initialise les "Progress Bar" pour les projets
                initializeProjectsProgressBar();
                // Initialisation des panneaux projets
                initializeProjectsPanel("{!premierContratId}");
                // Initialisation des notifications
                initializeNotification();
                // Initialisation parrainage
                initializeParrainagePanel();
                // Initialise popup parrainage
                if('{!filleuls.size}'=='0')
                    j$('#parrainage_modalPubParrain').modal('show');
                    
                initCasesTables();
                refreshMotifsListState(); //désactive la picklist demande_motif si aucun choix n'est disponible
                getNewPickListValues(j$("[id$=demande_type]").val()); // met à jour la picklist Type de RDV

                j$("[id$=demande_type]").change(function() {
                    getNewPickListValues(j$(this).val()); // met à jour la picklist Type de RDV
                });
            });

            function changeNavTab(el) {
                //get selected href
                var href = j$(el).attr('href');
                j$(href).tab('show');
            }

            function refreshMotifsListState() {
                motifsList = j$("[id$=demande_motif]");
                if(j$(motifsList).find("option").length < 1) j$(motifsList).prop('disabled', true);
                else j$(motifsList).prop('disabled', false);
            }

            function initCasesTables() {
                j$.fn.dataTable.moment( 'DD/MM/YYYY' ); //définition du type de date '01/12/2015' pour permettre le tri
                var casesTableOptions = {
                    responsive: true,
                    "bRetrieve": true,
                    "language": {
                        "url": "{!URLFOR($Resource.DataTables_js, 'DataTables-1.10.6/l18n/French.json')}"
                    },
                    "columns": [ //définition des noms de propriétés auxquelles réfèrent les colonnes (pour récupérer les données en JSON)
                        {"data": "id"},
                        {"data": "numero"},
                        {"data": "typeDemande"},
                        {"data": "motif"},
                        {"data": "typeRDV"},
                        {"data": "chantier"},
                        {"data": "statut"},
                        {"data": "dateDemande"},
                        {"data": "aCloturer"},
                    ],
                    "order": [[ 7, "desc" ], [1, "desc"]], //tri par Date de création de la demande et numéro
                    "columnDefs": [
                        { "type": "natural", "targets": [ 0,1 ] },
                        { targets: 0, visible: false }
                    ],
                    "initComplete": function(settings, json) {
                        j$('.dataTables_filter input').attr("placeholder", "Rechercher");
                    }
                };
                j$("#demandesTable").dataTable(casesTableOptions);
                
                var casesClosedTableOptions = {
                    responsive: true,
                    "bRetrieve": true,
                    "language": {
                        "url": "{!URLFOR($Resource.DataTables_js, 'DataTables-1.10.6/l18n/French.json')}"
                    },
                    "columns": [ //définition des noms de propriétés auxquelles réfèrent les colonnes (pour récupérer les données en JSON)
                        {"data": "id"},
                        {"data": "numero"},
                        {"data": "typeDemande"},
                        {"data": "motif"},
                        {"data": "typeRDV"},
                        {"data": "chantier"}
                    ],
                    "order": [[1, "desc"]], //tri par numéro
                    "columnDefs": [
                        { "type": "natural", "targets": [ 0,1 ] },
                        { targets: 0, visible: false }
                    ],
                    "initComplete": function(settings, json) {
                        j$('.dataTables_filter input').attr("placeholder", "Rechercher");
                    }
                };
                j$("#demandesClosesTable").dataTable(casesClosedTableOptions);
            }

            /* Création d'un filleul                                                        */
            /*------------------------------------------------------------------------------*/
            function callRemoteActionFilleul() {
                // Désactivation bouton
                eraseMessage('parrainage');
                j$('[id$=ajoutFilleul]').button('loading');
                j$('[id$=ajoutFilleul]').attr('disabled', true);
                // Valeurs
                var nom = j$('[id$=nom_filleul]').val();
                var prenom = j$('[id$=prenom_filleul]').val();
                var rue = j$('[id$=adresse_rue_filleul]').val();
                var cp = j$('[id$=postal_code_filleul]').val();
                var ville = j$('[id$=locality_filleul]').val();
                var departement = j$('[id$=administrative_area_level_1_filleul]').val();
                var pays = j$('[id$=country_filleul]').val();
                var email = j$('[id$=email_filleul]').val();
                var tel = j$('[id$=telephone_filleul]').val();
                var typeDotation = j$('[id$=typeDotation_filleul]').val();
                var latitude = j$('[id$=adresse_latitude_filleul]').val();
                var longitude = j$('[id$=adresse_longitude_filleul]').val();

                // Appel remote action
                Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.Ctrl_Site_EspaceClient.creationFilleul}', nom, prenom, rue, cp, ville, departement, pays, email,
                    tel, typeDotation, latitude, longitude, '{!accountInitial.AccountNumber}',
                    function(result, event) {
                        if (event.status) {
                            if(result != null) {
                                // Affiche modal de validation
                                j$('#parrainage_modalAdd').modal('hide');
                                j$('#parrainage_modalValid').modal('show');
                                // Refresh TAB
                                var nom=j$('[id$=nom_filleul]').val();
                                var prenom=j$('[id$=prenom_filleul]').val();
                                var nb=parseInt(j$('[id$=parrainage-dashboard-numberFilleul]').text())+1;
                                j$('[id$=parrainage-dashboard-numberFilleul]').text(nb);
                                var content='<li class="list-group-item-custom" id="parrainage_modalFilleuls-line">';
                                content+=   '<div><strong class="text-uppercase" id="parrainage_modalFilleuls-name">'+prenom+' '+nom+'</strong></div>';
                                content+=   '<div>Demande de parrainage envoyée le : <span class="text-red" id="parrainage_modalFilleuls-date">'+moment().format('DD/MM/YYYY')+'</span></div>';
                                content+=   '</li>';
                                j$('#parrainage_modalFilleuls-liste').append(content);
                                // RAZ des valeurs
                                j$('[id$=nom_filleul]').val('');
                                j$('[id$=prenom_filleul]').val('');
                                j$('[id$=email_filleul]').val('');
                                j$('[id$=telephone_filleul]').val('');
                                j$('[id$=autocomplete_filleul]').val('');
                                j$('[id$=adresse_rue_filleul]').val('');
                                j$('[id$=postal_code_filleul]').val('');
                                j$('[id$=locality_filleul]').val('');
                                j$('[id$=administrative_area_level_1_filleul]').val('');
                                j$('[id$=country_filleul]').val('');
                                j$('[id$=typeDotation_filleul] option:eq(0)').prop('selected', true);
                                j$('[id$=adresse_latitude_filleul]').val('');
                                j$('[id$=adresse_longitude_filleul]').val('');
                            }
                        } else if (event.type === 'exception') {
                            displayMessage('parrainage', 'error', event.message);
                        } else {
                            displayMessage('parrainage', 'error', event.message);
                        }
                        // Activation bouton
                        j$('[id$=ajoutFilleul]').button('reset');
                        j$('[id$=ajoutFilleul]').attr('disabled', false);
                    },
                    {buffer: true, escape: true, timeout: 120000}
                );
            }

            /* Création de la requête                                                       */
            /*------------------------------------------------------------------------------*/
            function callRemoteActionDemandes() {
                // Désactivation bouton
                eraseMessage('contact');
                j$('[id$=envoyerDemande]').button('loading');
                j$('[id$=envoyerDemande]').attr('disabled', true);
                // Valeurs
                var chantierId = j$('[id$=demande_chantier]').val();
                var type = j$('[id$=demande_type]').val();
                var motif = j$('[id$=demande_motif]').val();
                var typeRDV = j$('[id$=demande_typeRDV]').val();
                var description = j$('[id$=demande_description]').val();
                // Appel remote action
                Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.Ctrl_Site_EspaceClient.creationDemande}', '{!accountInitial.Id}', chantierId, type, motif, typeRDV, description,
                    function(result, event) {
                        if (event.status) {
                            if(result != null) {
                                // Vérifie la présence d'un fichier
                                var fichier = document.getElementById('demande_attachement').files[0];
                                if(fichier != undefined) { //si il y'a un fichier joint à upload
                                    uploadFile(result, fichier, creationDemandeSucces);
                                } else {
                                    creationDemandeSucces(); //sinon on affiche directement le message de réussite
                                }
                            }
                        } else if (event.type === 'exception') {
                            displayMessage('demandes', 'error', event.message);
                        } else {
                            displayMessage('demandes', 'error', event.message);
                        }
                        // Activation bouton
                        j$('[id$=envoyerDemande]').button('reset');
                        j$('[id$=envoyerDemande]').attr('disabled', false);
                    },
                    {buffer: true, escape: true, timeout: 120000}
                );
            }

            function creationDemandeSucces() {
                // affiche le message de réussite
                displayMessage('contact', 'success', labels.MSG_CASE_CREATESUCCESSFUL);
                rerenderDemandes(); //met à jour la liste des demandes
                switchDisplayedDiv('demandesTable-container','nouvelleDemande-container'); //retourne à la liste des demandes
            }

            /* Envoie le fichier pour être attaché à la requête                             */
            /* Fonction récursive si fichier volumineux (évite les limites)                 */
            /*------------------------------------------------------------------------------*/
            function callRemoteActionUploadFile(caseId, fileId, onSuccess) {
                var attachmentBody = "";
                if(fileSize <= positionIndex + chunkSize) {
                    attachmentBody = attachment.substring(positionIndex);
                    doneUploading = true;
                } else {
                    attachmentBody = attachment.substring(positionIndex, positionIndex + chunkSize);
                }
                // Appel remote action
                Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.Ctrl_Site_EspaceClient.transfertFichier}', caseId, fileId, attachmentBody, attachmentName, attachmentType,
                    function(result, event) {
                        if(event.type === 'exception') {
                            displayMessage('contact', 'error', event.message);
                        } else if(event.status) {
                            // Vérifie si erreur et continue le transfert
                            if(result.substring(0,3) == '00P') {
                                if(doneUploading == true) {
                                    onSuccess();
                                } else {
                                    // Continue le transfert
                                    positionIndex += chunkSize;
                                    callRemoteActionUploadFile(caseId, result, onSuccess);
                                }
                            }
                        } else {
                            displayMessage('contact', 'error', event.message);
                        }
                    },
                    {buffer: true, escape: true, timeout: 120000}
                );
            }

            /* Réouverture d'une demande                                                    */
            /*------------------------------------------------------------------------------*/
            function callRemoteActionRouvrirDemande(caseId) {
                // Désactivation bouton
                eraseMessage('contact');
                eraseMessage('attachment');
                eraseMessage('demande-statusChange');
                eraseMessage('comments');
                j$('[id$=rouvrirDemande]').button('loading');
                j$('[id$=rouvrirDemande]').attr('disabled', true);
                var commentText = j$("[id$=demande_statusComment]").val();
                // Appel remote action
                Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.Ctrl_Site_EspaceClient.rouvrirDemande}', caseId, commentText,
                    function(result, event) {
                        if (event.status) {
                            rerenderForStatusChange(caseId);
                        } else if (event.type === 'exception') {
                            displayMessage('demande-statusChange', 'error', event.message);
                        } else {
                            displayMessage('demande-statusChange', 'error', event.message);
                        }
                        // Activation bouton
                        j$('[id$=rouvrirDemande]').button('reset');
                        j$('[id$=rouvrirDemande]').attr('disabled', false);
                    },
                    {buffer: true, escape: true, timeout: 120000}
                );
            } 

            /* Cloture d'une demande                                                        */
            /*------------------------------------------------------------------------------*/
            function callRemoteActionCloreDemande(caseId) {
                // Désactivation bouton
                eraseMessage('contact');
                eraseMessage('attachment');
                eraseMessage('demande-statusChange');
                eraseMessage('comments');
                j$('[id$=cloreDemande]').button('loading');
                j$('[id$=cloreDemande]').attr('disabled', true);
                var commentText = j$("[id$=demande_statusComment]").val();
                // Appel remote action
                Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.Ctrl_Site_EspaceClient.cloreDemande}', caseId, commentText,
                    function(result, event) {
                        if (event.status) {
                            rerenderForStatusChange(caseId);
                        } else if (event.type === 'exception') {
                            displayMessage('demande-statusChange', 'error', event.message);
                        } else {
                            displayMessage('demande-statusChange', 'error', event.message);
                        }
                        // Activation bouton
                        j$('[id$=cloreDemande]').button('reset');
                        j$('[id$=cloreDemande]').attr('disabled', false);
                    },
                    {buffer: true, escape: true, timeout: 120000}
                );
            }  

            /* Ajout d'un commentaire à la demande                                          */
            /*------------------------------------------------------------------------------*/
            function callRemoteActionPostComment(caseId) {
                // Désactivation bouton
                eraseMessage('contact');
                eraseMessage('attachment');
                eraseMessage('demande-statusChange');
                eraseMessage('comments');
                j$('[id$=postComment]').button('loading');
                j$('[id$=postComment]').attr('disabled', true);
                var commentText = j$("[id$=demande_newComment]").val();
                // Appel remote action
                Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.Ctrl_Site_EspaceClient.postComment}', caseId, commentText,
                    function(result, event) {
                        if (event.status) {
                            rerenderDemandeComments(caseId);
                        } else if (event.type === 'exception') {
                            displayMessage('comments', 'error', event.message, 'text');
                        } else {
                            displayMessage('comments', 'error', event.message, 'text');
                        }
                        // Activation bouton
                        j$('[id$=postComment]').button('reset');
                        j$('[id$=postComment]').attr('disabled', false);
                    },
                    {buffer: true, escape: true, timeout: 120000}
                );                
            }

            /* Ajout d'une pièce jointe à la demande                                        */
            /*------------------------------------------------------------------------------*/
            function callRemoteActionAddAttachment(caseId) {
                // Désactivation bouton
                eraseMessage('contact');
                eraseMessage('attachment');
                eraseMessage('demande-statusChange');
                eraseMessage('comments');
                // Vérifie la présence d'un fichier
                var fichier = document.getElementById('demande_addAttachement').files[0];
                caseIdGlobal = caseId;
                if(fichier != undefined) { //si il y'a un fichier joint à upload
                    j$('[id$=envoyerAttachement]').button('loading');
                    j$('[id$=envoyerAttachement]').attr('disabled', true);
                    var result = uploadFile(caseId, fichier, addAttachmentSucces, 'attachment', 'text');
                    if(result==false) {                        
                        j$('[id$=envoyerAttachement]').attr('disabled', false);
                        j$('[id$=envoyerAttachement]').button('reset');
                    }
                } else {
                    displayMessage('attachment', 'error', "{!$Label.espaceclient_msg_NoAttachment}", 'text');
                    j$('[id$=envoyerAttachement]').attr('disabled', false);
                    j$('[id$=envoyerAttachement]').button('reset');
                }
            }

            function addAttachmentSucces() {
                j$('[id$=envoyerAttachement]').attr('disabled', false);
                j$('[id$=envoyerAttachement]').button('reset');
                rerenderDemande(caseIdGlobal); // rafraichi détail de la demande
            }

            /* Téléchargement du fichier d'export de données */
            /*------------------------------------------------------------------------------*/
            function callRemoteActionJsonExportDonnees() {
                // Désactivation bouton et supprime les message
                eraseMessage("donneesperso");
                j$("#jsonExportDonnees").button('loading');
                j$("#jsonExportDonnees").attr('disabled', true);
                
                Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.Ctrl_Site_EspaceClient.jsonExportDonnees}', '{!accountInitial.Id}',
                function(result, event) {
                    if (event.status) {
                        // Export OK
                        var blob = new Blob([result], { type: 'text/' });
                        if (navigator.msSaveBlob) { // IE 10+
                            navigator.msSaveBlob(blob, "001L000000WZYYuIAP.json");
                        } else {
                            var link = document.createElement("a");
                            if (link.download !== undefined) { // feature detection
                                // Browsers that support HTML5 download attribute
                                var url = URL.createObjectURL(blob);
                                link.setAttribute("href", url);
                                link.setAttribute("download", "{!account.prenom}_{!account.nom}.json");
                                link.style.visibility = 'hidden';
                                document.body.appendChild(link);
                                link.click();
                                document.body.removeChild(link);
                            }
                        }
                    } else if (event.type === 'exception') {
                        displayMessage('donneesperso', 'error', event.message);
                    } else {
                        displayMessage('donneesperso', 'error', event.message);
                    }
                    // Activation bouton export
                    j$("#jsonExportDonnees").button('reset');
                    j$("#jsonExportDonnees").attr('disabled', false);
                },
                {escape: false});
            }

            /* Modification du compte                                                       */
            /*------------------------------------------------------------------------------*/
            function callRemoteActionUpdateAccount() {
                var objectAccountValue = new Object();
                var isPersonAccount;
                // Désactivation bouton sauvegarde et supprime les message
                eraseMessage('coord');
                j$('[id$=modifcationCoordonnees]').button('loading');
                j$('[id$=modifcationCoordonnees]').attr('disabled', true);
                geocodeAddress(); // Géocodage
                // Valeurs
                isPersonAccount = ('{!account.isPersonAccount}' == 'true') ? true : false;
                objectAccountValue.civilite = j$('[id$=coord_civilite]').val();
                objectAccountValue.prenom = j$('[id$=coord_prenom]').val();
                objectAccountValue.nom = j$('[id$=coord_nom]').val();
                objectAccountValue.rue = j$('[id$=adresse_rue]').val();
                objectAccountValue.codePostal = j$('[id$=postal_code]').val();
                objectAccountValue.ville = j$('[id$=locality]').val();
                objectAccountValue.etage = j$('[id$=coord_etage]').val();
                objectAccountValue.interphone = j$('[id$=coord_interphone]').val();
                objectAccountValue.complementAdresse = j$('[id$=coord_complementAdresse]').val();
                objectAccountValue.telephoneDomicile = j$('[id$=coord_telephoneDomicile]').val();
                objectAccountValue.telephoneMobile = j$('[id$=coord_telephoneMobile]').val();
                objectAccountValue.autreTelephone = j$('[id$=coord_autreTelephone]').val();
                objectAccountValue.email = j$('[id$=coord_email]').val();
                objectAccountValue.phone = j$('[id$=coord_phone]').val();
                objectAccountValue.telephoneMobilePro = j$('[id$=coord_telephoneMobile_pro]').val();
                objectAccountValue.autreTelephonePro = j$('[id$=coord_autreTelephone_pro]').val();
                objectAccountValue.fax = j$('[id$=coord_fax]').val();
                objectAccountValue.canalPrefere = j$('[id$=coord_canalPrefere]').val();
                objectAccountValue.optinAdresseEmailKparK = j$('[id$=coord_optinMailK]').is(':checked');
                objectAccountValue.optinAdresseEmailPartenaire = j$('[id$=coord_optinMailP]').is(':checked');
                objectAccountValue.optinSMSKparK = j$('[id$=coord_optinSMSK]').is(':checked');
                objectAccountValue.optinSMSPartenaire = j$('[id$=coord_optinSMSP]').is(':checked');
                objectAccountValue.optinTelephoneDomicileKparK = j$('[id$=coord_optinTelephoneDomK]').is(':checked');
                objectAccountValue.optinTelephoneDomicilePartenaire = j$('[id$=coord_optinTelephoneDomP]').is(':checked');
                objectAccountValue.optinTelephoneMobileKparK = j$('[id$=coord_optinTelephoneMobK]').is(':checked');
                objectAccountValue.optinTelephoneMobilePartenaire = j$('[id$=coord_optinTelephoneMobP]').is(':checked');
                objectAccountValue.localisationLatitude = j$('[id$=adresse_latitude]').val();
                objectAccountValue.localisationLongitude = j$('[id$=adresse_longitude]').val();

                // Appel remote action
                Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.Ctrl_Site_EspaceClient.updateAccount}', '{!accountInitial.Id}', '{!user}', objectAccountValue,
                    function(result, event) {
                        if (event.status) {
                            // Message de succès
                            displayMessage('coord', 'success', labels.MSG_ACC_UPDATESUCCESSFUL);
                        } else if (event.type === 'exception') {
                            displayMessage('coord', 'error', event.message);
                        } else {
                            displayMessage('coord', 'error', event.message);
                        }
                        // Activation bouton envoie demande
                        j$('[id$=modifcationCoordonnees]').button('reset');
                        j$('[id$=modifcationCoordonnees]').attr('disabled', false);
                    },
                    {buffer: true, escape: true, timeout: 120000}
                );
            }

            /* Envoi demande de rappel téléphonique                                        */
            /*------------------------------------------------------------------------------*/
            function callRemoteActionNotifyTel(button, component) {
                // Désactivation bouton et supprime les message
                eraseMessage(component+'-ask-tel-number');
                j$('#'+button.id).button('loading');
                j$('#'+button.id).attr('disabled', true);
                //Valeur
                var numTel = j$('#'+component+'-ask-tel-number').val();
                // Appel remote action
                Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.Ctrl_Site_EspaceClient.sendNotifyTelCallBack}', numTel, '{!accountInitial.Id}',
                    function(result, event) {
                        if (event.status) {
                            // Message de succès
                            j$('#'+component+'-ask-tel-items').removeClass("show").addClass("hidden")
                            j$('#'+component+'-ask-tel-number-meessage').addClass("message-success");
                            displayMessage(component+'-ask-tel-number', 'success', labels.MSG_CALL_SUCCESSFUL);
                        } else if (event.type === 'exception') {
                            displayMessage(component+'-ask-tel-number', 'error', event.message);
                        } else {
                            displayMessage(component+'-ask-tel-number', 'error', event.message);
                        }
                        // Activation bouton
                        j$('#'+button.id).button('reset');
                        j$('#'+button.id).attr('disabled', false);
                    },
                    {buffer: true, escape: true, timeout: 120000}
                );
            }

            /* Envoi demande de changement de mot de passe                                       */
            /*------------------------------------------------------------------------------*/
            function changePassword(button) {
                // Récupération des valeurs saisies
                var ancienMDP = j$('[id$=motdepasse_ancienMDP]');
                var nouveauMDP = j$('[id$=motdepasse_nouveauMDP]');
                var confirmMDP = j$('[id$=motdepasse_confirmNouveauMDP]');
                desactivateButton(button);

                eraseMessage('motdepasse');
                // Appel remote action
                Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.Ctrl_Site_EspaceClient.requestNewPassword}', '{!accountInitial.Id}', ancienMDP.val(), nouveauMDP.val(), confirmMDP.val(),
                    function(result, event) {
                        if (event.status) {
                            // Message de succès
                            if(result == null) {
                                displayMessage('motdepasse', 'success', labels.MSG_MDP_SUCCESSFUL);
                                ancienMDP.val('');
                                nouveauMDP.val('');
                                confirmMDP.val('');
                                Cookies.remove("apex__sessionKPK");
                            } else
                                displayMessage('motdepasse', 'error', result);
                        } else if (event.type === 'exception') {
                            displayMessage('motdepasse', 'error', event.message);
                        } else {
                            displayMessage('motdepasse', 'error', event.message);
                        }
                        // Activation bouton
                        activateButton(button);
                    },
                    {buffer: true, escape: true, timeout: 120000}
                );
            }

            function rerenderForStatusChange(caseId) {
                rerenderDemande(caseId);
                rerenderDemandes();
                closeStatusChangePopup();
            }

            function closeStatusChangePopup() {
                hideElement('demande-statusChange-container');
            }
        </script>

        <apex:stylesheet value="{!URLFOR($Resource.ionRangeSlider_js, 'css/ion.rangeSlider.css')}" />
        <apex:stylesheet value="{!URLFOR($Resource.ionRangeSlider_js, 'css/ion.rangeSlider.skinHTML5.css')}" />
        <apex:stylesheet value="{!URLFOR($Resource.Font_awesome, 'css/font-awesome.min.css')}" />
        <apex:stylesheet value="{!URLFOR($Resource.DataTables_js, 'DataTables-1.10.6/plugin/dataTables.bootstrap.css')}" />
        <apex:stylesheet value="{!URLFOR($Resource.Bootstrap_Ressources, 'dist/css/bootstrap.min.css')}" />
        <apex:stylesheet value="{!URLFOR($Resource.Site_Espace_Client, 'css/espace_client.min.css')}" />
        <apex:stylesheet value="{!URLFOR($Resource.Site_Espace_Client, 'css/notification.min.css')}" />
        <apex:stylesheet value="{!URLFOR($Resource.Site_Espace_Client, 'css/progress_bar.min.css')}" />
    </head>
    <body style="background-color: white; margin: 0px;">
        <!--apex:remoteObjects jsNamespace="RemoteObjectModel">
            <apex:remoteObjectModel name="NotificationEspaceClient__c" jsShorthand="Notifications"/>
        </apex:remoteObjects-->
        <div class="espaceclient">
            <!-- HEADER -->
            <div id="header-container" class="hidden-xs header">
                <div class="row">
                    <div id="top-header-container" class="row header-top">
                        <div class="col-md-10 col-lg-10 col-lg-offset-1 col-md-offset-1 vertical-align">
                            <div class="col-md-6 col-sm-6">
                                <img src="{!URLFOR($Resource.Site_Espace_Client, 'img/logo_kpark.png')}" alt="Logo KparK" class="img-responsive header-logo" />
                            </div>
                            <div class="col-md-6 col-sm-6">
                                <div class="pull-right navbar-right">
                                    <div class="header-row-button">{!account.civilite} {!account.nom} {!account.prenom}</div>
                                    <div class="header-row-button hidden">
                                        <a id="notifications" href="#">
                                            <span aria-hidden="true" class="fa fa-bell"></span>
                                        </a>
                                    </div>
                                    <div class="header-row-button dropdown">
                                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                                            <span aria-hidden="true" class="glyphicon glyphicon-user"></span>
                                            <span class="caret"></span>
                                        </a>
                                        <div id="dropdown-main-menu" class="dropdown-menu" style="min-width:210px;">
                                            <div id="dropdown-identity">
                                                <div id="dropdown-name">{!account.nom} {!account.prenom}</div>
                                                <div id="dropdown-email">{!account.email}</div>
                                            </div>
                                            <ul class="nav nav-tabs" role="tablist" id="navProfilListe">
                                                <li role="presentation" class="menu-item" onclick="updateMenuItems('#coord', 'bs-kpark-navbar-collapse-1')">
                                                    <a href="#coord" role="tab" data-toggle="tab" aria-controls="coord" class="no-border">
                                                        <span class="fa fa-tags header-nav-icon" aria-hidden="true"></span> MES COORDONNÉES
                                                    </a>
                                                </li>
                                                <li role="presentation" class="menu-item" onclick="updateMenuItems('#motdepasse', 'bs-kpark-navbar-collapse-1')">
                                                    <a href="#motdepasse" role="tab" data-toggle="tab" aria-controls="motdepasse" class="no-border">
                                                        <span class="glyphicon glyphicon-lock header-nav-icon" aria-hidden="true"></span> MON MOT DE PASSE
                                                    </a>
                                                </li>
                                                <li role="presentation" class="menu-item" onclick="updateMenuItems('#parrainage', 'bs-kpark-navbar-collapse-1')">
                                                    <a href="#parrainage" role="tab" data-toggle="tab" aria-controls="parrainage" class="no-border">
                                                        <span class="fa fa-users header-nav-icon" aria-hidden="true"></span> MES PARRAINAGES
                                                    </a>
                                                </li>
                                                <li role="presentation" class="menu-item" onclick="updateMenuItems('#demandes', 'bs-kpark-navbar-collapse-1')">
                                                    <a href="#demandes" role="tab" data-toggle="tab" class="no-border">
                                                        <span class="glyphicon glyphicon-question-sign header-nav-icon" aria-hidden="true"></span> MES DEMANDES
                                                    </a>
                                                </li>
                                                <li role="presentation" class="menu-item" onclick="updateMenuItems('#donneesperso', 'bs-kpark-navbar-collapse-1');">
                                                    <a href="#donneesperso" role="tab" data-toggle="tab" class="no-border">
                                                        <span class="glyphicon glyphicon-floppy-saved header-nav-icon" aria-hidden="true"></span> UTILISATION DES DONNEES PERSONNELLES
                                                    </a>
                                                </li>
                                                <li role="presentation" class="menu-item" onclick="updateMenuItems('#documents', 'bs-kpark-navbar-collapse-1')">
                                                    <a href="#documents" role="tab" data-toggle="tab" class="no-border">
                                                        <span class="glyphicon glyphicon-folder-open header-nav-icon" aria-hidden="true"></span> MES DOCUMENTS
                                                    </a>
                                                </li>
                                                <li class="divider">##########################</li>
                                                <li role="presentation" class="menu-item" onclick="updateMenuItems('#contactUs', 'bs-kpark-navbar-collapse-1')">
                                                    <a href="#contactUs" role="tab" data-toggle="tab" aria-controls="contactUs" class="no-border">
                                                        <span class="glyphicon glyphicon-comment header-nav-icon" aria-hidden="true"></span> NOUS CONTACTER
                                                    </a>
                                                </li>
                                                <li role="presentation" class="menu-item">
                                                    <a href="#" role="tab" data-toggle="tab" onclick="deconnexion();" class="no-border">
                                                        <span class="glyphicon glyphicon-off header-nav-icon" aria-hidden="true"></span> DECONNEXION
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="panel-notifications hidden">
                                        <div class="panel-heading">
                                            <div class="pull-left">
                                                <h6 class="panel-title">
                                                    Notifications
                                                </h6>
                                            </div>
                                            <div class="pull-right">
                                                <a aria-label="Close" class="close" id="notification_closeAll" onclick="closeAllNotifications(this)" style="
                                                    font-size: inherit; padding-top: 5px; padding-right: 5px; color: #ca2046; opacity: 1;">
                                                    EFFACER
                                                </a>
                                            </div>
                                        </div>
                                        <div class="panel-body">
                                            <div class="notifications">
                                                <apex:outputpanel layout="block" rendered="{!notificationsClient.size = 0}">
                                                    <p class="text-center text-not">Pas de notifications</p>
                                                </apex:outputpanel>
                                                <apex:repeat value="{!notificationsClient}" var="notification" rendered="{!notificationsClient.size > 0}">
                                                    <div class="notification" id="notification_{!notification.Id}">
                                                        <div class="col-lg-1 col-md-1 col-sm-1 col-xs-1 content-left">
                                                            <div class="icon-close">
                                                                <a aria-label="Close" onclick="closeNotification('{!notification.Id}')"><span aria-hidden="true" class="fa fa-trash"></span></a>
                                                            </div>
                                                        </div>
                                                        <div class="col-lg-11 col-md-11 col-sm-11 col-xs-11 content-right notification-id" id="{!notification.Id}">
                                                            <h5 class="text-red"><strong>{!notification.numeroContrat}</strong></h5>
                                                            <div class="col-lg-8 col-md-8 col-sm-8 col-xs-8 notification-label">
                                                                <span class="text-grey">{!notification.texte}</span>
                                                            </div>
                                                            <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 notification-value">
                                                                <span class="text-green">{!notification.valeur}</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </apex:repeat>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="mid-header-container" class="header-middle">
                        <div class="row header-row-middle">
                            <div class="col-md-10 col-lg-10 col-lg-offset-1 col-md-offset-1 vertical-align">
                                <div class="col-md-6 col-sm-6">
                                    <h1 class="header-title">Votre espace client</h1>
                                    <h4><small class="header-title">Bienvenue au sein de votre espace client. Vous pourrez suivre l'avancement de vos projets en temps réel. Et pour un meilleur suivi, n'oubliez pas de mettre à jour vos coordonnées !</small></h4>
                                </div>
                                <div class="col-md-6 col-sm-6">
                                    <div class="col-md-10 col-lg-9 pull-right">
                                        <div class="header-info-vendeur">
                                            <div class="media">
                                                <div class="media-left pull-left">
                                                    <img src="{!URLFOR($Resource.Site_Espace_Client, 'img/icone_vendeur.png')}" alt="Icone vendeur" aria-hidden="true" height="36px" />
                                                </div>
                                                <div class="media-body">
                                                    <small class="header-title">Votre conseiller K par K</small><br />
                                                    <span class="header-vendeur">{!contactVendeurName}</span>
                                                </div>
                                            </div>
                                            <p class="header-body">Pour des informations sur vos projets ou devis, votre conseiller est joignable <apex:outputtext escape="false" value="{!contactVendeurJoignabilite}" /></p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div id="horizontal-nav-menu" class="col-md-10 col-lg-10 col-lg-offset-1 col-md-offset-1">
                                <ul class="nav nav-tabs header-nav" role="tablist">
                                    <li role="presentation" class="menu-item active" onclick="updateMenuItems('#dashboard', 'bs-kpark-navbar-collapse-1')">
                                        <a href="#dashboard" role="tab" data-toggle="tab" aria-controls="dashboard">
                                            <span class="fa fa-pie-chart header-nav-icon" aria-hidden="true"></span> TABLEAU DE BORD
                                        </a>
                                    </li>
                                    <li role="presentation" class="menu-item" onclick="updateMenuItems('#projets', 'bs-kpark-navbar-collapse-1')">
                                        <a href="#projets" role="tab" data-toggle="tab" aria-controls="projets">
                                            <span class="fa fa-briefcase header-nav-icon" aria-hidden="true"></span> MES PROJETS
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div><!-- /.header -->
            <nav class="navbar navbar-custom hidden-lg hidden-md hidden-sm ">
                <div class="container-fluid">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-kpark-navbar-collapse-1" aria-expanded="false">
                            <span class="sr-only">Menu de navigation</span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <div class="navbar-notification hidden">
                            <a href="#" data-toggle="collapse" data-target="#bs-kpark-notification-collapse-1" aria-expanded="false">
                                <span aria-hidden="true" class="fa fa-bell"></span>
                            </a>
                        </div>
                        <div class="text-center">
                            <p class="navbar-text">Espace client</p>
                        </div>
                        <!--
                        <a class="navbar-brand" href="#" style="padding: 9px 9px;">
                            <img src="{!URLFOR($Resource.Site_Favicon)}" alt="Logo KparK" />
                        </a>
                         -->
                    </div>
                    <!-- Collect the nav links, forms, and other content for toggling -->
                    <div class="collapse navbar-collapse" id="bs-kpark-navbar-collapse-1">
                        <ul class="nav navbar-nav">
                            <li class="menu-item active" onclick="updateMenuItems('#dashboard', 'header-container')">
                                <a href="#dashboard" role="tab" data-toggle="tab">
                                    <span class="fa fa-pie-chart header-nav-icon" aria-hidden="true"></span> Tableau de bord
                                </a>
                            </li>
                            <li class="menu-item" onclick="updateMenuItems('#projets', 'header-container')">
                                <a href="#projets" role="tab" data-toggle="tab">
                                    <span class="fa fa-briefcase header-nav-icon" aria-hidden="true"></span> Mes projets
                                </a>
                            </li>
                            <li class="menu-item" onclick="updateMenuItems('#coord', 'header-container')">
                                <a href="#coord" role="tab" data-toggle="tab">
                                    <span class="fa fa-tags header-nav-icon" aria-hidden="true"></span> Mes coordonnées
                                </a>
                            </li>
                            <li class="menu-item" onclick="updateMenuItems('#motdepasse', 'header-container')">
                                <a href="#motdepasse" role="tab" data-toggle="tab">
                                    <span class="fa fa-tags header-nav-icon" aria-hidden="true"></span> Mon mot de passe
                                </a>
                            </li>
                            <li class="menu-item" onclick="updateMenuItems('#parrainage', 'header-container')">
                                <a href="#parrainage" role="tab" data-toggle="tab">
                                    <span class="fa fa-users header-nav-icon" aria-hidden="true"></span> Mes parrainages
                                </a>
                            </li>
                            <li class="menu-item" onclick="updateMenuItems('#demandes', 'header-container')">
                                <a href="#demandes" role="tab" data-toggle="tab">
                                    <span class="glyphicon glyphicon-question-sign header-nav-icon" aria-hidden="true"></span> Mes demandes
                                </a>
                            </li>
                            <li class="menu-item" onclick="updateMenuItems('#donneesperso', 'header-container')">
                                <a href="#donneesperso" role="tab" data-toggle="tab">
                                    <span class="glyphicon glyphicon-floppy-saved header-nav-icon" aria-hidden="true"></span> Utilisation des données personnelles 
                                </a>
                            </li>
                            <li class="menu-item" onclick="updateMenuItems('#documents', 'header-container')">
                                <a href="#documents" role="tab" data-toggle="tab">
                                    <span class="glyphicon glyphicon-folder-open header-nav-icon" aria-hidden="true"></span> Mes documents
                                </a>
                            </li>
                            <li class="menu-item" onclick="updateMenuItems('#contactUs', 'header-container')">
                                <a href="#contactUs" role="tab" data-toggle="tab">
                                    <span class="glyphicon glyphicon-comment header-nav-icon" aria-hidden="true"></span> Nous contacter
                                </a>
                            </li>
                        </ul>
                        <ul class="nav navbar-nav navbar-right menu-item">
                            <li>
                                <a href="#" role="tab" data-toggle="tab" onclick="deconnexion();">
                                    <span class="glyphicon glyphicon-off" aria-hidden="true"></span> Déconnexion
                                </a>
                            </li>
                        </ul>
                    </div><!-- /.navbar-collapse -->

                    <div class="collapse navbar-collapse" id="bs-kpark-notification-collapse-1">
                        <div class="nav-notifications">
                            <apex:outputpanel layout="block" rendered="{!notificationsClient.size = 0}">
                                <p class="text-center text-not">Pas de notifications</p>
                            </apex:outputpanel>
                            <apex:repeat value="{!notificationsClient}" var="notification" rendered="{!notificationsClient.size > 0}">
                                <div class="nav-notification" id="notification_nav_{!notification.Id}">
                                    <div class="col-lg-1 col-md-1 col-sm-1 col-xs-1 content-left">
                                        <div class="icon-close">
                                            <a aria-label="Close" onclick="closeNotification('{!notification.Id}')"><span aria-hidden="true" class="fa fa-trash"></span></a>
                                        </div>
                                    </div>
                                    <div class="col-lg-11 col-md-11 col-sm-11 col-xs-11 content-right">
                                        <h5 class="text-red"><strong>{!notification.numeroContrat}</strong></h5>
                                        <div class="col-lg-8 col-md-8 col-sm-8 col-xs-8 notification-label">
                                            <span>{!notification.texte}</span>
                                        </div>
                                        <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 notification-value">
                                            <span class="text-green">{!notification.valeur}</span>
                                        </div>
                                    </div>
                                </div>
                            </apex:repeat>
                        </div>
                    </div><!-- /.notification-collapse -->
                </div><!-- /.container-fluid -->
            </nav><!-- /.navbar-custom -->
            <!-- CONTENU -->
            <div class="" style="background: white; margin-top: 30px;" id="container">
                <div id="pageMessages" class="col-md-12 col-sm-12 col-xs-12 hidden"></div>
                <!-- Tab panes -->
                <div class="tab-content">
                    <!-- Fenêtes modal Contrats -->
                    <apex:repeat value="{!contratsClient}" var="contrat" id="contrat">
                        <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="contrat_modalLabel{!contrat.Id}" id="contrat_modal{!contrat.Id}">
                            <div class="modal-dialog modal-lg modal-sm modal-custom" style="max-width:100%" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h3 class="modal-title" id="contrat_modalLabel{!contrat.Id}">
                                            <a class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="glyphicon glyphicon-remove"></span></a>
                                            Devis {!contrat.nomContrat} (N° {!contrat.numeroContrat})
                                        </h3>
                                    </div>
                                    <div id="contrat_modalPanel{!contrat.Id}" data-toggle="false" class="modal-body" role="tabpanel">
                                        <div class="col-md-6 col-sm-6">
                                            <div class="well">
                                                <div class="media">
                                                    <div class="media-left">
                                                        <img src="{!URLFOR($Resource.Site_Espace_Client, 'img/icone_small_chantier.png')}" class="modal-img" alt="Icone chantier" aria-hidden="true" />
                                                    </div>
                                                    <div class="media-body">
                                                        <address style="margin-bottom : 0">
                                                            <strong class="text-grey">ADRESSE DU CHANTIER</strong><br />
                                                            {!contrat.chantier.rue__c}<br />
                                                            <apex:outputpanel layout="none" rendered="{!IF(contrat.chantier.codePostal__c != null, true, false)}">
                                                                {!contrat.chantier.codePostal__c},
                                                            </apex:outputpanel>
                                                            {!UPPER(contrat.chantier.ville__c)}
                                                            <apex:outputpanel layout="none" rendered="{!IF((contrat.chantier.pays__c != null) && (contrat.chantier.pays__c != '') && (LOWER(contrat.chantier.pays__c) != 'france'), true, false)}">
                                                                <br /> {!contrat.chantier.pays__c}
                                                            </apex:outputpanel>
                                                        </address>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6 col-sm-6">
                                            <div class="well">
                                                <div class="media">
                                                    <div class="media-left">
                                                        <span class="text-grey modal-glyphicon glyphicon glyphicon-euro" aria-hidden="true"></span>
                                                    </div>
                                                    <div class="media-body">
                                                        <address style="margin-bottom : 0">
                                                            <strong class="text-grey">ADRESSE DE FACTURATION</strong><br />
                                                            {!contrat.compte.rue__c}<br />
                                                            <apex:outputpanel layout="none" rendered="{!IF(contrat.compte.codePostal__c != null, true, false)}">
                                                                {!contrat.compte.codePostal__c},
                                                            </apex:outputpanel>
                                                            {!UPPER(contrat.compte.ville__c)}
                                                            <apex:outputpanel layout="none" rendered="{!IF((contrat.compte.pays__c != null) && (contrat.compte.pays__c != '') && (LOWER(contrat.compte.pays__c) != 'france'), true, false)}">
                                                                <br /> {!contrat.compte.pays__c}
                                                            </apex:outputpanel>
                                                        </address>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="panel">
                                        <div class="panel-body">
                                            <div class="col-md-6 col-sm-6">
                                                <dl class="dl-horizontal">
                                                    <dt class="text-grey">VOTRE CONSEILLER</dt>
                                                    <dd><apex:outputtext value="{!IF(contrat.nomVendeur != '', contrat.nomVendeur, '&nbsp;')}" escape="false" /></dd>
                                                    <dt class="text-grey">STATUT DU CONTRAT</dt>
                                                    <dd><apex:outputtext value="{!IF(contrat.statut != '', contrat.statut, '&nbsp;')}" escape="false" /></dd>
                                                    <dt class="text-grey">DATE DE SIGNATURE</dt>
                                                    <dd><apex:outputtext value="{0, date, dd/MM/yyyy}"><apex:param value="{!contrat.dateDeSignature}" /></apex:outputtext></dd>
                                                    <apex:outputpanel layout="none" rendered="{!contrat.dateDeResiliation != null}">
                                                        <dt class="text-grey">DATE DE RÉSILIATION</dt>
                                                        <dd><apex:outputtext value="{0, date, dd/MM/yyyy}"><apex:param value="{!contrat.dateDeResiliation}" /></apex:outputtext></dd>
                                                        <dt class="text-grey">MOTIF DE RÉSILIATION</dt>
                                                        <dd><apex:outputtext value="{!IF(contrat.motifDeResiliation != '', contrat.motifDeResiliation, '&nbsp;')}" escape="false" /></dd>
                                                    </apex:outputpanel>
                                                </dl>
                                            </div>
                                            <div class="col-md-6 col-sm-6">
                                                <dl class="dl-horizontal">
                                                    <dt class="text-grey">TOTAL TTC</dt>
                                                    <dd>
                                                        <apex:outputText value="{!contrat.montantDevisTTC} €"> </apex:outputText>
                                                    </dd>
                                                    <dt class="text-grey">TVA</dt>
                                                    <dd>
                                                        <apex:outputpanel styleclass="glyphicon glyphicon-check" rendered="{!contrat.tvaReduite != 0}" />
                                                        <apex:outputpanel styleclass="text-grey glyphicon glyphicon-unchecked" rendered="{!contrat.tvaReduite == 0}" />
                                                        <apex:outputpanel style="padding-right:20px;" rendered="{!contrat.tvaReduite != 0}"> 5,5 %</apex:outputpanel>
                                                        <apex:outputpanel styleclass="text-grey" style="padding-right:20px;" rendered="{!contrat.tvaReduite == 0}"> 5,5 %</apex:outputpanel>
                                                        <apex:outputpanel styleclass="glyphicon glyphicon-check" rendered="{!contrat.tvaIntermediaire != 0}" />
                                                        <apex:outputpanel styleclass="text-grey glyphicon glyphicon-unchecked" rendered="{!contrat.tvaIntermediaire == 0}" />
                                                        <apex:outputpanel style="padding-right:20px;" rendered="{!contrat.tvaIntermediaire != 0}"> 10 %</apex:outputpanel>
                                                        <apex:outputpanel styleclass="text-grey" style="padding-right:20px;" rendered="{!contrat.tvaIntermediaire == 0}"> 10 %</apex:outputpanel>
                                                        <apex:outputpanel styleclass="glyphicon glyphicon-check" rendered="{!contrat.tvaNormal != 0}" />
                                                        <apex:outputpanel styleclass="text-grey glyphicon glyphicon-unchecked" rendered="{!contrat.tvaNormal == 0}" />
                                                        <apex:outputpanel style="padding-right:20px;" rendered="{!contrat.tvaNormal != 0}"> 20 %</apex:outputpanel>
                                                        <apex:outputpanel styleclass="text-grey" style="padding-right:20px;" rendered="{!contrat.tvaNormal == 0}"> 20 %</apex:outputpanel>
                                                    </dd>
                                                    <dt class="text-grey">MODE DE FINANCEMENT</dt>
                                                    <dd><apex:outputtext value="{!IF(contrat.modeDeFinancement != '', contrat.modeDeFinancement, '&nbsp;')}" escape="false" /></dd>
                                                </dl>
                                            </div>
                                        </div>
                                        <!-- Table de produits du contrat -->
                                        <apex:outputpanel layout="block" rendered="{!contrat.produitsContrat.size != 0}">
                                            <table class="table">
                                                <thead>
                                                    <tr>
                                                        <th class="text-grey">#</th>
                                                        <th class="text-grey">PRODUIT</th>
                                                        <th class="text-grey">QUANTITÉ</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <apex:repeat value="{!contrat.produitsContrat}" var="produit">
                                                        <tr>
                                                            <th scope="row">
                                                                <apex:outputpanel layout="none" rendered="{!produit.PricebookEntry.Product2.Idvisuel__c != null}">
                                                                    <img src="{!$Site.Prefix}/servlet/servlet.FileDownload?file={!produit.PricebookEntry.Product2.Idvisuel__c}" height="64px" width="64px" />
                                                                </apex:outputpanel>
                                                            </th>
                                                            <td>
                                                                <strong>{!produit.PricebookEntry.Product2.ProductCode} {!IF(NOT(ISBLANK(produit.Modele__c)),' - '+ produit.Modele__c,'')}</strong>
                                                                <table style="min-width:50%;">
                                                                    <thead>
                                                                        <tr>
                                                                            <th class="text-grey">Prix unitaire TTC</th>
                                                                            <th class="text-grey">Total TTC</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        <tr>
                                                                            <td class="text-red"><apex:outputfield value="{!produit.PrixTTCtarif__c}" /></td>
                                                                            <td class="text-red"><apex:outputfield value="{!produit.TotalTTCligne__c}" /></td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                            </td>
                                                            <td style="text-align:center;font-size:16px;">{!TEXT(produit.Quantity)}</td>
                                                        </tr>
                                                    </apex:repeat>
                                                </tbody>
                                            </table>
                                        </apex:outputpanel><!-- /.produits -->
                                        <!-- Table de produits de la commande -->
                                        <apex:outputpanel layout="block" rendered="{!contrat.produitsCommande.size != 0}">
                                            <table class="table">
                                                <thead>
                                                    <tr>
                                                        <th class="text-grey">#</th>
                                                        <th class="text-grey">PRODUIT</th>
                                                        <th class="text-grey">QUANTITÉ</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <apex:repeat value="{!contrat.produitsCommande}" var="produit">
                                                        <tr>
                                                            <th scope="row">
                                                                <apex:outputpanel layout="none" rendered="{!produit.Product2.Idvisuel__c != null}">
                                                                    <img src="{!$Site.Prefix}/servlet/servlet.FileDownload?file={!produit.Product2.Idvisuel__c}" height="64px" width="64px" />
                                                                </apex:outputpanel>
                                                            </th>
                                                            <td>
                                                                <strong>{!produit.reference__c} {!IF(NOT(ISBLANK(produit.name__c)),' - '+ produit.name__c,'')}</strong>
                                                                <table style="min-width:50%;">
                                                                    <thead>
                                                                        <tr>
                                                                            <th class="text-grey">Prix unitaire TTC</th>
                                                                            <th class="text-grey">Total TTC</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        <tr>
                                                                            <td class="text-red"><apex:outputfield value="{!produit.UnitPrice}" /></td>
                                                                            <td class="text-red"><apex:outputfield value="{!produit.TotalPrice}" /></td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                            </td>
                                                            <td style="text-align:center;font-size:16px;">{!TEXT(produit.Quantity)}</td>
                                                        </tr>
                                                    </apex:repeat>
                                                </tbody>
                                            </table>
                                        </apex:outputpanel><!-- /.produits -->
                                    </div><!-- /.modal-body -->
                                </div> <!-- /.modal-content -->
                            </div><!-- /.modal-dialog -->
                        </div><!-- /.modal -->
                    </apex:repeat><!-- /. Contrats -->
                    <!-- Onglet Tableau de Bord -->
                    <div role="tabpanel" class="tab-pane active" id="dashboard">
                        <div class="dashboard">
                            <div class="col-md-10 col-lg-10 col-lg-offset-1 col-md-offset-1">
                                <div class="col-md-12 col-sm-12 col-xs-12 col-lg-8">
                                    <div id="dashboard-encours">
                                        <div class="panel panel-custom">
                                            <div class="panel-heading">
                                                <h5 class="panel-title">
                                                    <span class="panel-title-glyphicon fa fa-info-circle"></span> VOS PROJETS EN COURS
                                                </h5>
                                            </div>
                                            <apex:outputpanel layout="none" rendered="{!contratsClientEnCours.size = 0}">
                                                <div class="panel-body">
                                                    <p>{!$Label.espaceclient_text_ProjectNoCurrent}</p>
                                                </div>
                                            </apex:outputpanel>
                                            <apex:repeat value="{!contratsClientEnCours}" var="projet" id="dashboard_ProjetEnCours" rendered="{!contratsClientEnCours.size > 0}">
                                                <div class="panel-body" style="margin-bottom: 20px;">
                                                    <div class="row">
                                                        <div class="col-md-6 col-sm-12 col-xs-12">
                                                            <h3 class="title">
                                                                Projet N°{!projet.numeroContrat}
                                                            </h3>
                                                            <p class="dashboard-links">
                                                                <a href="#" onclick="showProjet('{!projet.Id}');" style="margin-right: 10px"><small>VOIR LE PROJET</small></a>
                                                                <a data-toggle="modal" data-target="#contrat_modal{!projet.Id}"><small>VOIR LE DEVIS</small></a>
                                                            </p>
                                                            <input type="text" id="dashboardProgressBar-EC{!projet.Id}" class="dashboardProgressBar{!projet.Id}" name="dashboardProgressBar-EC" value="{!projet.etapeActuelle}" />
                                                        </div>
                                                        <div class="col-md-3 col-sm-6 col-xs-6 dasboard-states">
                                                            <h6 class="text-green">ÉTAT ACTUEL DU PROJET</h6>
                                                            <div class="panel panel-dashboard">
                                                                <div class="panel-body text-center state-current">
                                                                    <apex:image rendered="{!IF(projet.etapeActuelle == 'Signature du contrat', true, false)}" height="40px"
                                                                                value="{!URLFOR($Resource.Site_Espace_Client, 'img/contrat_white.png')}" alt="Icone contrat" html-aria-hidden="true" />
                                                                    <apex:image rendered="{!IF(projet.etapeActuelle == 'Métrage', true, false)}" height="40px"
                                                                                value="{!URLFOR($Resource.Site_Espace_Client, 'img/metrage_white.png')}" alt="Icone metrage" html-aria-hidden="true" />
                                                                    <apex:image rendered="{!IF(projet.etapeActuelle == 'Commande usine', true, false)}" height="40px"
                                                                                value="{!URLFOR($Resource.Site_Espace_Client, 'img/usine_white.png')}" alt="Icone usine" html-aria-hidden="true" />
                                                                    <apex:image rendered="{!IF(projet.etapeActuelle == 'Livraison au dépôt', true, false)}" height="40px"
                                                                                value="{!URLFOR($Resource.Site_Espace_Client, 'img/depot_white.png')}" alt="Icone depot" html-aria-hidden="true" />
                                                                    <apex:image rendered="{!IF(projet.etapeActuelle == 'Installation', true, false)}" height="40px"
                                                                                value="{!URLFOR($Resource.Site_Espace_Client, 'img/installation_white.png')}" alt="Icone installation" html-aria-hidden="true" />
                                                                    <p class="icon-label">{!projet.etapeActuelle}</p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-3 col-sm-6 col-xs-6 dasboard-states">
                                                            <h6 class="text-grey">PROCHAINE ÉTAPE</h6>
                                                            <div class="panel panel-dashboard">
                                                                <div class="panel-body text-center state-next">
                                                                    <apex:image rendered="{!IF(projet.prochaineEtape == 'Signature du contrat', true, false)}" height="40px"
                                                                                value="{!URLFOR($Resource.Site_Espace_Client, 'img/contrat_grey.png')}" alt="Icone contrat" html-aria-hidden="true" />
                                                                    <apex:image rendered="{!IF(projet.prochaineEtape == 'Métrage', true, false)}" height="40px"
                                                                                value="{!URLFOR($Resource.Site_Espace_Client, 'img/metrage_grey.png')}" alt="Icone metrage" html-aria-hidden="true" />
                                                                    <apex:image rendered="{!IF(projet.prochaineEtape == 'Commande usine', true, false)}" height="40px"
                                                                                value="{!URLFOR($Resource.Site_Espace_Client, 'img/usine_grey.png')}" alt="Icone usine" html-aria-hidden="true" />
                                                                    <apex:image rendered="{!IF(projet.prochaineEtape == 'Livraison au dépôt', true, false)}" height="40px"
                                                                                value="{!URLFOR($Resource.Site_Espace_Client, 'img/depot_grey.png')}" alt="Icone depot" html-aria-hidden="true" />
                                                                    <apex:image rendered="{!IF(projet.prochaineEtape == 'Installation', true, false)}" height="40px"
                                                                                value="{!URLFOR($Resource.Site_Espace_Client, 'img/installation_grey.png')}" alt="Icone installation" html-aria-hidden="true" />
                                                                    <apex:image rendered="{!IF(projet.prochaineEtape == '' || projet.prochaineEtape == 'Terminé', true, false)}" height="40px"
                                                                                value="{!URLFOR($Resource.Site_Espace_Client, 'img/terminer_grey.png')}" alt="Icone terminé" html-aria-hidden="true" />
                                                                    <p class="icon-label">{!projet.prochaineEtape}</p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </apex:repeat>
                                        </div>
                                    </div><!-- /.PROJETS EN COURS -->
                                    <div id="dashboard-termine" style="margin-top: 30px;">
                                        <div class="panel panel-custom">
                                            <div class="panel-heading">
                                                <h5 class="panel-title">
                                                    <span class="panel-title-glyphicon fa fa-check-circle"></span> VOS PROJETS TERMINÉS
                                                </h5>
                                            </div>
                                            <apex:outputpanel layout="none" rendered="{!contratsClientTermine.size = 0}">
                                                <div class="panel-body">
                                                    <p>{!$Label.espaceclient_text_ProjectNoFinish}</p>
                                                </div>
                                            </apex:outputpanel>
                                            <apex:repeat value="{!contratsClientTermine}" var="projet" id="dashboard_ProjetTermines" rendered="{!contratsClientTermine.size > 0}">
                                                <div class="panel-body" style="margin-bottom: 20px;">
                                                    <div class="row">
                                                        <div class="col-md-6 col-sm-12 col-xs-12">
                                                            <h3 class="title">
                                                                Projet N°{!projet.numeroContrat}
                                                            </h3>
                                                            <p class="dashboard-links">
                                                                <a href="#" onclick="showProjet('{!projet.Id}');" style="margin-right: 10px"><small>VOIR LE PROJET</small></a>
                                                                <a data-toggle="modal" data-target="#contrat_modal{!projet.Id}"><small>VOIR LE DEVIS</small></a>
                                                            </p>
                                                            <input type="text" id="dashboardProgressBar-Terminer{!projet.Id}" class="dashboardProgressBar{!projet.Id}" name="dashboardProgressBar-Terminer" value="Terminé" />
                                                        </div>
                                                        <div class="col-md-3 col-sm-6 col-xs-6 dasboard-states">
                                                            <h6 class="text-green">ÉTAT ACTUEL DU PROJET</h6>
                                                            <div class="panel panel-dashboard">
                                                                <div class="panel-body text-center state-current">
                                                                    <apex:image rendered="{!IF(projet.etapeActuelle == 'Service après vente', true, false)}" height="40px"
                                                                                value="{!URLFOR($Resource.Site_Espace_Client, 'img/sav_white.png')}" alt="Icone sav" html-aria-hidden="true" />
                                                                    <apex:image rendered="{!IF(projet.etapeActuelle == 'Terminé', true, false)}" height="40px"
                                                                                value="{!URLFOR($Resource.Site_Espace_Client, 'img/terminer_white.png')}" alt="Icone terminé" html-aria-hidden="true" />
                                                                    <apex:image rendered="{!IF(projet.etapeActuelle == 'Résilié', true, false)}" height="40px"
                                                                                value="{!URLFOR($Resource.Site_Espace_Client, 'img/terminer_white.png')}" alt="Icone résilié" html-aria-hidden="true" />
                                                                    <p class="icon-label">{!projet.etapeActuelle}</p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-3 col-sm-6 col-xs-6 dasboard-states">
                                                            <h6 class="text-grey">SAV</h6>
                                                            <div class="panel panel-dashboard">
                                                                <div class="panel-body text-center state-default">
                                                                    <p>
                                                                        Un problème ?<br />
                                                                        <a href="#" onclick='j$(".nav a[href=#demandes]").tab("show");' class="text-red">Contactez-nous</a>
                                                                    </p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </apex:repeat>
                                        </div>
                                    </div>
                                </div><!-- /.PROJETS TERMINES -->
                                <div class="col-lg-4 col-md-12 col-sm-12 col-xs-12">
                                    <div class="">
                                        <div class="panel panel-custom">
                                            <div class="panel-heading">
                                                <h5 class="panel-title">
                                                    <span class="panel-title-glyphicon fa fa-user"></span> COORDONNÉES
                                                </h5>
                                            </div>
                                            <div class="panel-body">
                                                <h3 class="title text-red">{!account.civilite} {!account.nom} {!account.prenom}</h3>
                                                <h6 class="text-grey">ADRESSE</h6>
                                                <address style="margin-bottom:0px;">
                                                    {!account.rue}<br />
                                                    <apex:outputpanel layout="none" rendered="{!IF(account.codePostal != null, true, false)}">
                                                        {!account.codePostal},
                                                    </apex:outputpanel>
                                                    {!UPPER(account.ville)}
                                                </address>
                                                <h6 class="text-grey">TÉLÉPHONE</h6>
                                                <p>
                                                    <apex:outputpanel layout="none" rendered="{!IF(account.telephoneDomicile != null, true, false)}">
                                                        <span aria-hidden="true" class="glyphicon glyphicon-home"></span> {!account.telephoneDomicile}<br />
                                                    </apex:outputpanel>
                                                    <apex:outputpanel layout="none" rendered="{!IF(account.telephoneMobile != null, true, false)}">
                                                        <span aria-hidden="true" class="glyphicon glyphicon-phone"></span> {!account.telephoneMobile}<br />
                                                    </apex:outputpanel>
                                                    <apex:outputpanel layout="none" rendered="{!IF(account.autreTelephone != null, true, false)}">
                                                        <span aria-hidden="true" class="glyphicon glyphicon-briefcase"></span> {!account.autreTelephone}
                                                    </apex:outputpanel>
                                                </p>
                                                <apex:outputpanel layout="none" rendered="{!IF(account.email != null, true, false)}">
                                                    <h6 class="text-grey">E-MAIL</h6>
                                                    <p>{!account.email}</p>
                                                </apex:outputpanel>
                                                <div class="text-center">
                                                    <a href="#" onclick='j$(".nav a[href=#coord]").tab("show");' class="btn-custom btn-custom-white">VOIR MES COORDONNÉES</a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="">
                                        <div class="panel panel-custom">
                                            <div class="panel-body">
                                                <h3 class="title text-red">Service clients</h3>
                                                <p>
                                                    Notre service clients est à votre écoute 6 jours sur 7 au <a href="tel:{!TELSUPPORT}" class="text-red number-phone">{!TELSUPPORT}</a> ou par e-mail <strong>
                                                        <a href="mailto:{!EMAILSUPPORT}" class="text-red">{!EMAILSUPPORT}</a>
                                                    </strong>
                                                </p>
                                                <div class="text-center">
                                                    <input type="button" value="FAÎTES VOUS RAPPELER" onclick='showAskTelNumber(this, "dashboard-ask-tel");' class="btn-custom btn-custom-white" id="dashboard-call-button" />
                                                </div>
                                                <div class="text-center ask-tel-number" id="dashboard-ask-tel" style="display: none;">
                                                    <span onclick='closeAskTelNumber("dashboard-call-button", "dashboard-ask-tel");' aria-hidden="true" class="glyphicon glyphicon-remove ask-tel-number-icon-close"></span>
                                                    <div class="ask-tel-number-body">
                                                        <div id="dashboard-ask-tel-items">
                                                            <span class="fa fa-phone icon-phone-add"></span>
                                                            <div class="items-phone-number">
                                                                <input placeholder="Saisissez votre numéro" class="ask-tel-number-input" title="Téléphone" pattern="[0-9]{10}" type="tel" id="dashboard-ask-tel-number" />
                                                                <input onclick='callRemoteActionNotifyTel(this, "dashboard");' type="button" value="OK" id="dashboard-ask-tel-button"
                                                                       class="btn-custom btn-custom-red btn-xs" style="padding: 5px 5px 3px 5px !important;" data-loading-text="TRAITEMENT" />
                                                            </div>
                                                        </div>
                                                        <div id="dashboard-ask-tel-number-message" class="message hidden">
                                                            <div id="dashboard-ask-tel-number-message_alert" class="message-alert">
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div><!-- /.col-md-10 col-lg-10 col-lg-offset-1 col-md-offset-1 -->
                        </div><!-- /.dasboard -->
                    </div><!-- /.tabpanel : TABLEAU DE BORD -->
                    <!-- Onglet Coordonnées -->
                    <div role="tabpanel" class="tab-pane" id="coord">
                        <div class="col-md-10 col-lg-10 col-lg-offset-1 col-md-offset-1">
                            <div id="coord-message" class="col-md-12 col-sm-12 col-xs-12 hidden">
                                <div id="coord-message_alert" class="alert">
                                </div>
                            </div>
                            <apex:form id="coord-formulaire">
                                <apex:actionfunction name="deconnexion" action="{!deconnexion}" />
                                <div class=" col-md-7 col-sm-6 col-xs-12">
                                    <div class="panel panel-custom">
                                        <div class="panel-heading">
                                            <h5 class="panel-title">
                                                IDENTIFICATION
                                            </h5>
                                        </div>
                                        <div class="panel-body">
                                            <c:formblock alignment="horizontal" rendered="{!account.isPersonAccount}">
                                                <div class="form-group">
                                                    <div class="col-lg-4 col-md-4">
                                                        <label class="control-label" for="{!$Component.coord_civilite}">Civilité</label><br />
                                                        <apex:selectlist id="coord_civilite" styleclass="form-control input-sm" value="{!account.civilite}" multiselect="false" size="1">
                                                            <apex:selectoption itemvalue="M." itemlabel="M." />
                                                            <apex:selectoption itemvalue="Mme" itemlabel="Mme" />
                                                        </apex:selectlist>
                                                    </div>
                                                    <div class="col-lg-4 col-md-4">
                                                        <label class="control-label" for="{!$Component.coord_prenom}">Prénom</label><br />
                                                        <apex:input value="{!account.prenom}" styleclass="form-control input-sm" id="coord_prenom" html-placeholder="Prénom" title="Prénom" type="text" />
                                                    </div>
                                                    <div class="col-lg-4 col-md-4">
                                                        <label class="control-label" for="{!$Component.coord_nom}">Nom <span class="required-field">*</span></label><br />
                                                        <apex:input value="{!account.nom}" styleclass="form-control input-sm" id="coord_nom" html-placeholder="Nom" title="Nom" type="text" />
                                                    </div>
                                                </div>
                                            </c:formblock>
                                            <c:formblock alignment="horizontal" rendered="{!NOT(account.isPersonAccount)}">
                                                <div class="form-group">
                                                    <div class="col-md-12">
                                                        <label class="control-label" for="{!$Component.coord_nom}">Nom du compte <span class="required-field">*</span></label><br />
                                                        <apex:input value="{!account.nom}" styleclass="form-control input-sm" id="coord_nom" html-placeholder="Nom" title="Nom" type="text" />
                                                    </div>
                                                </div>
                                            </c:formblock>
                                        </div>
                                    </div>
                                </div>
                                <div class=" col-md-5 col-sm-6 col-xs-12 pull-right">
                                    <div class="panel panel-custom">
                                        <div class="panel-heading">
                                            <h5 class="panel-title">
                                                COORDONNÉES
                                            </h5>
                                        </div>
                                        <div class="panel-body">
                                            <c:formblock alignment="horizontal">
                                                <div class="form-group">
                                                    <div class="col-md-12">
                                                        <label class="control-label" for="autocomplete">Adresse complète</label><br />
                                                        <input type="text" id="autocomplete" class="form-control input-sm" placeholder="Adresse complète" value="{!account.rue}, {!account.codePostal}, {!account.ville}"
                                                               onchange="setNullValue(this); eventOnChangeFieldValue(this);" onblur="eventOnBlurAutocomplete(this);" onfocus="eventOnFocusAutocomplete(this);" />
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <div class="col-md-12">
                                                        <label class="control-label" for="{!$Component.coord_complementAdresse}">Complément d'adresse</label><br />
                                                        <apex:inputtext styleclass="form-control input-sm" id="coord_complementAdresse" html-placeholder="Complément d'adresse" value="{!account.complementAdresse}" />
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <div class="col-md-12">
                                                        <label class="control-label" for="{!$Component.postal_code}">Code postal <span class="required-field">*</span></label>
                                                        <apex:inputtext styleclass="form-control input-sm" id="postal_code" value="{!account.codePostal}" onchange="eventOnChangeFieldValue(this);" html-pattern="[0-9]{5,5}" />
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <div class="col-md-12">
                                                        <label for="{!$Component.locality}" class="control-label">Ville <span class="required-field">*</span></label>
                                                        <div class="input-group">
                                                            <select id="locality_combobox" class="form-control input-sm"></select>
                                                            <div class="input-group-addon input-sm" id="locality_show-all"><span class="glyphicon glyphicon-chevron-down"></span></div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <apex:outputpanel layout="block" rendered="{!account.isPersonAccount}" styleclass="col-md-12">
                                                        <label class="control-label" for="{!$Component.coord_interphone}">Interphone</label><br />
                                                        <apex:inputtext styleclass="form-control input-sm" id="coord_interphone" html-placeholder="Interphone" value="{!account.interphone}" />
                                                    </apex:outputpanel>
                                                </div>
                                                <div class="form-group">
                                                    <apex:outputpanel layout="block" rendered="{!account.isPersonAccount}" styleclass="col-md-12">
                                                        <label class="control-label" for="{!$Component.coord_etage}">Étage</label><br />
                                                        <apex:input value="{!account.etage}" styleclass="form-control input-sm" id="coord_etage" html-placeholder="Étage" title="Étage" type="text" html-pattern="[0-9]{1,2}" />
                                                    </apex:outputpanel>
                                                </div>
                                                <div class="form-group hidden">
                                                    <div class="col-md-3">
                                                        <label class="control-label hidden" for="{!$Component.adresse_rue}">Rue</label><br />
                                                        <apex:inputtext styleclass="form-control input-sm hidden" id="adresse_rue" html-placeholder="Rue" required="true" value="{!account.rue}" />
                                                    </div>
                                                </div>
                                            </c:formblock>
                                        </div>
                                    </div>
                                </div>
                                <apex:outputpanel layout="none" rendered="{!account.isPersonAccount}">
                                    <div class=" col-md-7 col-sm-6 col-xs-12">
                                        <div class="panel panel-custom">
                                            <div class="panel-heading">
                                                <h5 class="panel-title">
                                                    INFORMATIONS DE JOIGNABILITÉ
                                                </h5>
                                            </div>
                                            <div class="panel-body">
                                                <c:formblock alignment="horizontal">
                                                    <div class="form-group">
                                                        <div class="col-md-4">
                                                            <label class="control-label visible-xs" for="{!$Component.email}">Adresse e-mail</label>
                                                            <label class="control-label hidden-xs" for="{!$Component.email}">E-mail</label><br />
                                                            <apex:input value="{!account.email}" styleclass="form-control input-sm" id="coord_email" html-placeholder="Adresse e-mail" title="Adresse e-mail" type="email" />
                                                        </div>
                                                        <div class="col-md-4">
                                                            <label class="control-label visible-xs" for="{!$Component.coord_telephoneDomicile}">Téléphone domicile</label>
                                                            <label class="control-label hidden-xs" for="{!$Component.coord_telephoneDomicile}">Tél. domicile</label><br />
                                                            <apex:input value="{!account.telephoneDomicile}" styleclass="form-control input-sm" id="coord_telephoneDomicile" html-placeholder="Téléphone domicile" title="Téléphone domicile" type="tel" html-pattern="[0-9]{10}" />
                                                        </div>
                                                        <div class="col-md-4">
                                                            <label class="control-label visible-xs" for="{!$Component.coord_telephoneMobile}">Téléphone portable</label>
                                                            <label class="control-label hidden-xs" for="{!$Component.coord_telephoneMobile}">Tél. portable</label><br />
                                                            <apex:input value="{!account.telephoneMobile}" styleclass="form-control input-sm" id="coord_telephoneMobile" html-placeholder="Téléphone portable" title="Téléphone portable" type="tel" html-pattern="[0-9]{10}" />
                                                        </div>
                                                    </div>
                                                    <div class="form-group">
                                                        <div class="col-md-4">
                                                            <label class="control-label visible-xs" for="{!$Component.coord_autreTelephone}">Téléphone bureau</label>
                                                            <label class="control-label hidden-xs" for="{!$Component.coord_autreTelephone}">Tél. bureau</label><br />
                                                            <apex:input value="{!account.autreTelephone}" styleclass="form-control input-sm" id="coord_autreTelephone" html-placeholder="Téléphone bureau" title="Téléphone bureau" type="tel" html-pattern="[0-9]{10}" />
                                                        </div>
                                                        <div class="col-md-4">
                                                            <label class="control-label" for="{!$Component.coord_fax}">Télécopie</label><br />
                                                            <apex:input value="{!account.Fax}" styleclass="form-control input-sm" id="coord_fax" html-placeholder="Télécopie" title="Télécopie" type="tel" html-pattern="[0-9]{10}" />
                                                        </div>
                                                        <div class="col-md-4">
                                                            <label class="control-label" for="{!$Component.coord_canalPrefere}">Préférence</label><br />
                                                            <apex:selectlist id="coord_canalPrefere" styleclass="form-control input-sm" value="{!account.canalPrefere}" multiselect="false" size="1">
                                                                <apex:selectoption itemvalue="" itemlabel="- Aucun -" />
                                                                <apex:selectoption itemvalue="Courrier" itemlabel="Courrier" />
                                                                <apex:selectoption itemvalue="Email" itemlabel="E-mail" />
                                                                <apex:selectoption itemvalue="FAX" itemlabel="FAX" />
                                                                <apex:selectoption itemvalue="SMS" itemlabel="SMS" />
                                                                <apex:selectoption itemvalue="Téléphone domicile" itemlabel="Téléphone domicile" />
                                                                <apex:selectoption itemvalue="Téléphone mobile" itemlabel="Téléphone mobile" />
                                                                <apex:selectoption itemvalue="Téléphone professionnel" itemlabel="Téléphone professionnel" />
                                                            </apex:selectlist>
                                                        </div>
                                                    </div>
                                                </c:formblock>
                                            </div>
                                        </div>
                                    </div>
                                </apex:outputpanel>
                                <apex:outputpanel layout="none" rendered="{!!account.isPersonAccount}">
                                    <div class=" col-md-7 col-sm-6 col-xs-12">
                                        <div class="panel panel-custom">
                                            <div class="panel-heading">
                                                <h5 class="panel-title">
                                                    INFORMATIONS DE JOIGNABILITÉ
                                                </h5>
                                            </div>
                                            <div class="panel-body">
                                                <c:formblock alignment="horizontal">
                                                    <c:formgroup rendered="{!account.contactParDefautId != null}">
                                                        <div class="col-md-4">
                                                            <label class="control-label visible-xs" for="{!$Component.coord_email}">Adresse e-mail</label>
                                                            <label class="control-label hidden-xs" for="{!$Component.coord_email}">E-mail</label><br />
                                                            <apex:input value="{!account.emailPro}" styleclass="form-control input-sm" id="coord_email" html-placeholder="Adresse e-mail" title="Adresse e-mail" type="email" />
                                                        </div>
                                                        <div class="col-md-4">
                                                            <label class="control-label" for="{!$Component.coord_phone}">Téléphone</label><br />
                                                            <apex:input value="{!account.Phone}" styleclass="form-control input-sm" id="coord_phone" html-placeholder="Téléphone" title="Téléphone" type="tel" html-pattern="[0-9]{10}" />
                                                        </div>
                                                        <div class="col-md-4">
                                                            <label class="control-label visible-xs" for="{!$Component.coord_telephoneMobile}">Téléphone portable</label>
                                                            <label class="control-label hidden-xs" for="{!$Component.coord_telephoneMobile}">Tél. portable</label><br />
                                                            <apex:input value="{!account.telephoneMobilePro}" styleclass="form-control input-sm" id="coord_telephoneMobile" html-placeholder="Téléphone portable" title="Téléphone portable" type="tel" html-pattern="[0-9]{10}" />
                                                        </div>
                                                    </c:formgroup>
                                                    <c:formgroup rendered="{!account.contactParDefautId != null}">
                                                        <div class="col-md-4 ">
                                                            <label class="control-label visible-xs" for="{!$Component.coord_autreTelephone}">Autre téléphone</label>
                                                            <label class="control-label hidden-xs" for="{!$Component.coord_autreTelephone}">Autre tél.</label><br />
                                                            <apex:input value="{!account.autreTelephonePro}" styleclass="form-control input-sm" id="coord_autreTelephone" html-placeholder="Téléphone domicile" title="Téléphone domicile" type="tel" html-pattern="[0-9]{10}" />
                                                        </div>
                                                        <div class="col-md-4">
                                                            <label class="control-label" for="{!$Component.coord_fax}">Télécopie</label><br />
                                                            <apex:input value="{!account.Fax}" styleclass="form-control input-sm" id="coord_fax" html-placeholder="Télécopie" title="Télécopie" type="tel" html-pattern="[0-9]{10}" />
                                                        </div>
                                                        <div class="col-md-4">
                                                            <label class="control-label" for="{!$Component.coord_canalPrefere}">Préférence</label><br />
                                                            <apex:selectlist id="coord_canalPrefere" styleclass="form-control input-sm" value="{!account.canalPrefere}" multiselect="false" size="1">
                                                                <apex:selectoption itemvalue="" itemlabel="- Aucun -" />
                                                                <apex:selectoption itemvalue="Courrier" itemlabel="Courrier" />
                                                                <apex:selectoption itemvalue="Email" itemlabel="E-mail" />
                                                                <apex:selectoption itemvalue="FAX" itemlabel="FAX" />
                                                                <apex:selectoption itemvalue="SMS" itemlabel="SMS" />
                                                                <apex:selectoption itemvalue="Téléphone domicile" itemlabel="Téléphone domicile" />
                                                                <apex:selectoption itemvalue="Téléphone mobile" itemlabel="Téléphone mobile" />
                                                                <apex:selectoption itemvalue="Téléphone professionnel" itemlabel="Téléphone professionnel" />
                                                            </apex:selectlist>
                                                        </div>
                                                    </c:formgroup>
                                                    <c:formgroup rendered="{!account.contactParDefautId == null}">
                                                        <div class="col-md-4">
                                                            <label class="control-label" for="{!$Component.coord_phone}">Téléphone</label><br />
                                                            <apex:input value="{!account.Phone}" styleclass="form-control input-sm" id="coord_phone" html-placeholder="Téléphone" title="Téléphone" type="tel" html-pattern="[0-9]{10}" />
                                                        </div>
                                                        <div class="col-md-4">
                                                            <label class="control-label" for="{!$Component.coord_fax}">Télécopie</label><br />
                                                            <apex:input value="{!account.Fax}" styleclass="form-control input-sm" id="coord_fax" html-placeholder="Télécopie" title="Télécopie" type="tel" html-pattern="[0-9]{10}" />
                                                        </div>
                                                        <div class="col-md-4">
                                                            <label class="control-label" for="{!$Component.coord_canalPrefere}">Préférence</label><br />
                                                            <apex:selectlist id="coord_canalPrefere" styleclass="form-control input-sm" value="{!account.canalPrefere}" multiselect="false" size="1">
                                                                <apex:selectoption itemvalue="" itemlabel="- Aucun -" />
                                                                <apex:selectoption itemvalue="Courrier" itemlabel="Courrier" />
                                                                <apex:selectoption itemvalue="Email" itemlabel="E-mail" />
                                                                <apex:selectoption itemvalue="FAX" itemlabel="FAX" />
                                                                <apex:selectoption itemvalue="SMS" itemlabel="SMS" />
                                                                <apex:selectoption itemvalue="Téléphone domicile" itemlabel="Téléphone domicile" />
                                                                <apex:selectoption itemvalue="Téléphone mobile" itemlabel="Téléphone mobile" />
                                                                <apex:selectoption itemvalue="Téléphone professionnel" itemlabel="Téléphone professionnel" />
                                                            </apex:selectlist>
                                                        </div>
                                                    </c:formgroup>
                                                </c:formblock>
                                            </div>
                                        </div>
                                    </div>
                                </apex:outputpanel>
                                <div class=" col-md-7 col-sm-6 col-xs-12">
                                    <apex:outputpanel layout="none" rendered="{!NOT(isClient)}">
                                        <div class="panel panel-custom">
                                            <div class="panel-heading">
                                                <h5 class="panel-title">
                                                    OPTIONS DE JOIGNABILITÉ
                                                </h5>
                                            </div>
                                            <div class="panel-body">
                                                <h5 class="text-red">Voici les différents canaux sur lesquelles vous nous autorisez à communiquer :</h5>
                                                <table class="table">
                                                    <thead>
                                                        <tr>
                                                            <td></td>
                                                            <td class="hidden-xs">E-mail</td>
                                                            <td class="hidden-lg hidden-md hidden-sm">Email</td>
                                                            <td class="hidden-xs">Domicile</td>
                                                            <td class="hidden-lg hidden-md hidden-sm"><abbr title="Domicile">Dom.</abbr></td>
                                                            <td class="hidden-xs">Mobile</td>
                                                            <td class="hidden-lg hidden-md hidden-sm"><abbr title="Mobile">Mob.</abbr></td>
                                                            <td>SMS</td>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr>
                                                            <td>K par K</td>
                                                            <td><apex:inputcheckbox id="coord_optinMailK" value="{!account.optinAdresseEmailKparK}"></apex:inputcheckbox></td>
                                                            <td><apex:inputcheckbox id="coord_optinTelephoneDomK" value="{!account.optinTelephoneDomicileKparK}"></apex:inputcheckbox></td>
                                                            <td><apex:inputcheckbox id="coord_optinTelephoneMobK" value="{!account.optinTelephoneMobileKparK}"></apex:inputcheckbox></td>
                                                            <td><apex:inputcheckbox id="coord_optinSMSK" value="{!account.optinSMSKparK}"></apex:inputcheckbox></td>
                                                        </tr>
                                                        <tr>
                                                            <td>Partenaires</td>
                                                            <td><apex:inputcheckbox id="coord_optinMailP" value="{!account.optinAdresseEmailPartenaire}"></apex:inputcheckbox></td>
                                                            <td><apex:inputcheckbox id="coord_optinTelephoneDomP" value="{!account.optinTelephoneDomicilePartenaire}"></apex:inputcheckbox></td>
                                                            <td><apex:inputcheckbox id="coord_optinTelephoneMobP" value="{!account.optinTelephoneMobilePartenaire}"></apex:inputcheckbox></td>
                                                            <td><apex:inputcheckbox id="coord_optinSMSP" value="{!account.optinSMSPartenaire}"></apex:inputcheckbox></td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </apex:outputpanel>
                                </div>
                                <apex:inputhidden id="administrative_area_level_1" />
                                <apex:inputhidden id="country" value="{!account.pays}" />
                                <apex:inputhidden id="adresse_latitude" value="{!account.LocalisationLatitude}" />
                                <apex:inputhidden id="adresse_longitude" value="{!account.LocalisationLongitude}" />
                                <apex:inputhidden id="ville" value="{!account.ville}" />
                                <apex:inputhidden id="alreadySaved" value="{!alreadySaved}" />
                                <input class="hidden" type="text" id="isAutocomplete" />
                                <div class="col-md-12 col-sm-12 col-xs-12 text-center" style="margin-bottom: 15px; margin-top: 20px;">
                                    <input type="button" onclick="callRemoteActionUpdateAccount();" id="modifcationCoordonnees" class="btn-lg btn-custom btn-custom-red" value="SAUVEGARDER LES MODIFICATIONS" data-loading-text="{!$Label.espaceclient_msg_Loading}" />
                                </div>
                            </apex:form>
                        </div><!-- /.col-md-10 col-lg-10 col-lg-offset-1 col-md-offset-1 -->
                    </div><!-- /.tabpanel : COORDONNEE -->
                    <!-- Onglet Mon mot de passe -->
                    <div role="tabpanel" class="tab-pane" id="motdepasse">
                        <div class="col-md-10 col-lg-10 col-lg-offset-1 col-md-offset-1">

                            <div id="motdepasse-message" class="col-md-12 col-sm-12 col-xs-12 hidden">
                                <div id="motdepasse-message_alert" class="alert">
                                </div>
                            </div>
                            <!--<div id="error">
                                <apex:repeat value="{!log.StaticMessages}" var="message" id="pageMessageRepeat">
                                    <div class="alert {!IF(message.SeverityStr=='confirm','alert-success',
                                                        IF(message.SeverityStr=='info','alert-info',
                                                            IF(message.SeverityStr=='warning','alert-warning','alert-danger')))}">
                                        <apex:outputtext escape="false" value="{!message.Message}" />
                                    </div>
                                </apex:repeat>
                            </div>-->
                            <!-- /.error -->
                            <apex:form id="motdepasse-formulaire">
                                <div class=" col-md-7 col-sm-6 col-xs-12">
                                    <div class="panel panel-custom">
                                        <div class="panel-heading">
                                            <h5 class="panel-title">
                                                CHANGEMENT DE MOT DE PASSE
                                            </h5>
                                        </div>
                                        <div class="panel-body">
                                            <div class="form-group">
                                                <div class="row state-row">
                                                    <div class="col-lg-12 col-md-12">
                                                        <apex:outputtext value="{!messagePasswordRequirement}" />
                                                    </div>
                                                </div>
                                                <div class="row state-row">
                                                    <div class="col-lg-12 col-md-12">
                                                        <label class="control-label" for="{!$Component.motdepasse_ancienMDP}">Mon ancien mot de passe <span class="required-field">*</span></label><br />
                                                        <apex:inputsecret id="motdepasse_ancienMDP" styleclass="form-control input-sm" html-placeholder="Ancien mot de passe" title="Ancien mot de passe" html-autocorrect="off" />
                                                    </div>
                                                </div>
                                                <div class="row state-row">
                                                    <div class="col-lg-12 col-md-12">
                                                        <label class="control-label" for="{!$Component.motdepasse_nouveauMDP}">Mon nouveau mot de passe <span class="required-field">*</span></label><br />
                                                        <apex:inputsecret id="motdepasse_nouveauMDP" styleclass="form-control input-sm" html-placeholder="Nouveau mot de passe" title="Nouveau mot de passe" html-autocorrect="off" />
                                                    </div>
                                                </div>
                                                <div class="row state-row">
                                                    <div class="col-lg-12 col-md-12">
                                                        <label class="control-label" for="{!$Component.motdepasse_confirmNouveauMDP}">Confirmer le nouveau mot de passe <span class="required-field">*</span></label><br />
                                                        <apex:inputsecret id="motdepasse_confirmNouveauMDP" styleclass="form-control input-sm" html-placeholder="Confirmer le nouveau mot de passe" title="Confirmer le nouveau mot de passe" html-autocorrect="off" />
                                                    </div>
                                                </div>
                                            </div><br />
                                            <div class="col-md-12 col-sm-12 col-xs-12">
                                                <div class="pull-right">
                                                    <input type="button" onclick="changePassword(this);" id="modificationPassword" class="btn-lg btn-custom btn-custom-red" value="SAUVEGARDER LES MODIFICATIONS" data-loading-text="{!$Label.espaceclient_msg_Loading}" />
                                                    <!--<input type="button" onclick="changementMDP(); return false;" id="modificationPassword" class="btn-lg btn-custom btn-custom-red" value="SAUVEGARDER LES MODIFICATIONS" data-loading-text="{!$Label.espaceclient_msg_Loading}" /> -->
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div> 
                            </apex:form>
                        </div><!-- /.col-md-10 col-lg-10 col-lg-offset-1 col-md-offset-1 -->
                    </div><!-- /.tabpanel : MON MOT DE PASSE -->
                    <!-- Onglet Projets -->
                    <div role="tabpanel" class="tab-pane" id="projets">
                        <div class="projects">
                            <div class="col-xs-12 col-md-10 col-md-offset-1">
                                <apex:outputpanel layout="block" styleclass="well" rendered="{!contratsClient.size = 0}">
                                    {!$Label.espaceclient_text_ProjectNoTotal}
                                </apex:outputpanel>
                                <apex:repeat value="{!contratsClient}" var="projet" id="projet" rendered="{!contratsClient.size > 0}">
                                    <div class="panel panel-custom-red project-list project-list{!projet.Id}">
                                        <div class="panel-heading">
                                            <div class="row">
                                                <h3 class="panel-title pull-left" style="margin-top: 20px;">
                                                    <a role="button" data-toggle="collapse" href="#project_Panel{!projet.Id}" aria-expanded="false" aria-controls="project_Panel{!projet.Id}">
                                                        Projet {!projet.nomContrat} (Contrat N° {!projet.numeroContrat})
                                                    </a>
                                                </h3>
                                                <div class=" pull-right">
                                                    <a class="btn-custom btn-custom-ctr" data-toggle="modal" data-target="#contrat_modal{!projet.Id}">VOIR LE DEVIS</a>
                                                    <div class="btn-custom-collapse pull-right">
                                                        <a id="project_Button{!projet.Id}" class="project-button collapsed" role="button" data-toggle="collapse" href="#project_Panel{!projet.Id}" aria-expanded="false" aria-controls="project_Panel{!projet.Id}">
                                                            <span class="fa icon-collapse text-center"></span>
                                                        </a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="panel-collapse collapse" id="project_Panel{!projet.Id}" data-toggle="false" role="tabpanel">
                                            <div class="panel-body">
                                                <div class="text-center hidden-xs">
                                                    <label class="title-project">Avancement du projet</label>
                                                </div>
                                                <div class="row">
                                                    <div class="col-xs-12 col-md-10 col-md-offset-1">
                                                        <input type="text" id="{!projet.Id}" class="projectProgressBar{!projet.Id}" name="projectProgressBar" value="{!projet.etapeActuelle}" />
                                                    </div>
                                                </div>
                                                <div class="row state-row {!projet.panelsType[0]}" style="margin-top: 40px;">
                                                    <div class="col-xs-12 panel-state">
                                                        <div class="col-xs-12 col-md-2 panel-state-icon">
                                                            <div class="panel-body">
                                                                <div class="center-block text-center project-icon-state">
                                                                    <apex:image value="{!URLFOR($Resource.Site_Espace_Client, 'img/contrat_white.png')}" alt="Icone contrat" html-aria-hidden="true"
                                                                                rendered="{!IF(projet.panelsType[0] != 'panel-state-default', true, false)}" />
                                                                    <apex:image value="{!URLFOR($Resource.Site_Espace_Client, 'img/contrat_grey.png')}" alt="Icone contrat" html-aria-hidden="true"
                                                                                rendered="{!IF(projet.panelsType[0] == 'panel-state-default', true, false)}" />
                                                                    <p class="project-icon-state-label">Signature du contrat</p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-xs-12 col-md-10">
                                                            <div class="panel-body">
                                                                <div class="col-xs-12 col-sm-4 col-md-4">
                                                                    <p class="text-justify">Merci de nous avoir fait confiance. Retrouvez ici les informations essentielles de votre contrat !</p>
                                                                </div>
                                                                <div class="col-xs-12 col-sm-8 col-md-8">
                                                                    <div class="row">
                                                                        <div class="col-xs-12 col-md-3">
                                                                            <label class="text-grey" for="{!$Component.projet_DateSign}">DATE DE SIGNATURE</label>
                                                                        </div>
                                                                        <div class="col-xs-12 col-md-3">
                                                                            <apex:outputtext value="{0, date, dd/MM/yyyy}" id="projet_DateSign">
                                                                                <apex:param value="{!projet.dateDeSignature}" />
                                                                            </apex:outputtext>
                                                                        </div>
                                                                        <div class="col-xs-12 col-md-3">
                                                                            <label class="text-grey" for="{!$Component.projet_TotalTTC}">TOTAL TTC DU DEVIS</label>
                                                                        </div>
                                                                        <div class="col-xs-12 col-md-3">
                                                                            <apex:outputText value="{!projet.montantDevisTTC} €"> </apex:outputText>
                                                                        </div>
                                                                    </div>
                                                                    <div class="row">
                                                                        <div class="col-xs-12 col-md-3">
                                                                            <label class="text-grey" for="{!$Component.projet_NomVendeur}">NOM DU CONSEILLER</label>
                                                                        </div>
                                                                        <div class="col-xs-12 col-md-3">
                                                                            <apex:outputtext value="{!projet.nomVendeur}" id="projet_NomVendeur" />
                                                                        </div>
                                                                        <div class="col-xs-12 col-md-3">
                                                                            <label class="text-grey" for="{!$Component.projet_ModeFinancement}">MODE DE FINANCEMENT</label>
                                                                        </div>
                                                                        <div class="col-xs-12 col-md-3">
                                                                            <apex:outputtext value="{!projet.modeDeFinancement}" id="projet_ModeFinancement" />
                                                                        </div>
                                                                    </div>
                                                                    <div class="row">
                                                                        <div class="col-xs-12 col-md-3">
                                                                            <label class="text-grey" for="{!$Component.projet_Etat}">ÉTAT DU DEVIS</label>
                                                                        </div>
                                                                        <div class="col-xs-12 col-md-3">
                                                                            <apex:outputtext value="{!projet.statutDevis}" id="projet_Etat" />
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row state-row {!projet.panelsType[1]}">
                                                    <div class="col-xs-12 panel-state">
                                                        <div class="col-xs-12 col-md-2 panel-state-icon">
                                                            <div class="panel-body">
                                                                <div class="center-block text-center project-icon-state">
                                                                    <apex:image value="{!URLFOR($Resource.Site_Espace_Client, 'img/metrage_white.png')}" alt="Icone métrage" html-aria-hidden="true"
                                                                                rendered="{!IF(projet.panelsType[1] != 'panel-state-default', true, false)}" />
                                                                    <apex:image value="{!URLFOR($Resource.Site_Espace_Client, 'img/metrage_grey.png')}" alt="Icone métrage" html-aria-hidden="true"
                                                                                rendered="{!IF(projet.panelsType[1] == 'panel-state-default', true, false)}" />
                                                                    <p class="project-icon-state-label">Métrage</p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-xs-12 col-md-10">
                                                            <div class="panel-body">
                                                                <div class="col-xs-12 col-sm-4 col-md-4">
                                                                    <p class="text-justify">Pendant le métrage, le métreur prend les cotes de vos menuiseries, optimise les choix techniques et prépare la mise en commande.</p>
                                                                </div>
                                                                <div class="col-xs-12 col-sm-8 col-md-8">
                                                                    <div class="row">
                                                                        <apex:outputpanel rendered="{!NOT(ISNULL(projet.dateDernierMetrage))}" layout="none">
                                                                            <div class="col-xs-12 col-md-3">
                                                                                <label class="text-grey" for="{!$Component.projet_DateDernierMetrage}">DERNIER MÉTRAGE</label>
                                                                            </div>
                                                                            <div class="col-xs-12 col-md-3">
                                                                                <apex:outputtext value="{0, date, dd/MM/yyyy}" id="projet_DateDernierMetrage">
                                                                                    <apex:param value="{!projet.dateDernierMetrage}" />
                                                                                </apex:outputtext>
                                                                            </div>
                                                                        </apex:outputpanel>
                                                                        <apex:outputpanel rendered="{!NOT(ISNULL(projet.intervDernierMetrage))}" layout="none">
                                                                            <div class="col-xs-12 col-md-3">
                                                                                <label class="text-grey" for="{!$Component.projet_IntervenantMetrage}">DERNIER INTERVENANT</label>
                                                                            </div>
                                                                            <div class="col-xs-12 col-md-3">
                                                                                <apex:outputtext value="{!projet.intervDernierMetrage}" id="projet_IntervenantMetrage" />
                                                                            </div>
                                                                        </apex:outputpanel>
                                                                    </div>
                                                                    <div class="row">
                                                                        <apex:outputpanel rendered="{!NOT(ISNULL(projet.nombreMetrages))}" layout="none">
                                                                            <div class="col-xs-12 col-md-3">
                                                                                <label class="text-grey" for="{!$Component.projet_NbMetrage}">NOMBRE DE MÉTRAGES</label>
                                                                            </div>
                                                                            <div class="col-xs-12 col-md-3">
                                                                                <apex:outputtext value="{!projet.nombreMetrages}" id="projet_NbMetrage" />
                                                                            </div>
                                                                        </apex:outputpanel>
                                                                        <apex:outputpanel rendered="{!NOT(ISNULL(projet.dateProchainMetrage))}" layout="none">
                                                                            <div class="col-xs-12 col-md-3">
                                                                                <label class="text-grey" for="{!$Component.projet_DateProchainMetrage}">PROCHAIN MÉTRAGE</label>
                                                                            </div>
                                                                            <div class="col-xs-12 col-md-3">
                                                                                <apex:outputtext value="{0, date, dd/MM/yyyy}" id="projet_DateProchainMetrage">
                                                                                    <apex:param value="{!projet.dateProchainMetrage}" />
                                                                                </apex:outputtext>
                                                                            </div>
                                                                        </apex:outputpanel>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row state-row {!projet.panelsType[2]}">
                                                    <div class="col-xs-12 panel-state">
                                                        <div class="col-xs-12 col-md-2 panel-state-icon">
                                                            <div class="panel-body">
                                                                <div class="center-block text-center project-icon-state">
                                                                    <apex:image value="{!URLFOR($Resource.Site_Espace_Client, 'img/usine_white.png')}" alt="Icone usine" html-aria-hidden="true"
                                                                                rendered="{!IF(projet.panelsType[2] != 'panel-state-default', true, false)}" />
                                                                    <apex:image value="{!URLFOR($Resource.Site_Espace_Client, 'img/usine_grey.png')}" alt="Icone usine" html-aria-hidden="true"
                                                                                rendered="{!IF(projet.panelsType[2] == 'panel-state-default', true, false)}" />
                                                                    <p class="project-icon-state-label">Commande usine</p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-xs-12 col-md-10">
                                                            <div class="panel-body">
                                                                <div class="col-xs-12 col-sm-4 col-md-4">
                                                                    <p class="text-justify">Vos menuiseries sont en cours de fabrication.</p>
                                                                </div>
                                                                <div class="col-xs-12 col-sm-8 col-md-8">
                                                                    <div class="row">
                                                                        <div class="col-xs-12 col-md-3">
                                                                            <label class="text-grey" for="{!$Component.projet_NomDepotUsine}">CENTRE TECHNIQUE</label>
                                                                        </div>
                                                                        <div class="col-xs-12 col-md-9">
                                                                            <apex:outputtext value="{!projet.nomDepot}" id="projet_NomDepotUsine" />
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row state-row {!projet.panelsType[3]}">
                                                    <div class="col-xs-12 panel-state">
                                                        <div class="col-xs-12 col-md-2 panel-state-icon">
                                                            <div class="panel-body">
                                                                <div class="center-block text-center project-icon-state">
                                                                    <apex:image value="{!URLFOR($Resource.Site_Espace_Client, 'img/depot_white.png')}" alt="Icone depot" html-aria-hidden="true"
                                                                                rendered="{!IF(projet.panelsType[3] != 'panel-state-default', true, false)}" />
                                                                    <apex:image value="{!URLFOR($Resource.Site_Espace_Client, 'img/depot_grey.png')}" alt="Icone depot" html-aria-hidden="true"
                                                                                rendered="{!IF(projet.panelsType[3] == 'panel-state-default', true, false)}" />
                                                                    <p class="project-icon-state-label">Livraison</p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-xs-12 col-md-10">
                                                            <div class="panel-body">
                                                                <div class="col-xs-12 col-sm-4 col-md-4">
                                                                    <p class="text-justify">Nous avons réceptionné vos menuiseries sur notre centre technique et nous allons bientôt vous contacter pour planifier un rendez-vous d'installation.</p>
                                                                </div>
                                                                <div class="col-xs-12 col-sm-8 col-md-8">
                                                                    <div class="row">
                                                                        <div class="col-xs-12 col-md-3">
                                                                            <label class="text-grey" for="{!$Component.projet_NomDepot}">CENTRE TECHNIQUE</label>
                                                                        </div>
                                                                        <div class="col-xs-12 col-md-9">
                                                                            <apex:outputtext value="{!projet.nomDepot}" id="projet_NomDepot" />
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row state-row {!projet.panelsType[4]}">
                                                    <div class="col-xs-12 panel-state">
                                                        <div class="col-xs-12 col-md-2 panel-state-icon">
                                                            <div class="panel-body">
                                                                <div class="center-block text-center project-icon-state">
                                                                    <apex:image value="{!URLFOR($Resource.Site_Espace_Client, 'img/installation_white.png')}" alt="Icone installation" html-aria-hidden="true"
                                                                                rendered="{!IF(projet.panelsType[4] != 'panel-state-default', true, false)}" />
                                                                    <apex:image value="{!URLFOR($Resource.Site_Espace_Client, 'img/installation_grey.png')}" alt="Icone installation" html-aria-hidden="true"
                                                                                rendered="{!IF(projet.panelsType[4] == 'panel-state-default', true, false)}" />
                                                                    <p class="project-icon-state-label">Installation</p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-xs-12 col-md-10">
                                                            <div class="panel-body">
                                                                <div class="col-xs-12 col-sm-4 col-md-4">
                                                                    <p class="text-justify">Une équipe de pose vient installer vos menuiseries en prenant soin de protéger votre intérieur.</p>
                                                                </div>
                                                                <div class="col-xs-12 col-sm-8 col-md-8">
                                                                    <div class="row">
                                                                        <apex:outputpanel rendered="{!NOT(ISNULL(projet.dateDernierInstallation))}" layout="none">
                                                                            <div class="col-xs-12 col-md-3">
                                                                                <label class="text-grey" for="{!$Component.projet_DateDerniereInstallation}">DERNIÈRE POSE</label>
                                                                            </div>
                                                                            <div class="col-xs-12 col-md-9">
                                                                                <apex:outputtext value="{0, date, dd/MM/yyyy}" id="projet_DateDerniereInstallation">
                                                                                    <apex:param value="{!projet.dateDernierInstallation}" />
                                                                                </apex:outputtext>
                                                                            </div>
                                                                        </apex:outputpanel>
                                                                    </div>
                                                                    <div class="row">
                                                                        <apex:outputpanel rendered="{!NOT(ISNULL(projet.nombreInstallations))}" layout="none">
                                                                            <div class="col-xs-12 col-md-3">
                                                                                <label class="text-grey" for="{!$Component.projet_NbInstallation}">NOMBRE DE POSES</label>
                                                                            </div>
                                                                            <div class="col-xs-12 col-md-3">
                                                                                <apex:outputtext value="{!projet.nombreInstallations}" id="projet_NbInstallation" />
                                                                            </div>
                                                                        </apex:outputpanel>
                                                                        <apex:outputpanel rendered="{!NOT(ISNULL(projet.dateProchainInstallation))}" layout="none">
                                                                            <div class="col-xs-12 col-md-3">
                                                                                <label class="text-grey" for="{!$Component.projet_DateProchaineInstallation}">PROCHAINE POSE</label>
                                                                            </div>
                                                                            <div class="col-xs-12 col-md-3">
                                                                                <apex:outputtext value="{0, date, dd/MM/yyyy}" id="projet_DateProchaineInstallation">
                                                                                    <apex:param value="{!projet.dateProchainInstallation}" />
                                                                                </apex:outputtext>
                                                                            </div>
                                                                        </apex:outputpanel>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <apex:outputpanel rendered="{!IF(projet.etapeActuelle == 'Service après vente', true, false)}" layout="none">
                                                    <div class="row state-row {!projet.panelsType[5]}">
                                                        <div class="col-xs-12 panel-state">
                                                            <div class="col-xs-12 col-md-2 panel-state-icon">
                                                                <div class="panel-body">
                                                                    <div class="center-block text-center project-icon-state">
                                                                        <apex:image value="{!URLFOR($Resource.Site_Espace_Client, 'img/sav_white.png')}" alt="Icone sav" html-aria-hidden="true"
                                                                                    rendered="{!IF(projet.panelsType[5] != 'panel-state-default', true, false)}" />
                                                                        <apex:image value="{!URLFOR($Resource.Site_Espace_Client, 'img/sav_grey.png')}" alt="Icone sav" html-aria-hidden="true"
                                                                                    rendered="{!IF(projet.panelsType[5] == 'panel-state-default', true, false)}" />
                                                                        <p class="project-icon-state-label">Service après vente</p>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-xs-12 col-md-10">
                                                                <div class="panel-body">
                                                                    <div class="col-xs-12 col-sm-4 col-md-4">
                                                                        <p class="text-justify">Vous avez signalé un dysfonctionnement, et nous faisons notre maximum pour y apporter une solution.</p>
                                                                    </div>
                                                                    <div class="col-xs-12 col-sm-8 col-md-8">
                                                                        <div class="row">
                                                                            <apex:outputpanel rendered="{!NOT(ISNULL(projet.dateDebutDernierSAV))}" layout="none">
                                                                                <div class="col-xs-12 col-md-3">
                                                                                    <label class="text-grey" for="{!$Component.projet_DateOuvertureSAV}">DATE OUVERTURE DU S.A.V.</label>
                                                                                </div>
                                                                                <div class="col-xs-12 col-md-3">
                                                                                    <apex:outputtext value="{0, date, dd/MM/yyyy}" id="projet_DateOuvertureSAV">
                                                                                        <apex:param value="{!projet.dateDebutDernierSAV}" />
                                                                                    </apex:outputtext>
                                                                                </div>
                                                                            </apex:outputpanel>
                                                                            <apex:outputpanel rendered="{!NOT(ISNULL(projet.nbSAVTotal))}" layout="none">
                                                                                <div class="col-xs-12 col-md-3">
                                                                                    <label class="text-grey" for="{!$Component.projet_nbTotalSAV}">N° DU DERNIER S.A.V.</label>
                                                                                </div>
                                                                                <div class="col-xs-12 col-md-3">
                                                                                    <apex:outputtext value="{!projet.nbSAVTotal}" id="projet_nbTotalSAV" />
                                                                                </div>
                                                                            </apex:outputpanel>
                                                                        </div>
                                                                        <div class="row">
                                                                            <apex:outputpanel rendered="{!NOT(ISNULL(projet.dateDerniereInterventionSAV))}" layout="none">
                                                                                <div class="col-xs-12 col-md-3">
                                                                                    <label class="text-grey" for="{!$Component.projet_DateDerniereSAV}">DERNIÈRE INTERVENTION S.A.V.</label>
                                                                                </div>
                                                                                <div class="col-xs-12 col-md-3">
                                                                                    <apex:outputtext value="{0, date, dd/MM/yyyy}" id="projet_DateDerniereSAV">
                                                                                        <apex:param value="{!projet.dateDerniereInterventionSAV}" />
                                                                                    </apex:outputtext>
                                                                                </div>
                                                                            </apex:outputpanel>
                                                                            <apex:outputpanel rendered="{!NOT(ISNULL(projet.intervDerniereInterventionSAV))}" layout="none">
                                                                                <div class="col-xs-12 col-md-3">
                                                                                    <label class="text-grey" for="{!$Component.projet_DernierInternvenantSAV}">DERNIER INTERVENANT</label>
                                                                                </div>
                                                                                <div class="col-xs-12 col-md-3">
                                                                                    <apex:outputtext value="{!projet.intervDerniereInterventionSAV}" id="projet_DernierInternvenantSAV" />
                                                                                </div>
                                                                            </apex:outputpanel>
                                                                        </div>
                                                                        <div class="row">
                                                                            <apex:outputpanel rendered="{!NOT(ISNULL(projet.nombreInterventionsSAV))}" layout="none">
                                                                                <div class="col-xs-12 col-md-3">
                                                                                    <label class="text-grey" for="{!$Component.projet_NbInterventionsSAV}">NOMBRE D'INTERVENTIONS S.A.V.</label>
                                                                                </div>
                                                                                <div class="col-xs-12 col-md-3">
                                                                                    <apex:outputtext value="{!projet.nombreInterventionsSAV}" id="projet_NbInterventionsSAV" />
                                                                                </div>
                                                                            </apex:outputpanel>
                                                                            <apex:outputpanel rendered="{!NOT(ISNULL(projet.dateProchainSAV))}" layout="none">
                                                                                <div class="col-xs-12 col-md-3">
                                                                                    <label class="text-grey" for="{!$Component.projet_DateProchainSAV}">PROCHAINE INTERVENTION S.A.V</label>
                                                                                </div>
                                                                                <div class="col-xs-12 col-md-3">
                                                                                    <apex:outputtext value="{0, date, dd/MM/yyyy}" id="projet_DateProchainSAV">
                                                                                        <apex:param value="{!projet.dateProchainSAV}" />
                                                                                    </apex:outputtext>
                                                                                </div>
                                                                            </apex:outputpanel>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </apex:outputpanel>
                                            </div>
                                        </div>
                                    </div>
                                </apex:repeat>
                            </div><!-- /.col-md-10 col-lg-10 col-lg-offset-1 col-md-offset-1 -->
                        </div><!-- /.project -->
                    </div><!-- /.tabpanel : MES PROJETS -->
                    <!-- Onglet Parrainage -->
                    <div role="tabpanel" class="tab-pane" id="parrainage">
                        <apex:form id="parrainage-formulaire">
                            <div class="parrainages">
                                <div class="col-xs-12 col-md-10 col-md-offset-1">
                                    <div id="parrainage-row-1" class="row">
                                        <div class="panel panel-custom col-xs-12 col-sm-6 col-md-7 column">
                                            <div class="panel-heading">
                                                <h5 class="panel-title">
                                                    <span class="text-uppercase">Offre de parrainage</span>
                                                </h5>
                                            </div>
                                            <div class="panel-body">
                                                <div class="col-md-6 col-sm-6" style="padding-left:5px;padding-right:5px">
                                                    <div class="">
                                                        <div class="row" style="margin-bottom: 10px">
                                                            <div class="col-md-6 col-sm-6">
                                                                <strong>POUR LE PARRAIN</strong>
                                                            </div>
                                                            <div class="col-md-6 col-sm-6">
                                                                <div class="text-red text-big">100 <sup class="exp">€*</sup></div>
                                                                <div class="text-grey"><small class="text-smaller">* voir conditions d'éligibilité</small></div>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <p class="text-justify">
                                                                L'offre de parrainage vous permet de cumuler des bons d'achat d'une valeur de 100 € par parrainage. Ajoutez en quelques clics les coordonnées de vos futurs filleuls.
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6 col-sm-6">
                                                    <div class="">
                                                        <div class="row" style="margin-bottom: 10px">
                                                            <div class="col-md-6 col-sm-6">
                                                                <strong>POUR LE FILLEUL</strong>
                                                            </div>
                                                            <div class="col-md-6 col-sm-6">
                                                                <div class="text-red text-big">150 <sup class="exp">€*</sup></div>
                                                                <div class="text-grey"><small class="text-smaller">* voir conditions d'éligibilité</small></div>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <p class="text-justify">
                                                                L'offre de parrainage permet à votre filleul d'obtenir une remise jusqu’à 150 €.
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div id="parrainage-dashboard-container" class="col-xs-12 col-sm-6 col-md-5 column">
                                            <apex:outputpanel layout="block" id="parrainage-dashboard">
                                                <apex:inputhidden value="{!filleuls}" />
                                                <div class="panel panel-custom">
                                                    <div class="panel-heading">
                                                        <h5 class="panel-title">
                                                            <span class="text-uppercase">Tableau de bord</span>
                                                        </h5>
                                                    </div>
                                                    <div class="panel-body">
                                                        <div class="row row-parrainage">
                                                            <div class="col-md-12">
                                                                <span>Date de la dernière connexion : </span>
                                                                <span class="text-red">
                                                                    <apex:outputtext value="{0, date, dd/MM/yyyy}">
                                                                        <apex:param value="{!account.dateConnexion}" />
                                                                    </apex:outputtext>
                                                                </span>
                                                            </div>
                                                        </div>
                                                        <div class="row row-parrainage">
                                                            <div class="col-md-6 col-sm-6 col-xs-9">
                                                                <span>Nombre de filleuls parrainés : </span>
                                                                <span class="text-red"><apex:outputtext value="{!filleuls.size}" id="parrainage-dashboard-numberFilleul" /></span>
                                                            </div>
                                                            <div class="col-md-4 col-sm-4 col-xs-3 pull-right">
                                                                <span class="pull-right">
                                                                    <a class="text-red" href="#" data-toggle="modal" data-target="#parrainage_modalFilleuls">détails</a>
                                                                </span>
                                                            </div>
                                                        </div>
                                                        <div class="row row-parrainage">
                                                            <div class="col-md-8 col-sm-8 col-xs-10">
                                                                <span>Nombre de filleuls devenus clients : </span>
                                                                <span class="text-red"><apex:outputtext value="{!filleulsClient.size}" /></span>
                                                            </div>
                                                            <div class="col-md-4 col-sm-4 col-xs-2 pull-right">
                                                                <span class="pull-right">
                                                                    <a class="text-red" href="#" data-toggle="modal" data-target="#parrainage_modalFilleulsClient">détails</a>
                                                                </span>
                                                            </div>
                                                        </div>
                                                        <div class="row row-parrainage">
                                                            <div class="col-md-6 col-sm-6 col-xs-9">
                                                                <span>Montant cumulés : </span>
                                                                <span class="text-red"><apex:outputtext value="{!filleulsClient.size*100} €" /></span>
                                                            </div>
                                                            <div class="col-md-4 col-sm-4 col-xs-3 pull-right">
                                                                <span class="pull-right">
                                                                    <a class="text-red" href="#" data-toggle="modal" data-target="#parrainage_modalMontant">détails</a>
                                                                </span>
                                                            </div>
                                                        </div>
                                                        <apex:outputpanel layout="none" rendered="{!activeParrainage}">
                                                            <div class="col-md-12 col-sm-12 col-xs-12">
                                                                <div class="pull-right">
                                                                    <input type="button" id="showAjoutFilleul" class="btn-lg btn-custom btn-custom-red" value="AJOUTER UN FILLEUL" data-toggle="modal" data-target="#parrainage_modalAdd" />
                                                                </div>
                                                            </div>
                                                        </apex:outputpanel>
                                                    </div>
                                                </div>
                                            </apex:outputpanel>
                                        </div>
                                    </div><!-- /.row -->
                                    <div class="row">
                                        <div class="panel panel-custom-noborder col-xs-12 col-sm-6 col-md-7">
                                            <div class="panel-heading">
                                                <h5 class="panel-title">
                                                    <span class="text-uppercase">L'offre en détail</span>
                                                </h5>
                                            </div>
                                            <div class="panel-body">
                                                <div class="panel panel-custom-header">
                                                    <div class="panel-heading">
                                                        <div class="panel-title-icon">
                                                            <a class="collapsed" role="button" data-toggle="collapse" href="#parrainage_panel-comment" aria-expanded="false" aria-controls="parrainage_panel-comment">
                                                                <span id="parrainage_icon-comment" class="fa fa-chevron-right parrainage-icon-collapse" aria-hidden="true"></span>
                                                            </a>
                                                        </div>
                                                        <div style="display: inline-block;">
                                                            <a role="button" data-toggle="collapse" href="#parrainage_panel-comment" aria-expanded="false" aria-controls="parrainage_panel-comment">
                                                                <h3 class="panel-title">Comment profiter de l'offre</h3>
                                                            </a>
                                                        </div>
                                                    </div>
                                                    <div class="panel-body collapse" id="parrainage_panel-comment">
                                                        <div>
                                                            <p class="text-justify">
                                                                Le parrain est invité à donner les coordonnées de son/ses filleul(s) grâce au formulaire "Ajouter un filleul" :
                                                                <ul>
                                                                    <li>nom, prénom, code postal</li>
                                                                    <li>
                                                                        un moyen pour contacter le filleul : adresse électronique (e-mail), numéro de téléphone
                                                                        fixe et/ou mobile, adresse postale.
                                                                    </li>
                                                                </ul>
                                                                En inscrivant un filleul, le parrain déclare s'être assuré que ce filleul accepte que ses
                                                                coordonnées soient transmises à la société K par K.<br />
                                                                Le parrain s'engage à ne proposer comme filleul que des personnes de son entourage ou
                                                                relations qui souhaitent recevoir des informations concernant des projets de menuiseries
                                                                (fenêtres, portes, volets, portails, portes de garage, clôtures, stores bannes, moustiquaires,
                                                                stores).
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div><!-- /.panel -->
                                                <div class="panel panel-custom-header">
                                                    <div class="panel-heading">
                                                        <div class="panel-title-icon">
                                                            <a class="collapsed" role="button" data-toggle="collapse" href="#parrainage_panel-avParrain" aria-expanded="false" aria-controls="parrainage_panel-avParrain">
                                                                <span id="parrainage_icon-avParrain" class="fa fa-chevron-right parrainage-icon-collapse" aria-hidden="true"></span>
                                                            </a>
                                                        </div>
                                                        <div style="display: inline-block;">
                                                            <a role="button" data-toggle="collapse" href="#parrainage_panel-avParrain" aria-expanded="false" aria-controls="parrainage_panel-avParrain">
                                                                <h3 class="panel-title">Les avantages pour le parrain</h3>
                                                            </a>
                                                        </div>
                                                    </div>
                                                    <div class="panel-body collapse" id="parrainage_panel-avParrain">
                                                        <div>
                                                            <p class="text-justify">
                                                                Chaque filleul devenu client, donne accès au parrain à un bon d'achat d'une valeur de 150 euros, prévu sous différentes formes : chèque cadeaux papier, carte cadeau ou bien chèque cadeaux électronique. <br />
                                                                Ces bons d’achats Kadeos sont nominatifs, incessibles, et valables pour une durée limitée.<br />
                                                                Ce bon d'achat est valide dans les conditions définies par la société EDENRED sur le site
                                                                <a href="http://www.kadeos.fr" target="_blank">www.kadeos.fr</a>.<br />
                                                                K par K se réserve le droit de changer à tout moment de partenaire.
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div><!-- /.panel -->
                                                <div class="panel panel-custom-header">
                                                    <div class="panel-heading">
                                                        <div class="panel-title-icon">
                                                            <a class="collapsed" role="button" data-toggle="collapse" href="#parrainage_panel-avFilleul" aria-expanded="false" aria-controls="parrainage_panel-avFilleul">
                                                                <span id="parrainage_icon-avFilleul" class="fa fa-chevron-right parrainage-icon-collapse" aria-hidden="true"></span>
                                                            </a>
                                                        </div>
                                                        <div style="display: inline-block;">
                                                            <a role="button" data-toggle="collapse" href="#parrainage_panel-avFilleul" aria-expanded="false" aria-controls="parrainage_panel-avFilleul">
                                                                <h3 class="panel-title">Les avantages pour le filleul</h3>
                                                            </a>
                                                        </div>
                                                    </div>
                                                    <div class="panel-body collapse" id="parrainage_panel-avFilleul">
                                                        <div>
                                                            <p class="text-justify">
                                                                L'avantage offert aux filleuls est constitué d'une remise sur leur premier achat chez K par K
                                                                selon la grille ci-dessous :
                                                                <ul>
                                                                    <li>
                                                                        Une remise de 50 euros pour un achat chez K par K dont le chiffre d'affaires TTC est
                                                                        compris entre 1.600 euros TTC et 3.700 euros TTC.
                                                                    </li>
                                                                    <li>
                                                                        Une remise de 100 euros pour un achat chez K par K dont le chiffre d'affaires TTC est
                                                                        compris entre 3.701 euros TTC et 5.800 euros TTC.
                                                                    </li>
                                                                    <li>
                                                                        Une remise de 150 euros pour un achat chez K par K dont le chiffre d'affaires TTC est
                                                                        supérieur à 5.800 euros TTC.
                                                                    </li>
                                                                </ul>
                                                                Cette remise est valable en une seule fois sur tous les produits K par K, et n'est pas cumulable
                                                                avec les promotions en cours.<br />
                                                                Pour qu'un filleul soit éligible à cette remise, il est nécessaire :
                                                                <ul>
                                                                    <li>
                                                                        que le filleul ne se soit pas rétracté dans les délais légaux de sa commande et que la
                                                                        commande passée par le filleul ait été exécutée jusqu'à son terme, c'est-à-dire que les
                                                                        produits commandés aient été livrés et installés,
                                                                    </li>
                                                                    <li>
                                                                        que les montants dus à la société K par K aient été réglés par le filleul et encaissés par
                                                                        K par K,
                                                                    </li>
                                                                    <li>
                                                                        qu'il n'y ait aucun litige d'aucune sorte entre le Filleul et la société K par K.
                                                                        K par K se réserve le droit de relancer les Filleuls, pour leur rappeler qu'ils peuvent bénéficier
                                                                        d'un avantage lié au parrainage.
                                                                    </li>
                                                                </ul>
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div><!-- /.panel -->
                                                <div class="panel panel-custom-header">
                                                    <div class="panel-heading">
                                                        <div class="panel-title-icon">
                                                            <a class="collapsed" role="button" data-toggle="collapse" href="#parrainage_panel-condition" aria-expanded="false" aria-controls="parrainage_panel-condition">
                                                                <span id="parrainage_icon-condition" class="fa fa-chevron-right parrainage-icon-collapse" aria-hidden="true"></span>
                                                            </a>
                                                        </div>
                                                        <div style="display: inline-block;">
                                                            <a role="button" data-toggle="collapse" href="#parrainage_panel-condition" aria-expanded="false" aria-controls="parrainage_panel-condition">
                                                                <h3 class="panel-title">Les conditions d'éligibilités</h3>
                                                            </a>
                                                        </div>
                                                    </div>
                                                    <div class="panel-body collapse" id="parrainage_panel-condition">
                                                        <div>
                                                            <h6 class="text-red">1.1. Le Parrainage est accessible :</h6>
                                                            <p class="text-justify">
                                                                <ul>
                                                                    <li>
                                                                        sur le site web https://kpark.secure.force.com/espaceclients/ (le « Site ») et/ou tout autre adresse URL, hyperlien,
                                                                        bouton, ... apposé sur un autre site et redirigeant vers le Site et, le cas échéant, sur tout autre
                                                                        site web de substitution du Site,
                                                                    </li>
                                                                    <li>
                                                                        par appel au centre d'appels K par K à travers un numéro dédié à l'opération de parrainage, à
                                                                        savoir le 0.811.133.014 (prix d'un appel local depuis un poste fixe).
                                                                    </li>
                                                                </ul>
                                                            </p>
                                                        </div>
                                                        <div>
                                                            <h6 class="text-red">
                                                                1.2. Le Parrainage a pour but d'encourager un maximum d'individus à acheter des produits K
                                                                par K :
                                                            </h6>
                                                            <p class="text-justify">
                                                                Il consiste à encourager les clients de K par K qui le souhaiteront à devenir
                                                                prescripteurs du service K par K (« Parrain(s) »), c'est à dire à faire connaître les produits et
                                                                les offres de K par K à d'autres individus (internautes ou non internautes) non encore clients
                                                                et à les inciter à devenir clients à leur tour de K par K, en les parrainant, leur conférant ainsi le
                                                                statut de filleul (« Filleul »).
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div><!-- /.panel -->
                                            </div><!-- /.panel-body -->
                                        </div><!-- /.panel Détail offre parrainage -->
                                    </div><!-- /.row -->
                                </div><!-- /.col-xs-12 col-md-10 col-md-offset-1 -->
                            </div><!-- /.parrainage -->
                            <!-- Fenêtes modal parrainage ajout filleul -->
                            <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="parrainage_modalAddLabel" id="parrainage_modalAdd">
                                <div class="modal-dialog modal-lg modal-sm modal-custom" style="max-width:100%" role="document">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h3 class="modal-title" id="parrainage_modalAddLabel">
                                                <a class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="glyphicon glyphicon-remove"></span></a>
                                                Parrainer un proche
                                            </h3>
                                        </div>
                                        <div id="parrainage_modalAddPanel" data-toggle="false" class="modal-body" role="tabpanel">
                                            <div id="parrainage-message" class="col-md-12 col-sm-12 col-xs-12 hidden">
                                                <div id="parrainage-message_alert" class="alert">
                                                </div>
                                            </div>
                                            <p class="text-grey">
                                                Veuillez renseigner les champs ci-dessous.<br />
                                                Ces informations ne seront pas utilisés à des fins commerciales.
                                            </p>
                                            <c:formblock alignment="horizontal">
                                                <div class="form-group">
                                                    <div class="col-md-12 col-sm-12 col-xs-12">
                                                        <label class="control-label" for="{!$Component.nom_filleul}">Nom <span class="required-field">*</span></label>
                                                        <input class="form-control input-sm" id="nom_filleul" placeholder="Nom" title="Nom du filleul" />
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <div class="col-md-12 col-sm-12 col-xs-12">
                                                        <label class="control-label" for="{!$Component.prenom_filleul}">Prénom <span class="required-field">*</span></label>
                                                        <input class="form-control input-sm" id="prenom_filleul" placeholder="Prénom" title="Prénom du filleul" />
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <div class="col-md-12 col-sm-12 col-xs-12">
                                                        <label class="control-label" for="{!$Component.email_filleul}">Adresse e-mail</label>
                                                        <input class="form-control input-sm" id="email_filleul" placeholder="Adresse e-mail" title="Adresse e-mail" type="email" />
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <div class="col-md-12 col-sm-12 col-xs-12">
                                                        <label class="control-label" for="{!$Component.telephone_filleul}">Téléphone</label>
                                                        <input class="form-control input-sm" id="telephone_filleul" placeholder="Téléphone" title="Téléphone" type="tel" pattern="[0-9]{10}" />
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <div class="col-md-12 col-sm-12 col-xs-12">
                                                        <label class="control-label" for="autocomplete_filleul">Adresse complète <span class="required-field">*</span></label>
                                                        <input type="text" id="autocomplete_filleul" class="form-control input-sm" placeholder="Veuillez indiquer un lieu" onchange="setNullValue(this);" title="Adresse complète"/>
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <div class="col-md-12 col-sm-12 col-xs-12">
                                                        <label class="control-label" for="{!$Component.typeDotation_filleul}">Type de dotation souhaitée <span class="required-field">*</span></label>
                                                        <select id="typeDotation_filleul" class="form-control input-sm" placeholder="Type de dotation" title="Type de dotation">
                                                            <option value="Chèque électronique">Chèque cadeaux électronique</option>
                                                            <option value="Chèque cadeaux papier envoyé en recommandé">Chèque cadeaux papier envoyé en recommandé</option>
                                                            <option value="Carte cadeaux">Carte cadeaux</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <div class="col-md-12 col-sm-12 col-xs-12">
                                                        <span class="required-field">*</span> Champs obligatoires
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <div class="col-md-12 col-sm-12 col-xs-12">
                                                        <div class="pull-right">
                                                            <input type="button" onclick="callRemoteActionFilleul();" id="ajoutFilleul" class="btn-lg btn-custom btn-custom-red" value="VALIDER" data-loading-text="{!$Label.espaceclient_msg_Loading}" />
                                                        </div>
                                                    </div>
                                                </div>
                                                <input class="hidden" id="adresse_rue_filleul" />
                                                <input class="hidden" id="postal_code_filleul" />
                                                <input class="hidden" id="locality_filleul" />
                                                <input class="hidden" id="administrative_area_level_1_filleul" />
                                                <input class="hidden" id="country_filleul" value="FRANCE" />
                                                <input class="hidden" id="adresse_latitude_filleul" />
                                                <input class="hidden" id="adresse_longitude_filleul" />
                                            </c:formblock>
                                        </div><!-- /.modal-body -->
                                    </div> <!-- /.modal-content -->
                                </div><!-- /.modal-dialog -->
                            </div><!-- /.modal parrainage ajout filleul  -->
                            <!-- Fenêtes modal information filleuls -->
                            <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="parrainage_modalFilleulsLabel" id="parrainage_modalFilleuls">
                                <div class="modal-dialog modal-custom" style="max-width:100%" role="document">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h3 class="modal-title" id="parrainage_modalFilleulsLabel">
                                                <a class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="glyphicon glyphicon-remove"></span></a>
                                                Filleuls parrainés
                                            </h3>
                                        </div>
                                        <div id="parrainage_modalFilleuls" data-toggle="false" class="modal-body" role="tabpanel">
                                            <div>
                                                <p class="text-uppercase text-grey">Retrouvez ici les informations sur vos différents parrainages.</p>
                                            </div>
                                            <ul class="list-group list-group-custom" id="parrainage_modalFilleuls-liste">
                                                <apex:repeat value="{!filleuls}" var="filleul">
                                                    <li class="list-group-item-custom" id="parrainage_modalFilleuls-line">
                                                        <div>
                                                            <strong class="text-uppercase" id="parrainage_modalFilleuls-name">{!filleul.prenom} {!filleul.nom}</strong>
                                                        </div>
                                                        <div>
                                                            Demande de parrainage envoyée le :
                                                            <span class="text-red" id="parrainage_modalFilleuls-date">
                                                                <apex:outputtext value="{0, date, dd/MM/yyyy}">
                                                                    <apex:param value="{!filleul.dateAssociationParrain}" />
                                                                </apex:outputtext>
                                                            </span>
                                                        </div>
                                                    </li>
                                                </apex:repeat>
                                            </ul>
                                        </div><!-- /.modal-body -->
                                    </div> <!-- /.modal-content -->
                                </div><!-- /.modal-dialog -->
                            </div><!-- /.modal parrainage information filleuls -->
                            <!-- Fenêtes modal information filleuls clients -->
                            <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="parrainage_modalFilleulsClientLabel" id="parrainage_modalFilleulsClient">
                                <div class="modal-dialog modal-custom" style="max-width:100%" role="document">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h3 class="modal-title" id="parrainage_modalFilleulsClientLabel">
                                                <a class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="glyphicon glyphicon-remove"></span></a>
                                                Vos filleuls devenus clients
                                            </h3>
                                        </div>
                                        <div id="parrainage_modalFilleulsClient" data-toggle="false" class="modal-body" role="tabpanel">
                                            <div>
                                                <p class="text-uppercase text-grey">Retrouvez ici les informations sur vos différents parrainages.</p>
                                            </div>
                                            <ul class="list-group list-group-custom">
                                                <apex:repeat value="{!filleulsClient}" var="filleul">
                                                    <li class="list-group-item-custom">
                                                        <div>
                                                            <strong class="text-uppercase">{!filleul.prenom} {!filleul.nom}</strong>
                                                        </div>
                                                        <div>
                                                            Demande de parrainage envoyée le :
                                                            <span class="text-red">
                                                                <apex:outputtext value="{0, date, dd/MM/yyyy}">
                                                                    <apex:param value="{!filleul.dateAssociationParrain}" />
                                                                </apex:outputtext>
                                                            </span>
                                                        </div>
                                                    </li>
                                                </apex:repeat>
                                            </ul>
                                        </div><!-- /.modal-body -->
                                    </div> <!-- /.modal-content -->
                                </div><!-- /.modal-dialog -->
                            </div><!-- /.modal parrainage information filleuls clients -->
                            <!-- Fenêtes modal information montant cumulés -->
                            <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="parrainage_modalMontantLabel" id="parrainage_modalMontant">
                                <div class="modal-dialog modal-custom" style="max-width:100%" role="document">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h3 class="modal-title" id="parrainage_modalMontantLabel">
                                                <a class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="glyphicon glyphicon-remove"></span></a>
                                                Montants cumulés
                                            </h3>
                                        </div>
                                        <div id="parrainage_modalMontant" data-toggle="false" class="modal-body" role="tabpanel">
                                            <div>
                                                <p class="text-uppercase text-grey">Retrouvez ici l'historique de vos gains.</p>
                                            </div>
                                            <ul class="list-group list-group-custom">
                                                <apex:repeat value="{!filleulsClient}" var="filleul">
                                                    <li class="clearfix list-group-item-custom2">
                                                        <div class="text-red">
                                                            <apex:outputtext value="{0, date, dd/MM/yyyy}">
                                                                <apex:param value="{!filleul.dateEnvoiDotationParrain}" />
                                                            </apex:outputtext>
                                                        </div>
                                                        <div>
                                                            <div class="col-md-10 col-sm-10 col-xs-10" style="padding-left: 0px;padding-right: 0px;">
                                                                Parrainage de {!filleul.prenom} {!filleul.nom}
                                                            </div>
                                                            <div class="col-md-2 col-sm-2 col-xs-2" style="padding-left: 0px;padding-right: 0px;">
                                                                <div class="pull-right">
                                                                    <span class="text-red">150 €</span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </li>
                                                </apex:repeat>
                                                <li class="clearfix list-group-item-custom">
                                                    <div>
                                                        <div class="col-md-10 col-sm-10 col-xs-10" style="padding-left: 0px;padding-right: 0px;">
                                                            <div class="pull-right">
                                                                <strong>TOTAL :</strong>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-2 col-sm-2 col-xs-2" style="padding-left: 0px;padding-right: 0px;">
                                                            <div class="pull-right">
                                                                <span class="text-red">{!filleulsClient.size*150} €</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </li>
                                            </ul>
                                        </div><!-- /.modal-body -->
                                    </div> <!-- /.modal-content -->
                                </div><!-- /.modal-dialog -->
                            </div><!-- /.modal parrainage information montant cumulés -->
                        </apex:form>
                    </div><!-- /.tabpanel : PARRAINAGE -->
                    <!-- Onglet Demandes -->
                    <div role="tabpanel" class="tab-pane" id="demandes">
                        <apex:form >
                            <apex:actionfunction name="rerenderDemandes" rerender="demandes-rerenderPanel" oncomplete="initCasesTables()"></apex:actionfunction>
                            <apex:actionfunction name="rerenderDemande" rerender="demande-rerenderPanel">
                                <apex:param id="param_caseId1" name="caseId" value="" />
                            </apex:actionfunction>
                            <apex:actionfunction name="rerenderDemandeComments" rerender="comments-panel-body">
                                <apex:param id="param_caseId2" name="caseId" value="" />
                            </apex:actionfunction>
                            <apex:actionfunction name="displayDemande" rerender="demande-rerenderPanel" oncomplete="switchDisplayedDiv('demande-details','demandesTable-container');">
                                <apex:param id="param_caseId3" name="caseId" value="" />
                            </apex:actionfunction>
                            <apex:actionfunction name="displayDemandeStayHidden" rerender="demande-rerenderPanel" oncomplete="displayElement('demande-statusChange-container');">
                                <apex:param id="param_caseId4" name="caseId" value="" />
                            </apex:actionfunction>
                        </apex:form>
                        <div id="demandes-panel-content" class="col-xs-12 col-md-10 col-md-offset-1">
                            <div id="contact-message" class="col-md-12 col-sm-12 col-xs-12 hidden">
                                <div id="contact-message_alert" class="alert" role="alert">
                                </div>
                            </div>
                            <div id="nouvelleDemande-container" class="col-xs-12 col-sm-10 col-md-8 col-sm-offset-1 col-md-offset-2 hidden">
                                <div class="panel panel-custom">
                                    <div class="panel-body">
                                        <h3 class="title">Rédiger une demande</h3>
                                        <apex:outputpanel id="demandes_panel">
                                            <apex:form id="demandes_formulaire">
                                                <c:formblock alignment="horizontal">
                                                    <div class="form-group">
                                                        <div class="col-md-12 col-sm-12 col-xs-12">
                                                            <label class="control-label" for="{!$Component.demande_type}">Type de demande <span class="required-field">*</span></label>
                                                            <apex:actionregion >
                                                                <apex:selectlist id="demande_type" styleclass="form-control" multiselect="false" size="1" value="{!selectedTypeDemande}">
                                                                    <apex:selectoptions value="{!TypeDemande}" />
                                                                    <apex:actionsupport event="onchange" rerender="demande_motif" oncomplete="refreshMotifsListState();"/>
                                                                </apex:selectlist>
                                                            </apex:actionregion>
                                                        </div>
                                                    </div>
                                                    <div class="form-group">
                                                        <div class="col-md-12 col-sm-12 col-xs-12">
                                                            <label class="control-label" for="{!$Component.demande_motif}" id="demande_motif_label">{!$Label.espaceclient_text_CaseMotif} <span class="required-field">*</span></label>
                                                            <apex:actionregion >
                                                                <apex:selectlist id="demande_motif" styleclass="form-control" multiselect="false" size="1" value="{!selectedMotif}">
                                                                    <apex:selectoptions value="{!motifOptions}" />
                                                                </apex:selectlist>
                                                            </apex:actionregion>
                                                        </div>
                                                    </div>
                                                    <div class="form-group">
                                                        <div class="col-md-12 col-sm-12 col-xs-12">
                                                            <label class="control-label" for="{!$Component.demande_typeRDV}" id="demande_typeRDV_label">{!$Label.espaceclient_text_CaseRDVType} <span class="required-field">*</span></label>
                                                            <apex:selectlist id="demande_typeRDV" styleclass="form-control" multiselect="false" size="1" value="{!selectedTypeDeRDV}">
                                                                <apex:selectoptions value="{!typeDeRDV}" />
                                                            </apex:selectlist>
                                                        </div>
                                                    </div>
                                                    <div class="form-group">
                                                        <div class="col-md-12 col-sm-12 col-xs-12">
                                                            <label class="control-label" for="{!$Component.demande_chantier}" id="demande_chantier_label">Concerne le chantier <span class="required-field">*</span></label>
                                                            <apex:selectlist id="demande_chantier" styleclass="form-control" multiselect="false" size="1" value="{!selectedChantier}">
                                                                <apex:selectoptions value="{!chantiersClient}" />
                                                            </apex:selectlist>
                                                        </div>
                                                    </div>
                                                    <div class="form-group">
                                                        <div class="col-md-12 col-sm-12 col-xs-12">
                                                            <label class="control-label" for="{!$Component.demande_description}">Description <span class="required-field">*</span></label>
                                                            <apex:inputtextarea styleclass="form-control" id="demande_description" html-placeholder="Description de votre demande" title="descriptionDemande" rows="10" value="{!selectedDescriptionDemande}" />
                                                        </div>
                                                    </div>
                                                    <div class="form-group">
                                                        <div class="col-md-12 col-sm-12 col-xs-12">
                                                            <label class="control-label" for="{!$Component.demande_attachement}">Pièce jointe</label>
                                                            <p>
                                                                <small>
                                                                    Formats du fichier acceptés : jpeg, jpg, png, gif, bmp
                                                                    <br />Taille maximum : 4 Mo
                                                                </small>
                                                            </p>
                                                            <input type="file" id="demande_attachement" accept="image/*" />
                                                        </div>
                                                    </div>
                                                    <div class="col-md-12 col-sm-12 col-xs-12">
                                                        <input type="button" onclick="switchDisplayedDiv('demandesTable-container','nouvelleDemande-container');eraseMessage('contact');" id="button-retourListeDemandes2" class="btn-lg btn-custom btn-custom-red" value="Annuler" />
                                                        <div class="pull-right">
                                                            <input type="button" onclick="callRemoteActionDemandes();" id="envoyerDemande" class="btn-lg btn-custom btn-custom-red" value="ENVOYER MA DEMANDE" data-loading-text="{!$Label.espaceclient_msg_Loading}" />
                                                        </div>
                                                    </div>
                                                </c:formblock>
                                            </apex:form>
                                        </apex:outputpanel>
                                    </div>
                                </div>
                            </div>
                            <apex:outputpanel id="demande-rerenderPanel" layout="block">
                                <div id="demandesTable-container">
                                    <apex:outputpanel id="demandes-rerenderPanel" layout="none">
                                        <div id="demandes-actions-container">
                                            <input type="button" id="button-nouvelleDemande" onclick="switchDisplayedDiv('nouvelleDemande-container','demandesTable-container');eraseMessage('contact');" value="Nouvelle demande" class="btn-lg btn-custom btn-custom-red" />
                                        </div>
                                        <apex:outputpanel id="demandesTable-panel" layout="block" styleclass="panel panel-custom">
                                            <div class="panel-heading">
                                                <h5 class="panel-title text-uppercase"> Demandes en cours </h5>
                                            </div>
                                            <div class="panel-body">
                                                <table id="demandesTable" style="width: 100%;" class="table table-responsive table-custom-clickable">
                                                    <thead>
                                                        <tr>
                                                            <th>Id</th>
                                                            <th>Numéro de requête</th>
                                                            <th>Type</th>
                                                            <th>Motif</th>
                                                            <th>Type de rendez-vous</th>
                                                            <th>Chantier</th>
                                                            <th>Statut</th>
                                                            <th>Date</th>
                                                            <th>Clôture</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <apex:repeat value="{!demandesClient}" var="id">
                                                            <apex:outputpanel rendered="{!NOT(demandesClient[id].isClosed)}" layout="none">
                                                                <tr>
                                                                    <td onclick="displayDemande('{!id}');eraseMessage('contact');"> <apex:outputtext value="{!id}"></apex:outputtext> </td>
                                                                    <td onclick="displayDemande('{!id}');eraseMessage('contact');"> <apex:outputtext value="{!demandesClient[id].numero}"></apex:outputtext> </td>
                                                                    <td onclick="displayDemande('{!id}');eraseMessage('contact');"> <apex:outputtext value="{!demandesClient[id].typeDemande}"></apex:outputtext> </td>
                                                                    <td onclick="displayDemande('{!id}');eraseMessage('contact');"> <apex:outputtext value="{!demandesClient[id].motif}"></apex:outputtext> </td>
                                                                    <td onclick="displayDemande('{!id}');eraseMessage('contact');"> <apex:outputtext value="{!demandesClient[id].typeRDV}"></apex:outputtext> </td>
                                                                    <td onclick="displayDemande('{!id}');eraseMessage('contact');"> <apex:outputtext value="{!demandesClient[id].chantier}" /> </td>
                                                                    <td onclick="displayDemande('{!id}');eraseMessage('contact');" class="statut-{!demandesClient[id].statut}"> <apex:outputtext value="{!demandesClient[id].statut}" /> </td>
                                                                    <td onclick="displayDemande('{!id}');eraseMessage('contact');"> <apex:outputtext value="{0, date, dd/MM/yyyy}"><apex:param value="{!demandesClient[id].dateDemande}" /></apex:outputtext> </td>
                                                                    <td> 
                                                                        <apex:outputpanel rendered="{!demandesClient[id].statut == 'A clôturer'}" layout="none">
                                                                            <button type="button" id="button-cloreDemandeRapide" onclick="displayDemandeStayHidden('{!demandesClient[id].Id}');" class="btn-sm btn-custom btn-custom-red" style="padding: 5px 5px!important;">
                                                                                <span class="glyphicon glyphicon-check" aria-hidden="true"></span> 
                                                                                A Clôturer
                                                                            </button> 
                                                                        </apex:outputpanel>
                                                                    </td>
                                                                </tr>
                                                            </apex:outputpanel>
                                                        </apex:repeat>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </apex:outputpanel>
                                        <apex:outputpanel id="demandesClosesTable-panel" layout="block" styleclass="panel panel-custom">
                                            <div class="panel-heading">
                                                <h5 class="panel-title text-uppercase"> Demandes clôturées </h5>
                                            </div>
                                            <div class="panel-body">
                                                <table id="demandesClosesTable" style="width: 100%;" class="table table-responsive table-custom-clickable">
                                                    <thead>
                                                        <tr>
                                                            <th>Id</th>
                                                            <th>Numéro de requête</th>
                                                            <th>Type</th>
                                                            <th>Motif</th>
                                                            <th>Type de rendez-vous</th>
                                                            <th>Chantier</th>
                                                            <th class="hidden">Statut</th>
                                                            <th>Date</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <apex:repeat value="{!demandesClient}" var="id">
                                                            <apex:outputpanel rendered="{!demandesClient[id].isClosed}" layout="none">
                                                                <tr onclick="displayDemande('{!id}')">
                                                                    <td> <apex:outputtext value="{!id}"></apex:outputtext> </td>
                                                                    <td> <apex:outputtext value="{!demandesClient[id].numero}"></apex:outputtext> </td>
                                                                    <td> <apex:outputtext value="{!demandesClient[id].typeDemande}"></apex:outputtext> </td>
                                                                    <td> <apex:outputtext value="{!demandesClient[id].motif}"></apex:outputtext> </td>
                                                                    <td> <apex:outputtext value="{!demandesClient[id].typeRDV}"></apex:outputtext> </td>
                                                                    <td> <apex:outputtext value="{!demandesClient[id].chantier}" />  </td>
                                                                    <td class="hidden"> <apex:outputtext value="{!demandesClient[id].statut}" /> </td>
                                                                    <td> <apex:outputtext value="{0, date, dd/MM/yyyy}"><apex:param value="{!demandesClient[id].dateDemande}" /></apex:outputtext> </td>
                                                                </tr>
                                                            </apex:outputpanel>
                                                        </apex:repeat>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </apex:outputpanel>
                                    </apex:outputpanel>
                                </div>

                                <div id="demande-details" class="hidden">
                                    <div class="row text-center" style="margin-bottom: 15px; margin-top: 40px;">
                                        <div class="col-md-offset-2 col-md-3">
                                            <button type="button" onclick="switchDisplayedDiv('demandesTable-container','demande-details');" id="button-retourListeDemandes" class="btn-lg btn-custom btn-custom-red">
                                                <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span> Retour à la liste des demandes
                                            </button>
                                        </div>
                                        <div class="col-md-offset-2 col-md-3 inline-button">
                                            <apex:outputpanel layout="none" rendered="{!NOT(demandeToDisplay.isClosed)}">
                                                <button type="button" id="button-cloreDemande" onclick="displayElement('demande-statusChange-container');" class="btn-lg btn-custom btn-custom-red">
                                                    <span class="glyphicon glyphicon-check" aria-hidden="true"></span> Clore la demande
                                                </button>
                                            </apex:outputpanel>
                                            <apex:outputpanel layout="none" rendered="{!demandeToDisplay.isClosed}">
                                                <button type="button" id="button-rouvrirDemande" onclick="displayElement('demande-statusChange-container');" class="btn-lg btn-custom btn-custom-red">
                                                    <span class="glyphicon glyphicon-share-alt" aria-hidden="true"></span> Rouvrir la demande
                                                </button>
                                            </apex:outputpanel>
                                        </div>
                                    </div>

                                    <apex:outputpanel id="demande-details-panel">
                                        <div class="panel panel-custom-red">
                                            <div class="panel-heading">
                                                <h3>Demande du <apex:outputtext value="{0, date, dd/MM/yyyy}"><apex:param value="{!demandeToDisplay.dateDemande}" /></apex:outputtext> - Statut : {!demandeToDisplay.statut}</h3>
                                            </div>
                                            <div class="panel-body">
                                                <h4>Votre demande</h4>
                                                <div class="panel panel-custom">
                                                    <div class="panel-body">
                                                        <div class="row">
                                                            <div class="label-container col-xs-6 col-md-3 col-lg-2"><label>Numéro de demande</label></div>
                                                            <div class="col-xs-6 col-md-3 col-lg-3">
                                                                <apex:outputtext value="{!demandeToDisplay.numero}" />
                                                            </div>
                                                            <div class="clearfix visible-xs"></div>
                                                            <div class="clearfix visible-sm"></div>
                                                            <div class="label-container col-xs-6 col-md-3 col-lg-2 col-lg-offset-2"><label>Chantier</label></div>
                                                            <div class="col-xs-6 col-md-3 col-lg-3">
                                                                <apex:outputtext value="{!demandeToDisplay.chantier}" />
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="label-container col-xs-6 col-md-3 col-lg-2"><label>Type</label></div>
                                                            <div class="col-xs-6 col-md-3 col-lg-3">
                                                                <apex:outputtext value="{!demandeToDisplay.typeDemande}" />
                                                            </div>
                                                            <div class="clearfix visible-xs"></div>
                                                            <div class="clearfix visible-sm"></div>
                                                            <div class="label-container col-xs-6 col-md-3 col-lg-2 col-lg-offset-2"><label>Statut</label></div>
                                                            <div class="col-xs-6 col-md-3 col-lg-3">
                                                                <apex:outputtext value="{!demandeToDisplay.statut}" />
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="label-container col-xs-6 col-md-3 col-lg-2"><label>Date d'ouverture</label></div>
                                                            <div class="col-xs-6 col-md-3 col-lg-3">
                                                                <apex:outputtext value="{0, date, dd/MM/yyyy}"><apex:param value="{!demandeToDisplay.dateDemande}" /></apex:outputtext>
                                                            </div>
                                                            <div class="clearfix visible-xs"></div>
                                                            <div class="clearfix visible-sm"></div>
                                                            <apex:outputpanel layout="none" rendered="{!demandeToDisplay.isClosed}">
                                                                <div class="label-container col-xs-6 col-md-3 col-lg-2 col-lg-offset-2"><label>Date de fermeture</label></div>
                                                                <div class="col-xs-6 col-md-3 col-lg-3">
                                                                    <apex:outputtext value="{0, date, dd/MM/yyyy}"><apex:param value="{!demandeToDisplay.dateFermeture}" /></apex:outputtext>
                                                                </div>
                                                            </apex:outputpanel>
                                                        </div>
                                                    </div>
                                                </div>
                                                <h4>Description</h4>
                                                <apex:outputpanel id="demande-identification-container" layout="block" styleclass="panel panel-custom">
                                                    <div id="demande-identification" class="panel-body">
                                                        <div class="row">
                                                            <div class="label-container col-xs-6 col-md-3 col-lg-2"><label>Motif</label></div>
                                                            <div class="col-xs-6 col-md-3 col-lg-3"><apex:outputtext value="{!demandeToDisplay.motif}" /></div>
                                                            <div class="clearfix visible-xs"></div>
                                                            <div class="clearfix visible-sm"></div>
                                                            <div class="label-container col-xs-6 col-md-3 col-lg-2 col-lg-offset-2"><label>{!$Label.espaceclient_text_CaseRDVType}</label></div>
                                                            <div class="col-xs-6 col-md-3 col-lg-3"><apex:outputtext value="{!demandeToDisplay.typeRDV}" /></div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="label-container col-xs-6 col-md-3 col-lg-2"><label>Objet</label></div>
                                                            <div class="col-xs-6 col-md-3 col-lg-3"><apex:outputtext value="{!demandeToDisplay.objet}" /></div>
                                                        </div>
                                                        <div class="row" id="demande-description-row">
                                                            <div class="label-container col-md-3"><label>Description de la demande</label></div>
                                                            <div class="col-md-12"><apex:outputtext value="{!demandeToDisplay.description}" /></div>
                                                        </div>
                                                    </div>
                                                </apex:outputpanel>
                                                <!--<h4>Commentaires</h4>-->
                                                <div id="demande-navbar">
                                                    <ul class="nav nav-tabs" role="tablist">
                                                        <li role="presentation" class="menu-item active">
                                                            <a href="#demande-comments" role="tab" data-toggle="tab" aria-controls="demande-comments" id="demande-comments_link" onclick="changeNavTab(this);">
                                                                Commentaires <span class="badge">{!commentairesToDisplay.size}</span>
                                                            </a>
                                                        </li>
                                                        <li role="presentation" class="menu-item">
                                                            <a href="#demande-attachments" role="tab" data-toggle="tab" aria-controls="demande-attachments" id="demande-attachments_link" onclick="changeNavTab(this);">
                                                                Pièces jointes <span class="badge">{!caseAttachmentToDisplay.size}</span>
                                                            </a> 
                                                        </li>
                                                    </ul>
                                                </div>
                                                <div class="tab-content">
                                                    <div role="tabpanel" class="tab-pane active" id="demande-comments">
                                                        <div class="panel panel-custom">
                                                            <apex:outputpanel id="comments-panel-body" layout="block" styleclass="panel-body">
                                                                <div id="comments-list">
                                                                    <apex:outputpanel layout="block" styleclass="well" rendered="{!commentairesToDisplay.size = 0}">
                                                                        {!$Label.espaceclient_text_CasetNoComments}
                                                                    </apex:outputpanel>
                                                                    <apex:repeat value="{!commentairesToDisplay}" var="comment" rendered="{!commentairesToDisplay.size > 0}">
                                                                        <apex:variable var="commentClass" value="{!IF(comment.isFromClient==true,'comment-client', 'comment-kpark')}" />
                                                                        <div class="comment {!commentClass}">
                                                                            <div class="comment-info">
                                                                                <span class="comment-author"></span>
                                                                                <span class="comment-date">
                                                                                    <apex:outputtext value="{!comment.dateCreation}"></apex:outputtext>
                                                                                </span>
                                                                            </div>
                                                                            <p class="comment-text">{!comment.texte}</p>
                                                                        </div>
                                                                    </apex:repeat>
                                                                </div>
                                                                <apex:messages styleclass="bg-danger" />
                                                                <apex:form id="comment-form" rendered="{!NOT(demandeToDisplay.isClosed)}">
                                                                    <div class="form-group">
                                                                        <label class="control-label" for="{!$Component.demande_newComment}">Laisser un commentaire</label>
                                                                        <textarea id="demande_newComment" class="form-control" html-placeholder="Votre commentaire..." title="Nouveau commentaire" rows="5"/>
                                                                    </div>
                                                                    <div class="col-xs-12">
                                                                        <div class="pull-right">
                                                                            <span id="comments-message" class="hidden">
                                                                                <span id="comments-message_alert" class="alert">
                                                                                </span>
                                                                            </span>
                                                                            <input type="button" onclick="callRemoteActionPostComment('{!demandeToDisplay.id}');" id="postComment" class="btn-lg btn-custom btn-custom-red" value="ENVOYER" data-loading-text="{!$Label.espaceclient_msg_Loading}" />
                                                                        </div>
                                                                    </div>
                                                                </apex:form>
                                                                <script>
                                                                    j$("#comments-list").animate({ scrollTop: j$(this).height() }, "slow"); //scroll en bas au chargement
                                                                </script>
                                                            </apex:outputpanel>
                                                        </div>
                                                    </div>
                                                    <div role="tabpanel" class="tab-pane" id="demande-attachments">
                                                        <div class="panel panel-custom">
                                                            <apex:outputpanel id="attachments-panel-body" layout="block" styleclass="panel-body">
                                                                <div id="attachments-list">
                                                                    <apex:outputpanel layout="block" styleclass="well" rendered="{!caseAttachmentToDisplay.size = 0}">
                                                                        {!$Label.espaceclient_text_CasetNoAttachments}
                                                                    </apex:outputpanel>
                                                                    <apex:outputpanel layout="none" rendered="{!caseAttachmentToDisplay.size > 0}">
                                                                        <table class="table table-condensed">  
                                                                            <thead>
                                                                                <th>Nom</th>
                                                                                <th>Date d'ajout</th>
                                                                            </thead>
                                                                            <tbody>
                                                                                <apex:repeat value="{!caseAttachmentToDisplay}" var="attachment" rendered="{!caseAttachmentToDisplay.size > 0}">
                                                                                    <tr> 
                                                                                        <th scope="row"><a href="#" onclick="downloadFile('{!attachment.nom}','{!attachment.body}','{!attachment.contentType}');">{!attachment.nom}</a></th> 
                                                                                        <td><apex:outputtext value="{!attachment.dateCreation}"></apex:outputtext></td>
                                                                                    </tr>
                                                                                </apex:repeat>
                                                                            </tbody> 
                                                                        </table>
                                                                    </apex:outputpanel>
                                                                    <div>
                                                                        <label class="control-label">Ajouter un fichier</label>
                                                                        <p>
                                                                            <small>
                                                                                Formats du fichier acceptés : jpeg, jpg, png, gif, bmp
                                                                                <br />Taille maximum : 4 Mo
                                                                            </small>
                                                                        </p>
                                                                        <input type="file" id="demande_addAttachement" accept="image/*" />
                                                                        <input type="button" style="padding-top: 10px" onclick="callRemoteActionAddAttachment('{!demandeToDisplay.id}');" id="envoyerAttachement" class="btn-lg btn-custom btn-custom-red" value="JOINDRE LE FICHIER" data-loading-text="{!$Label.espaceclient_msg_Loading}" />
                                                                        <span id="attachment-message" class="hidden">
                                                                            <span id="attachment-message_alert" class="alert">
                                                                            </span>
                                                                        </span>
                                                                    </div>
                                                                </div>
                                                            </apex:outputpanel>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </apex:outputpanel><!-- apex #demande-details-panel -->
                                </div><!-- / #demande-details -->
                                <div id="demande-statusChange-container" class="hidden">
                                    <div id="demande-statusChange-panel">
                                        <div id="demande-statusChange-message" class="hidden">
                                            <div id="demande-statusChange-message_alert" class="alert">
                                            </div>
                                        </div>
                                        <apex:form id="demande-statusChange-form">
                                            <div class="form-group">
                                                <label for="demande_statusComment" class="control-label">
                                                    <apex:outputpanel rendered="{!demandeToDisplay.isClosed}"> 
                                                        <apex:outputText escape="false" value="{!$Label.espaceclient_text_statusCommentLabel_opening}" />
                                                    </apex:outputpanel>
                                                    <apex:outputpanel rendered="{!NOT(demandeToDisplay.isClosed)}"> 
                                                        <apex:outputText escape="false" value="{!$Label.espaceclient_text_statusCommentLabel_closing}" />
                                                    </apex:outputpanel>
                                                </label>
                                                <textarea id="demande_statusComment" class="form-control" title="Commentaire à propos du changement de statut" rows="5"/>
                                            </div>
                                            <div id="demande-statusChange-buttons">
                                                <button id="demande-statusChange-cancel" type="button" onclick="closeStatusChangePopup()" class="btn btn-custom btn-custom-red">Annuler</button>
                                                <apex:outputpanel layout="none" rendered="{!NOT(demandeToDisplay.isClosed)}">                                                        
                                                    <input type="button" onclick="callRemoteActionCloreDemande('{!demandeToDisplay.id}');" id="cloreDemande" class="btn-lg btn-custom btn-custom-red" value="VALIDER" data-loading-text="{!$Label.espaceclient_msg_Loading}" />
                                                </apex:outputpanel>
                                                <apex:outputpanel layout="none" rendered="{!demandeToDisplay.isClosed}">
                                                    <input type="button" onclick="callRemoteActionRouvrirDemande('{!demandeToDisplay.id}');" id="rouvrirDemande" class="btn-lg btn-custom btn-custom-red" value="VALIDER" data-loading-text="{!$Label.espaceclient_msg_Loading}" />
                                                </apex:outputpanel>
                                            </div>
                                        </apex:form>
                                    </div>
                                </div>
                            </apex:outputpanel> <!-- apex #demande-rerenderPanel -->
                        </div><!-- / #demandes-panel-content -->
                    </div><!-- /.tabpanel : DEMANDES -->

                    <!-- Onglet Utilisation des données personnelles  -->
                    <div role="tabpanel" class="tab-pane" id="donneesperso">
                        <div class="col-md-10 col-lg-10 col-lg-offset-1 col-md-offset-1">
                            <div id="donneesperso-message" class="col-md-12 col-sm-12 col-xs-12 hidden">
                                <div id="donneesperso-message_alert" class="alert">
                                </div>
                            </div>
                            <apex:form id="donneesperso-formulaire">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="panel panel-custom">
                                        <div class="panel-heading">
                                            <h5 class="panel-title">
                                                UTILISATION DES DONNEES PERSONNELLES
                                            </h5>
                                        </div>
                                        <div class="panel-body">
                                            <p>
                                                Pour exporter vos données, cliquez sur ce bouton afin de télécharger un fichier contenant vos données.
                                            </p>
                                            <div class="text-center">
                                                <input type="button" onclick="callRemoteActionJsonExportDonnees();" id="jsonExportDonnees" 
                                                        class="btn-lg btn-custom btn-custom-red" value="EXPORT DE DONNEES" data-loading-text="{!$Label.espaceclient_msg_Loading}" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </apex:form>
                        </div><!-- /.col-md-10 col-lg-10 -->
                    </div><!-- /.tabpanel : Utilisation des données personnelles -->

                    <!-- Onglet Documents -->
                    <div role="tabpanel" class="tab-pane" id="documents">
                        <div class="col-md-10 col-lg-10 col-lg-offset-1 col-md-offset-1">
                            <div id="documents-message" class="col-md-12 col-sm-12 col-xs-12 hidden">
                                <div id="documents-message_alert" class="alert">
                                </div>
                            </div>
                            <div class="col-md-12 col-sm-12 col-xs-12">
                                <div class="panel panel-custom">
                                    <div class="panel-body">
                                        <h4 class="title">Documents mis à disposition par K par K</h4>
                                        <apex:outputpanel layout="none">
                                            <apex:outputLink value="{!noticeVoletsSolairesURL}" id="noticeVoletsLink" target="_document">
                                                <span class="glyphicon glyphicon-file header-nav-icon" aria-hidden="true"></span>
                                                Notice d'utilisation du chargeur Volets Solaires - NB100
                                            </apex:outputLink>
                                        </apex:outputpanel>
                                    </div>
                                </div>
                            </div><!-- /.col-md-10 col-lg-10 col-lg-offset-1 col-md-offset-1 -->
                        </div><!-- /.tabpanel : DOCUMENTS -->
                    </div>

                    <!-- Onglet Contact -->
                    <div role="tabpanel" class="tab-pane" id="contactUs">
                        <div class="col-md-10 col-lg-10 col-lg-offset-1 col-md-offset-1">
                            <div id="contactUs-message" class="col-md-12 col-sm-12 col-xs-12 hidden">
                                <div id="contactUs-message_alert" class="alert">
                                </div>
                            </div>
                            <div class="col-md-6 col-sm-6 col-xs-12">
                                <div class="panel panel-custom">
                                    <div class="panel-body">
                                        <h3 class="title">Notre centre technique</h3>
                                        <address>
                                            <apex:outputpanel layout="none" rendered="{!IF(account.libelleDepot != null, true, false)}">
                                                <strong class="text-red">Centre technique de {!account.libelleDepot}</strong><br />
                                            </apex:outputpanel>
                                            {!account.rueDepot}<br />
                                            <apex:outputpanel layout="none" rendered="{!IF(account.codePostalDepot != null, true, false)}">
                                                {!account.codePostalDepot},
                                            </apex:outputpanel>
                                            {!UPPER(account.villeDepot)}
                                        </address>
                                        <apex:outputpanel layout="none" rendered="{!IF(account.telephoneDepot != null, true, false)}">
                                            <p>Pour toute question concernant votre métrage, installation ou pour déclarer un SAV, votre centre technique est joignable par téléphone au <a href="tel:{!account.telephoneDepot}"><strong class="text-red">{!account.telephoneDepot}</strong></a></p>
                                        </apex:outputpanel>
                                        <div class="embed-responsive embed-responsive-16by9" style="max-height:200px;">
                                            <apex:outputpanel layout="none" rendered="{!IF(account.locDepotLatitude != null, true, false)}">
                                                <iframe width="100%;" height="100%;" class="embed-responsive-item" allowfullscreen="true"
                                                        src="https://www.google.com/maps/embed/v1/place?key={!googleMapsSettings.Cle_API__c}&q={!URLENCODE(TEXT(account.locDepotLatitude)+','+TEXT(account.locDepotLongitude))}"></iframe>
                                            </apex:outputpanel>
                                            <apex:outputpanel layout="none" rendered="{!IF(account.locDepotLatitude == null, true, false)}">
                                                <iframe width="100%;" height="100%;" class="embed-responsive-item" allowfullscreen="true"
                                                        src="https://www.google.com/maps/embed/v1/place?key={!googleMapsSettings.Cle_API__c}&q={!URLENCODE(account.locDepotAdr)}"></iframe>
                                            </apex:outputpanel>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6 col-sm-6 col-xs-12">
                                <div class="panel panel-custom">
                                    <div class="panel-body">
                                        <h3 class="title">Service clients</h3>
                                        <p>
                                            Notre service clients est à votre écoute 6 jours sur 7 au <a href="tel:{!TELSUPPORT}" class="text-red number-phone">{!TELSUPPORT}</a> ou par e-mail <strong>
                                                <a href="mailto:{!EMAILSUPPORT}" class="text-red">{!EMAILSUPPORT}</a>
                                            </strong>
                                        </p>
                                        <div class="text-center">
                                            <input type="button" value="FAÎTES VOUS RAPPELER" onclick='showAskTelNumber(this, "contact-ask-tel");' class="btn-custom btn-custom-white" id="contact-call-button" />
                                        </div>
                                        <div class="text-center ask-tel-number" id="contact-ask-tel" style="display: none;">
                                            <span onclick='closeAskTelNumber("contact-call-button", "contact-ask-tel");' aria-hidden="true" class="glyphicon glyphicon-remove ask-tel-number-icon-close"></span>
                                            <div class="ask-tel-number-body">
                                                <div id="contact-ask-tel-items">
                                                    <span class="fa fa-phone icon-phone-add"></span>
                                                    <div class="items-phone-number">
                                                        <input placeholder="Saisissez votre numéro" class="ask-tel-number-input" title="Téléphone" pattern="[0-9]{10}" type="tel" id="contact-ask-tel-number" />
                                                        <input onclick='callRemoteActionNotifyTel(this, "contact");' type="button" value="OK" id="contact-ask-tel-button"
                                                               class="btn-custom btn-custom-red btn-xs" style="padding: 5px 5px 3px 5px !important;" data-loading-text="TRAITEMENT" />
                                                    </div>
                                                </div>
                                                <div id="contact-ask-tel-number-message" class="message hidden">
                                                    <div id="contact-ask-tel-number-message_alert" class="message-alert">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="text-center">
                                            <div id="liveagent_button_online_57357000000026Q" style="display: none;">
                                                <p style="padding-top:20px;">
                                                Un agent en ligne peut également répondre à vos questions en direct via un Chat.
                                                </p>
                                                <a href="javascript://Chat" class="btn-custom btn-custom-red btn-xs" onclick="liveagent.startChat('57357000000026Q')">
                                                    En ligne
                                                </a>
                                            </div>
                                            <div id="liveagent_button_offline_57357000000026Q" style="display: none;">
                                            </div>
                                            <script type="text/javascript">
                                                if (!window._laq) { window._laq = []; }
                                                window._laq.push(function(){liveagent.showWhenOnline('57357000000026Q', document.getElementById('liveagent_button_online_57357000000026Q'));
                                                liveagent.showWhenOffline('57357000000026Q', document.getElementById('liveagent_button_offline_57357000000026Q'));
                                            });</script>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div><!-- /.col-md-10 col-lg-10 col-lg-offset-1 col-md-offset-1 -->
                    </div><!-- /.tabpanel : CONTACT -->
                </div>
                <!-- Fenêtes modal pub parrainage -->
                <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="parrainage_modalPubParrainLabel" id="parrainage_modalPubParrain">
                    <div class="modal-dialog modal-custom" style="max-width:100%" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h3 class="modal-title" id="parrainage_modalPubParrainLabel">
                                    <a class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="glyphicon glyphicon-remove"></span></a>
                                    Parrainer un proche
                                </h3>
                            </div>
                            <div id="parrainage_modalPubParrain" data-toggle="false" class="modal-body" role="tabpanel">
                                <div class="row">
                                    <div class="col-md-12 col-sm-12 col-xs-12">
                                        <p>
                                            Le parrainage est maintnant disponible dans votre espace client.<br />
                                            L'offre de parrainage vous permet de cumuler des bons d'achat d'une valeur de 100 € par parrainage.
                                        </p>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-12 col-sm-12 col-xs-12 text-center">
                                        <div class="col-md-6">
                                            <input type="button" onclick="j$('#parrainage_modalPubParrain').modal('hide');" id="closePubParrain" class="btn-lg btn-custom btn-custom-white" value="RETOUR AU TABLEAU DE BORD" />
                                        </div>
                                        <div class="col-md-6 inline-button">
                                            <input type="button" onclick="j$('#parrainage_modalPubParrain').modal('hide');j$('.nav a[href=#parrainage]').tab('show');" id="showNewAjoutFilleul" class="btn-lg btn-custom btn-custom-red" value="PARRAINER UN PROCHE" />
                                        </div>
                                    </div>
                                </div>
                            </div><!-- /.modal-body -->
                        </div> <!-- /.modal-content -->
                    </div><!-- /.modal-dialog -->
                </div><!-- /.modal pub parrainage -->
            </div>
            <!-- Fenêtes modal parrainage validation ajout filleul -->
            <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="parrainage_modalValidLabel" id="parrainage_modalValid">
                <div class="modal-dialog modal-lg modal-sm modal-custom" style="max-width:100%" role="document">
                    <div class="modal-content">
                        <div id="parrainage_modalValidPanel" data-toggle="false" class="modal-body" role="tabpanel">
                            <div class="row">
                                <div class="col-md-12 col-sm-12 col-xs-12 text-center">
                                    <img src="{!URLFOR($Resource.Site_Espace_Client, 'img/validation.png')}" class="img-filleul-valid img-responsive" />
                                    <p class="text-uppercase">{!$Label.espaceclient_msg_CreateFilleulSuccessful}</p>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12 col-sm-12 col-xs-12 text-center">
                                    <div class="col-md-6" id="parrainage_modalValidPanel-cancel">
                                        <input type="button" onclick="j$('#parrainage_modalValid').modal('hide');" id="closeValidModal" class="btn-lg btn-custom btn-custom-white" value="RETOUR" />
                                    </div>
                                    <div class="col-md-6">
                                        <input type="button" onclick="j$('#parrainage_modalValid').modal('hide');j$('#parrainage_modalAdd').modal('show');" id="showNewAjoutFilleul" class="btn-lg btn-custom btn-custom-red" value="AJOUTER UN NOUVEAU FILLEUL" />
                                    </div>
                                </div>
                            </div>
                        </div><!-- /.modal-body -->
                    </div> <!-- /.modal-content -->
                </div><!-- /.modal-dialog -->
            </div><!-- /.modal parrainage validation ajout filleul -->
        </div>

        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-4421249-13', 'auto');
            ga('send', 'pageview');
        </script>
    </body>
</apex:page>